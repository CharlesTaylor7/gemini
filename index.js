(()=>{var S_=function(t){return function(r){for(var e=r.length,n=new Array(e),u=0;u<e;u++)n[u]=t(r[u]);return n}};var pu={compose:function(t){return function(r){return function(e){return t(r(e))}}}},Zu=function(t){return t.compose};var At=function(t){return t.identity},kt={identity:function(t){return t},Semigroupoid0:function(){return pu}};var br=!0;var Ht=function(t){return function(r){return function(e){return t(e)(r)}}},h=function(t){return function(r){return t}};var ta=function(t){return function(r){return r(t)}};var yt=function(){function t(){}return t.value=new t,t}();var S=function(t){return t.map},zt=function(t){var r=S(t);return function(e){return function(n){return r(n)(e)}}},Ot=function(t){return S(t)(h(void 0))},I=function(t){var r=S(t);return function(e){return function(n){return r(h(n))(e)}}};var te={map:Zu(pu)},Kt={map:S_};var $_=function(t){return function(r){return t+r}},h_=function(t){return function(r){return t.length===0?r:r.length===0?t:t.concat(r)}};var Vr=function(t){return t.reflectSymbol};var en=function(t){return function(r){return r[t]}};var F_={append:function(t){return function(r){return void 0}}},vo={append:$_};var xr={append:h_};var B=function(t){return t.append},T_=function(t){var r=B(t);return{append:function(e){return function(n){return function(u){return r(e(u))(n(u))}}}}};var qt=function(t){return t.alt};var jk=At(kt);var St=function(t){return t.apply};var Sn=function(t){var r=St(t),e=S(t.Functor0());return function(n){return function(u){return r(e(h(jk))(n))(u)}}},mr=function(t){var r=St(t),e=S(t.Functor0());return function(n){return function(u){return function(a){return r(e(n)(u))(a)}}}};var P=function(t){return t.pure};var un=function(t){var r=P(t);return function(e){return function(n){if(e)return n;if(!e)return r(void 0);throw new Error("Failed pattern match at Control.Applicative (line 63, column 1 - line 63, column 63): "+[e.constructor.name,n.constructor.name])}}},ti=function(t){var r=St(t.Apply0()),e=P(t);return function(n){return function(u){return r(e(n))(u)}}};var v=function(t){return t.empty};var $n=function(t){var r=P(t.Applicative0()),e=v(t.Plus1());return function(n){if(n)return r(void 0);if(!n)return e;throw new Error("Failed pattern match at Control.Alternative (line 48, column 1 - line 48, column 54): "+[n.constructor.name])}};var Qk=function(t,r){if(t<1)return[];var e=new Array(t);return e.fill(r)},Yk=function(t,r){for(var e=[],n=0,u=0;u<t;u++)e[n++]=r;return e},Zk=typeof Array.prototype.fill=="function"?Qk:Yk,td=function(){function t(u,a){this.head=u,this.tail=a}var r={};function e(u){return function(a){return new t(u,a)}}function n(u){for(var a=[],p=0,l=u;l!==r;)a[p++]=l.head,l=l.tail;return a}return function(u,a){return n(u(e)(r)(a))}}(),qe=function(t){return t.length},w_=function(t,r,e){return e.length===0?t({}):r(e[0])(e.slice(1))},I_=function(t,r,e,n){return n<0||n>=e.length?r:t(e[n])};var L_=function(t,r,e,n){for(var u=0,a=n.length;u<a;u++)if(e(n[u]))return t(u);return r};var P_=function(t,r,e,n){if(e<0||e>=n.length)return r;var u=n.slice();return u.splice(e,1),t(u)};var R_=function(){function t(r,e,n,u,a,p){var l,_,y,w,x,M,R;for(l=a+(p-a>>1),l-a>1&&t(r,e,u,n,a,l),p-l>1&&t(r,e,u,n,l,p),_=a,y=l,w=a;_<l&&y<p;)x=u[_],M=u[y],R=e(r(x)(M)),R>0?(n[w++]=M,++y):(n[w++]=x,++_);for(;_<l;)n[w++]=u[_++];for(;y<p;)n[w++]=u[y++]}return function(r,e,n){var u;return n.length<2?n:(u=n.slice(0),t(r,e,u,n.slice(0),0,n.length),u)}}();var O_=function(t,r){return t[r]};var nd=At(kt),_e=function(t){return t.discard};var vt=function(t){return t.bind},an=function(t){return Ht(vt(t))};var N_=function(t){var r=vt(t);return function(e){return function(n){return function(u){return r(e(u))(n)}}}};var ve={discard:function(t){return vt(t)}};var ra=function(t){var r=vt(t);return function(e){return r(e)(nd)}};var ae=function(t){var r=vt(t.Bind1()),e=P(t.Applicative0());return function(n){return function(u){return r(n)(function(a){return r(u)(function(p){return e(a(p))})})}}};var ud=String.fromCharCode(65535),ad=String.fromCharCode(0),id=Number.POSITIVE_INFINITY,od=Number.NEGATIVE_INFINITY;var cd=function(t){return function(r){return function(e){return function(n){return function(u){return n<u?t:n===u?r:e}}}}};var U_=cd;var W_=function(t){return function(r){return t===r}},B_=W_,H_=W_;var vu={eq:H_};var fc={eq:B_};var j=function(t){return t.eq},_d=j(fc);var ei=function(t){var r=j(t);return function(e){return function(n){return _d(r(e)(n))(!1)}}};var K=function(){function t(){}return t.value=new t,t}(),Q=function(){function t(){}return t.value=new t,t}(),ft=function(){function t(){}return t.value=new t,t}();var su={eq:function(t){return function(r){return t instanceof K&&r instanceof K||t instanceof Q&&r instanceof Q||t instanceof ft&&r instanceof ft}}};var q_=function(t){return function(r){return t-r|0}};var G_=function(t){return function(r){return t+r|0}},z_=function(t){return function(r){return t*r|0}},V_=function(t){return function(r){return t+r}},X_=function(t){return function(r){return t*r}};var ni={add:V_,zero:0,mul:X_,one:1},bu={add:G_,zero:0,mul:z_,one:1};var se=function(t){return t.mul};var dr=function(t){return t.add};var hn=function(t){return t.sub};var bo={sub:q_,Semiring0:function(){return bu}};var Vt=function(){return{compare:U_(K.value)(ft.value)(Q.value),Eq0:function(){return vu}}}();var ct=function(t){return t.compare};var Gn=function(t){var r=ct(t);return function(e){return function(n){return function(u){return r(e(n))(e(u))}}}};var J_=function(t){var r=ct(t);return function(e){return function(n){var u=r(e)(n);return!(u instanceof K)}}},pc=function(t){var r=ct(t);return function(e){return function(n){var u=r(e)(n);return u instanceof K}}};var lc=function(t){var r=ct(t);return function(e){return function(n){var u=r(e)(n);return!(u instanceof Q)}}};var be=function(t){return t.top};var mu={top:2147483647,bottom:-2147483648,Ord0:function(){return Vt}};var he=function(t){return t.bottom};var Q_=function(t){return t.toString()},Y_=function(t){var r=t.toString();return isNaN(r+".0")?r:r+".0"};var Z_=function(t){return function(r){for(var e=[],n=0,u=r.length;n<u;n++)e[n]=t(r[n]);return"["+e.join(",")+"]"}};var _c={show:Y_},me={show:Q_};var ut=function(t){return t.show},Vn=function(t){return{show:Z_(ut(t))}};var Mr=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),xt=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}();var Ge=function(){function t(){}return t.value=new t,t}();var vc=function(t){return t.from};var Td=At(kt),g=function(){function t(){}return t.value=new t,t}(),d=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}();var Qt=function(t){return function(r){return function(e){if(e instanceof g)return t;if(e instanceof d)return r(e.value0);throw new Error("Failed pattern match at Data.Maybe (line 237, column 1 - line 237, column 51): "+[t.constructor.name,r.constructor.name,e.constructor.name])}}},na=Qt(!0)(h(!1)),ui=Qt(!1)(h(!0));var tr={map:function(t){return function(r){return r instanceof d?new d(t(r.value0)):g.value}}},xd=S(tr);var Er=function(t){return Qt(t)(Td)},wr=function(){return function(t){if(t instanceof d)return t.value0;throw new Error("Failed pattern match at Data.Maybe (line 288, column 1 - line 288, column 46): "+[t.constructor.name])}};var Du={apply:function(t){return function(r){if(t instanceof d)return xd(t.value0)(r);if(t instanceof g)return g.value;throw new Error("Failed pattern match at Data.Maybe (line 67, column 1 - line 69, column 30): "+[t.constructor.name,r.constructor.name])}},Functor0:function(){return tr}};var re={bind:function(t){return function(r){if(t instanceof d)return r(t.value0);if(t instanceof g)return g.value;throw new Error("Failed pattern match at Data.Maybe (line 125, column 1 - line 127, column 28): "+[t.constructor.name,r.constructor.name])}},Apply0:function(){return Du}};var Fe=function(){return{pure:d.create,Apply0:function(){return Du}}}();var ai={alt:function(t){return function(r){return t instanceof g?r:t}},Functor0:function(){return tr}},Md=function(){return{empty:g.value,Alt0:function(){return ai}}}(),jn={Applicative0:function(){return Fe},Plus1:function(){return Md}};var Ut=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),Nt=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}();var Au=function(t){return function(r){return function(e){if(e instanceof Ut)return t(e.value0);if(e instanceof Nt)return r(e.value0);throw new Error("Failed pattern match at Data.Either (line 208, column 1 - line 208, column 64): "+[t.constructor.name,r.constructor.name,e.constructor.name])}}},sc=function(){return Au(h(g.value))(d.create)}();var Cn=function(t){return t};var ku={map:function(t){return function(r){return t(r)}}};var rv={apply:function(t){return function(r){return t(r)}},Functor0:function(){return ku}},Ed={bind:function(t){return function(r){return r(t)}},Apply0:function(){return rv}},wd={pure:Cn,Apply0:function(){return rv}},ii={Applicative0:function(){return wd},Bind1:function(){return Ed}};var ev=function(t){return Math.min(Math.abs(t),2147483647)},nv=function(t){return function(r){return r===0?0:r>0?Math.floor(t/r):-Math.floor(t/-r)}},uv=function(t){return function(r){if(r===0)return 0;var e=Math.abs(r);return(t%e+e)%e}};var av={Ring0:function(){return bo}};var Ve=function(t){return t.mod};var Te={degree:ev,div:nv,mod:uv,CommutativeRing0:function(){return av}},Jn=function(t){return t.div};var Fn={mempty:void 0,Semigroup0:function(){return F_}};var J=function(t){return t.mempty},Qn=function(t){var r=J(t),e=T_(t.Semigroup0());return{mempty:function(n){return r},Semigroup0:function(){return e}}};var bc=function(t){return function(){return t}},iv=function(t){return function(r){return function(){return r(t())()}}};var ov=function(t,r,e){var n=0,u;return function(a){if(n===2)return u;if(n===1)throw new ReferenceError(t+" was needed before it finished initializing (module "+r+", line "+a+")",r,a);return n=1,u=e(),n=2,u}},ua={Applicative0:function(){return Or},Bind1:function(){return aa}},aa={bind:iv,Apply0:function(){return mc(0)}},Or={pure:bc,Apply0:function(){return mc(0)}},fv=ov("functorEffect","Effect",function(){return{map:ti(Or)}}),mc=ov("applyEffect","Effect",function(){return{apply:ae(ua),Functor0:function(){return fv(0)}}}),$=fv(20),oi=mc(23),Nd=mr(oi),Dc=function(t){return{append:Nd(B(t))}},Tn=function(t){var r=Dc(t.Semigroup0());return{mempty:bc(J(t)),Semigroup0:function(){return r}}};var cv=function(t){return function(){return{value:t}}};var Sr=function(t){return function(){return t.value}},pv=function(t){return function(r){return function(){var e=t(r.value);return r.value=e.state,e.value}}},Xr=function(t){return function(r){return function(){r.value=t}}};var Wd=Ot($),jr=cv,Bd=pv,Do=function(t){return Bd(function(r){var e=t(r);return{state:e,value:e}})},fi=function(t){return function(r){return Wd(Do(t)(r))}};var lv=function(t){return function(r){return function(){return t(r())}}},_v=function(t){return function(){return t}},vv=function(t){return function(r){return function(){return r(t())()}}};function $r(t){return function(){return{value:t}}}var lr=function(t){return function(){return t.value}},sv=function(t){return function(r){return function(){var e=t(r.value);return r.value=e.state,e.value}}},ee=function(t){return function(r){return function(){return r.value=t}}};var jd=function(t,r,e){var n=0,u;return function(a){if(n===2)return u;if(n===1)throw new ReferenceError(t+" was needed before it finished initializing (module "+r+", line "+a+")",r,a);return n=1,u=e(),n=2,u}},Jd=sv,Xe=function(t){return Jd(function(r){var e=t(r);return{state:e,value:e}})},Ir={map:lv};var dc={Applicative0:function(){return Dr},Bind1:function(){return ci}},ci={bind:vv,Apply0:function(){return yc(0)}},Dr={pure:_v,Apply0:function(){return yc(0)}},yc=jd("applyST","Control.Monad.ST.Internal",function(){return{apply:ae(dc),Functor0:function(){return Ir}}}),Ao=yc(47),Kd=mr(Ao);var Qd=P(Dr),gc=function(t){return{append:Kd(B(t))}};var mv=function(t){var r=gc(t.Semigroup0());return{mempty:Qd(J(t)),Semigroup0:function(){return r}}};function xn(){return[]}var Dv=function(t,r,e,n){return e>=0&&e<n.length?t(n[e]):r},Av=function(t,r,e){var n=t>=0&&t<e.length;return n&&(e[t]=r),n};var kv=function(t,r){return r.push.apply(r,t)};var dv=function(t,r,e,n){return n.splice.apply(n,[t,r].concat(e))};function Yd(t){return t}var yv=Yd;function gv(t){return t.slice()}var Sv=gv,$v=gv,Zd=function(){function t(r,e,n,u,a,p){var l,_,y,w,x,M,R;for(l=a+(p-a>>1),l-a>1&&t(r,e,u,n,a,l),p-l>1&&t(r,e,u,n,l,p),_=a,y=l,w=a;_<l&&y<p;)x=u[_],M=u[y],R=e(r(x)(M)),R>0?(n[w++]=M,++y):(n[w++]=x,++_);for(;_<l;)n[w++]=u[_++];for(;y<p;)n[w++]=u[y++]}return function(r,e,n){return n.length<2||t(r,e,n,n.slice(0),0,n.length),n}}();var pi=function(r){return function(e){return function(){return r(e)}}},Sc=function(r){return function(e){return function(n){return function(){return r(e,n)}}}},$c=function(r){return function(e){return function(n){return function(u){return function(){return r(e,n,u)}}}}},ko=function(r){return function(e){return function(n){return function(u){return function(a){return function(){return r(e,n,u,a)}}}}}};var Yn=pi(yv);var hv=pi($v);var hc=ko(dv);var je=function(t){return Sc(kv)([t])};var Cv=$c(Av),Cc=function(){return ko(Dv)(d.create)(g.value)}(),Fc=function(t){return function(r){return function(e){return function(){var u=Cc(t)(e)();if(u instanceof d)return Cv(t)(r(u.value0))(e)();if(u instanceof g)return!1;throw new Error("Failed pattern match at Data.Array.ST (line 222, column 3 - line 224, column 26): "+[u.constructor.name])}}}};var yo=pi(Sv);var Fv=function(t){return function(r){return t&&r}},Tv=function(t){return function(r){return t||r}},xv=function(t){return!t};var ia=function(t){return t.tt};var yu=function(t){return t.not};var oa=function(t){return t.disj},Mn={ff:!1,tt:!0,implies:function(t){return function(r){return oa(Mn)(yu(Mn)(t))(r)}},conj:Fv,disj:Tv,not:xv};var fa=function(t){return t.conj};var xc=S(Ir),Mv=yu(Mn),Tc=Ot(Ir),ny=function(){function t(r,e){this.value0=r,this.value1=e}return t.create=function(r){return function(e){return new t(r,e)}},t}(),uy=function(t){return function(){var e=lr(t.value1)();return t.value0(e)}},Ev=function(t){return function(){var e=lr(t.value1)();return Xe(function(n){return n+1|0})(t.value1)(),t.value0(e)}},wv=function(t){return function(r){return function(e){return function(){for(var u=$r(!1)();xc(Mv)(lr(u))();)(function(){var p=uy(r)();return p instanceof d&&t(p.value0)?(je(p.value0)(e)(),Tc(Ev(r))()):Tc(ee(!0)(u))()})();return{}}}}};var Mc=function(t){return xc(ny.create(t))($r(0))},Ec=function(t){return function(r){return function(){for(var n=$r(!1)();xc(Mv)(lr(n))();)(function(){var a=Ev(t)();if(a instanceof d)return r(a.value0)();if(a instanceof g)return Tc(ee(!0)(n))();throw new Error("Failed pattern match at Data.Array.ST.Iterator (line 42, column 5 - line 44, column 47): "+[a.constructor.name])})();return{}}}};var Lv=function(t){return function(r){return function(e){for(var n=r,u=e.length,a=u-1;a>=0;a--)n=t(e[a])(n);return n}}},Pv=function(t){return function(r){return function(e){for(var n=r,u=e.length,a=0;a<u;a++)n=t(n)(e[a]);return n}}};var T=function(){function t(r,e){this.value0=r,this.value1=e}return t.create=function(r){return function(e){return new t(r,e)}},t}(),wc=function(t){return function(r){return t(r.value0)(r.value1)}};var Ur=function(t){return t.value1};var gu={map:function(t){return function(r){return new T(r.value0,t(r.value1))}}};var Me=function(t){return t.value0};var ca=function(t){return function(r){return function(e){return t(new T(r,e))}}};var vi=function(t){return t};var Dy=function(t){var r=fa(t);return{append:function(e){return function(n){return r(e)(n)}}}};var Pc=function(t){var r=Dy(t);return{mempty:ia(t),Semigroup0:function(){return r}}};var N=function(t){return t};var Ar=function(){return N};var Wv=Ar();var Jr=function(){return Wv};var ho=function(){return function(){return function(){return function(){return function(t){return Wv}}}}};var yy=ho()()()(),gr=function(t){return t.foldr};var _a=function(t){var r=Sn(t.Apply0()),e=P(t);return function(n){var u=gr(n);return function(a){return u(function(p){return r(a(p))})(e(void 0))}}},_n=function(t){var r=_a(t);return function(e){return Ht(r(e))}};var er=function(t){return t.foldl};var Zn={foldr:function(t){return function(r){return function(e){if(e instanceof g)return r;if(e instanceof d)return t(e.value0)(r);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[t.constructor.name,r.constructor.name,e.constructor.name])}}},foldl:function(t){return function(r){return function(e){if(e instanceof g)return r;if(e instanceof d)return t(r)(e.value0);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[t.constructor.name,r.constructor.name,e.constructor.name])}}},foldMap:function(t){var r=J(t);return function(e){return function(n){if(n instanceof g)return r;if(n instanceof d)return e(n.value0);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[e.constructor.name,n.constructor.name])}}}};var Hv=function(t){var r=gr(t);return function(e){var n=B(e.Semigroup0()),u=J(e);return function(a){return r(function(p){return function(l){return n(a(p))(l)}})(u)}}},Pt={foldr:Lv,foldl:Pv,foldMap:function(t){return Hv(Pt)(t)}};var kr=function(t){return t.foldMap};var Di=function(t){var r=kr(t);return function(e){return yy(vi)(r(Pc(e)))}};var tu=function(t){return function(r){return function(e){return t(r,e)}}},Co=function(t){return function(r){return function(e){return function(n){return t(r,e,n)}}}},va=function(t){return function(r){return function(e){return function(n){return function(u){return t(r,e,n,u)}}}}};var qv=function(t){return function(r){for(var e=r.length,n=Array(e),u=0;u<e;u++)n[u]=t(u)(r[u]);return n}};var vn=function(t){return t.mapWithIndex};var En={mapWithIndex:qv,Functor0:function(){return Kt}};var Xv=function(){function t(u){return[u]}function r(u){return function(a){return[u,a]}}function e(u){return function(a){return function(p){return[u,a,p]}}}function n(u){return function(a){return u.concat(a)}}return function(u){return function(a){return function(p){return function(l){return function(_){function y(w,x){switch(x-w){case 0:return p([]);case 1:return a(t)(l(_[w]));case 2:return u(a(r)(l(_[w])))(l(_[w+1]));case 3:return u(u(a(e)(l(_[w])))(l(_[w+1])))(l(_[w+2]));default:var M=w+Math.floor((x-w)/4)*2;return u(a(n)(y(w,M)))(y(M,x))}}return y(0,_.length)}}}}}}();var eg=At(kt),we=function(t){return t.traverse};var as=function(t){var r=we(t);return function(e){return r(e)(eg)}},ru={traverse:function(t){var r=t.Apply0();return Xv(St(r))(S(r.Functor0()))(P(t))},sequence:function(t){return as(ru)(t)},Functor0:function(){return Kt},Foldable1:function(){return Pt}},In=function(t){return t.sequence};var is=function(t){return function(r){return function(e){return function(n){return function(u){return function(a){for(var p=[],l=a;;){var _=u(l);if(t(_))return p;var y=r(_);p.push(e(y)),l=n(y)}}}}}}};var os=function(t){return function(r){return function(e){return function(n){return function(u){return function(a){for(var p=[],l=a;;){var _=u(l);p.push(e(_));var y=n(_);if(t(y))return p;l=r(y)}}}}}}};var fg=j(su);var di=function(t){return t.foldl1},fs=function(t){var r=di(t);return function(e){return r(function(n){return function(u){var a=fg(e(n)(u))(Q.value);return a?n:u}})}};var cs=function(t){var r=di(t);return function(e){var n=S(e);return function(u){var a=B(u);return function(p){var l=r(a),_=n(p);return function(y){return l(_(y))}}}}};var vg=wr(),ba=function(t){return t.unfoldr1};var ma={unfoldr1:os(na)(vg)(Me)(Ur)},ps=function(t){var r=ba(t);return function(e){return function(n){var u=function(a){if(a<=0)return new T(n,g.value);if(br)return new T(n,new d(a-1|0));throw new Error("Failed pattern match at Data.Unfoldable1 (line 68, column 5 - line 68, column 39): "+[a.constructor.name])};return r(u)(e-1|0)}}};var zc=function(t){return ps(t)(1)};var sg=wr(),sn=function(t){return t.unfoldr};var eu={unfoldr:is(na)(sg)(Me)(Ur),Unfoldable10:function(){return ma}},bg=function(t){var r=sn(t);return function(e){return function(n){var u=function(a){var p=a<=0;return p?g.value:new d(new T(n,a-1|0))};return r(u)(e)}}},ls=function(t){return function(r){var e=bg(r);return function(n){var u=In(n)(t);return function(a){return function(p){return u(e(a)(p))}}}}};var dg=Ot(Ir);var yg=S(tr);var gg=wr();var Sg=j(su);var Vc=function(){return tu(O_)},$g=Vc(),Xc=function(){return Co(w_)(h(g.value))(function(t){return function(r){return new d({head:t,tail:r})}})}();var Eo=function(t){return Co(R_)(t)(function(r){if(r instanceof Q)return 1;if(r instanceof ft)return 0;if(r instanceof K)return-1;throw new Error("Failed pattern match at Data.Array (line 897, column 38 - line 900, column 11): "+[r.constructor.name])})};var jc=vn(En);var Ie=function(){return va(I_)(d.create)(g.value)}(),Jc=function(t){return Ie(t)(qe(t)-1|0)};var Kc=function(t){return Ie(t)(0)};var _s=function(t){return function(r){return function(){var n=xn(),u=Mc(function(a){return Ie(r)(a)})();return Ec(u)(function(a){return dg(function(){var l=xn();je(a)(l)(),wv(t(a))(u)(l)();var _=Yn(l)();return je(_)(n)()})})(),Yn(n)()}()}},wo=function(t){var r=_s(function(n){return function(u){return Sg(t(n)(u))(ft.value)}}),e=Eo(t);return function(n){return r(e(n))}};var Qc=function(){return va(L_)(d.create)(g.value)}(),gi=function(t){return function(r){return yg($g(r))(Qc(t)(r))}};var vs=function(){return va(P_)(d.create)(g.value)}(),Yc=function(t){return function(r){return function(e){return e.length===0?[]:Qt(e)(function(n){return gg(vs(n)(e))})(Qc(t(r))(e))}}};var Fg=be(mu),Tg=he(mu),xg=vt(re),Mg=I(tr),Eg=$n(jn);var wg=function(t){return t.succ};var Ig=function(t){return t.pred};var bs={succ:function(t){var r=t<Fg;return r?new d(t+1|0):g.value},pred:function(t){var r=t>Tg;return r?new d(t-1|0):g.value},Ord0:function(){return Vt}},Zc=function(t){var r=t.Ord0(),e=j(r.Eq0()),n=pc(r),u=wg(t),a=lc(r),p=Ig(t),l=J_(r);return function(_){var y=zc(_),w=ba(_),x=function(M){return function(R){return function(_t){return function(at){return new T(at,xg(M(at))(function(Ct){return Mg(Eg(R(Ct)(_t)))(Ct)}))}}}};return function(M){return function(R){if(e(M)(R))return y(M);if(n(M)(R))return w(x(u)(a)(R))(M);if(br)return w(x(p)(l)(R))(M);throw new Error("Failed pattern match at Data.Enum (line 186, column 14 - line 190, column 51): "+[M.constructor.name,R.constructor.name])}}}};var Aa=void 0;var ms=function(t){return t()};var Ds=function(t){throw new Error(t)};var As=function(){return Ds};var Og=As(),Ng=ms,Le=function(t){return Ng(function(){return Og(t)})};var tp=function(t){return t.toInt},Lo=function(t){var r=tp(t);return function(e){return r(Aa)}};var ks={toInt:function(t){return 5}},ds={Nat0:function(){return ks}};var ys={toInt:function(t){return 1}},ie={Nat0:function(){return ys}};var gs=function(t){return function(r){return Aa}},rp=function(t){var r=gs(t);return function(e){var n=tp(e);return function(u){return function(a){return 10*a|0}(n(r(u)))}}};var ep=function(t){var r=t.Nat0();return{toInt:function(e){return rp(ep(t))(r)(e)+4|0}}};var Ss=function(t){var r=t.Nat0();return{toInt:function(e){return rp(Ss(t))(r)(e)+8|0}}},oe=function(t){var r=Ss(t);return{Nat0:function(){return r}}};var y$=Zc(bs)(ma),nu=function(t){return Lo(t)(yt.value)},np=function(t){var r=nu(t);return y$(0)(r-1|0)};var $s=function(t){return function(r){return r.join(t)}};var S$=B(xr),Ro={genericShowArgs:function(t){return[]}};var $$=function(t){return t.genericShowArgs};var Oo=function(t){var r=$$(t);return function(e){var n=Vr(e);return{"genericShow'":function(u){var a=n(yt.value),p=r(u);return p.length===0?a:"("+($s(" ")(S$([a])(p))+")")}}}},up=function(t){return t["genericShow'"]};var uu=function(t){var r=up(t);return function(e){var n=up(e);return{"genericShow'":function(u){if(u instanceof Mr)return r(u.value0);if(u instanceof xt)return n(u.value0);throw new Error("Failed pattern match at Data.Show.Generic (line 26, column 1 - line 28, column 40): "+[u.constructor.name])}}}},No=function(t){var r=vc(t);return function(e){var n=up(e);return function(u){return n(r(u))}}};var h$=Ar(),C$=j(vu),Cs=Ve(Te),F$=Jn(Te),ip=function(){function t(){}return t.value=new t,t}(),op=function(){function t(){}return t.value=new t,t}(),Uo=function(){function t(){}return t.value=new t,t}(),T$=function(){function t(){}return t.value=new t,t}();var Wo=function(t){return{inhabitants:h$(np(t.Nat0()))}};var Fs={eq:function(t){return function(r){return t===r}}},Ke=function(t){return t},x$=function(){var t=C$(0);return function(r){return t(function(e){return Cs(e)(2)}(r))}}(),Qe=function(t){var r=nu(t.Nat0());return function(e){return Cs(e)(r)}},Bo=function(t){var r=Qe(t);return{zero:0,one:r(1),add:function(e){return function(n){return r(e+n|0)}},mul:function(e){return function(n){return r(e*n|0)}}}},fp=function(t){var r=Qe(t),e=Bo(t);return{sub:function(n){return function(u){return r(n-u|0)}},Semiring0:function(){return e}}};var Ts=function(t){var r=nu(t.Nat0()),e=hn(fp(t));return function(n){return function(u){var a=F$(r)(2),p=Ke(e(u)(n)),l=p===0;if(l)return Uo.value;var _=x$(r)&&p===a;if(_)return T$.value;var y=p<=a;return y?ip.value:op.value}}};var I$=j(Fs),Is=Qe(oe(ie)),L$=Ve(Te),P$=Jn(Te),Ls=zt(tr),R$=qt(ai),xs=Sn(Du),Ms=$n(jn),Es=P(Fe),$t=function(){function t(){}return t.value=new t,t}(),Dt=function(){function t(){}return t.value=new t,t}(),Mt=function(){function t(){}return t.value=new t,t}();var Ps=function(){function t(){}return t.value=new t,t}(),Rs=function(){function t(){}return t.value=new t,t}(),cp=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),pp=function(){function t(r,e){this.value0=r,this.value1=e}return t.create=function(r){return function(e){return new t(r,e)}},t}();var Ho=function(){return{inhabitants:[$t.value,Dt.value,Mt.value]}}(),da={eq:function(t){return function(r){return t instanceof $t&&r instanceof $t||t instanceof Dt&&r instanceof Dt||t instanceof Mt&&r instanceof Mt}}},O$=j(da),Os={compare:function(t){return function(r){if(t instanceof $t&&r instanceof $t)return ft.value;if(t instanceof $t)return K.value;if(r instanceof $t)return Q.value;if(t instanceof Dt&&r instanceof Dt)return ft.value;if(t instanceof Dt)return K.value;if(r instanceof Dt)return Q.value;if(t instanceof Mt&&r instanceof Mt)return ft.value;throw new Error("Failed pattern match at Data.Location (line 0, column 0 - line 0, column 0): "+[t.constructor.name,r.constructor.name])}},Eq0:function(){return da}},Ns={eq:function(t){return function(r){return I$(t.position)(r.position)&&O$(t.ring)(r.ring)}}},Us=j(Ns),ws=ei(Ns),qo=function(t){return t},Ae=function(t){var r=function(e){if(e instanceof $t)return 0;if(e instanceof Dt)return 1;if(e instanceof Mt)return 2;throw new Error("Failed pattern match at Data.Location (line 114, column 15 - line 117, column 19): "+[e.constructor.name])};return(r(t.ring)*18|0)+Ke(t.position)|0};var H=function(t){return function(r){return{ring:t,position:Is(r)}}},Ws=function(t){var r=L$(t)(18),e=P$(t)(18),n=function(){return e===0?$t.value:e===1?Dt.value:e===2?Mt.value:Le("indexToLocation")}();return{ring:n,position:Is(r)}},hu=function(){return[{canonical:H($t.value)(2),alternate:H(Dt.value)(16)},{canonical:H($t.value)(7),alternate:H(Dt.value)(11)},{canonical:H(Dt.value)(2),alternate:H(Mt.value)(16)},{canonical:H(Dt.value)(7),alternate:H(Mt.value)(11)}]}(),Bs=function(t){return Er(t)(Ls(gi(function(r){return Us(r.alternate)(t)})(hu))(function(r){return r.canonical}))},lp=function(t){return Ae(Bs(t))},N$=function(t){return Er(t)(Ls(gi(function(r){return Us(r.canonical)(t)})(hu))(function(r){return r.alternate}))},Si=function(t){var r=Bs(t),e=N$(t);return R$(xs(Ms(ws(e)(t)))(Es(e)))(xs(Ms(ws(r)(t)))(Es(r)))},Hs=function(t){var r=Si(t);if(r instanceof g)return new cp(t);if(r instanceof d)return new pp(t,r.value0);throw new Error("Failed pattern match at Data.Location (line 132, column 3 - line 134, column 37): "+[r.constructor.name])};var qs=t=>{for(var r=0,e=t.length;r<e;r++)t[r]()},Go=(t,r)=>{for(var e=0,n=t.length;e<n;e++)r(t[e])},_p=(t,r)=>{for(let e in t)r(t[e])},vp=()=>({}),sp=(t,r,e)=>{e[t]=r},bp=(t,r)=>{delete r[t]};var Cu=N;var Fu={liftST:Cu,Monad0:function(){return ua}},Tu=function(t){return t.liftST};var xu=function(t){return t.foldrWithIndex},H$=function(t){var r=Sn(t.Apply0()),e=P(t);return function(n){var u=xu(n);return function(a){return u(function(p){var l=a(p);return function(_){return r(l(_))}})(e(void 0))}}},mp=function(t){var r=H$(t);return function(e){return Ht(r(e))}};var G$=S(gu),z$=S(tr),Mu=function(){function t(r,e){this.value0=r,this.value1=e}return t.create=function(r){return function(e){return new t(r,e)}},t}(),js=function(t){var r=sn(t);return{unfoldr1:function(e){return function(n){return wc(Mu.create)(G$(r(z$(e)))(e(n)))}}}};var Xt=function(){function t(){}return t.value=new t,t}(),ur=function(){function t(r,e){this.value0=r,this.value1=e}return t.create=function(r){return function(e){return new t(r,e)}},t}();var Ye={foldr:function(t){return function(r){var e=function(){var u=function(a){return function(p){var l=a,_=!1,y;function w(x,M){if(M instanceof Xt)return _=!0,x;if(M instanceof ur){l=new ur(M.value0,x),p=M.value1;return}throw new Error("Failed pattern match at Data.List.Types (line 107, column 7 - line 107, column 23): "+[x.constructor.name,M.constructor.name])}for(;!_;)y=w(l,p);return y}};return u(Xt.value)}(),n=er(Ye)(Ht(t))(r);return function(u){return n(e(u))}}},foldl:function(t){var r=function(e){return function(n){var u=e,a=!1,p;function l(_,y){if(y instanceof Xt)return a=!0,_;if(y instanceof ur){u=t(_)(y.value0),n=y.value1;return}throw new Error("Failed pattern match at Data.List.Types (line 111, column 12 - line 113, column 30): "+[y.constructor.name])}for(;!a;)p=l(u,n);return p}};return r},foldMap:function(t){var r=B(t.Semigroup0()),e=J(t);return function(n){return er(Ye)(function(u){var a=r(u);return function(p){return a(n(p))}})(e)}}},Ks=er(Ye);var j$={unfoldr1:function(t){return function(r){var e=function(n){return function(u){var a=n,p=!1,l;function _(y,w){var x=t(y);if(x.value1 instanceof d){a=x.value1.value0,u=new ur(x.value0,w);return}if(x.value1 instanceof g)return p=!0,Ks(Ht(ur.create))(Xt.value)(new ur(x.value0,w));throw new Error("Failed pattern match at Data.List.Types (line 135, column 22 - line 137, column 61): "+[x.constructor.name])}for(;!p;)l=_(a,u);return l}};return e(r)(Xt.value)}}},Dp={unfoldr:function(t){return function(r){var e=function(n){return function(u){var a=n,p=!1,l;function _(y,w){var x=t(y);if(x instanceof g)return p=!0,Ks(Ht(ur.create))(Xt.value)(w);if(x instanceof d){a=x.value0.value1,u=new ur(x.value0.value0,w);return}throw new Error("Failed pattern match at Data.List.Types (line 142, column 22 - line 144, column 52): "+[x.constructor.name])}for(;!p;)l=_(a,u);return l}};return e(r)(Xt.value)}},Unfoldable10:function(){return j$}},Qs=js(Dp);var Ap=function(t){if(t instanceof Xt)return g.value;if(t instanceof ur)return new d({head:t.value0,tail:t.value1});throw new Error("Failed pattern match at Data.List (line 259, column 1 - line 259, column 66): "+[t.constructor.name])};var kp=function(){var t=function(r){return function(e){var n=r,u=!1,a;function p(l,_){if(_ instanceof Xt)return u=!0,l;if(_ instanceof ur){n=new ur(_.value0,l),e=_.value1;return}throw new Error("Failed pattern match at Data.List (line 368, column 3 - line 368, column 19): "+[l.constructor.name,_.constructor.name])}for(;!u;)a=p(n,e);return a}};return t(Xt.value)}();var wu=function(t,r,e){var n=0,u;return function(a){if(n===2)return u;if(n===1)throw new ReferenceError(t+" was needed before it finished initializing (module "+r+", line "+a+")",r,a);return n=1,u=e(),n=2,u}};var jt=function(){function t(){}return t.value=new t,t}(),Gt=function(){function t(r,e,n,u,a,p){this.value0=r,this.value1=e,this.value2=n,this.value3=u,this.value4=a,this.value5=p}return t.create=function(r){return function(e){return function(n){return function(u){return function(a){return function(p){return new t(r,e,n,u,a,p)}}}}}},t}();var Vo=function(){function t(r,e,n){this.value0=r,this.value1=e,this.value2=n}return t.create=function(r){return function(e){return function(n){return new t(r,e,n)}}},t}(),Ys=function(){function t(r,e,n){this.value0=r,this.value1=e,this.value2=n}return t.create=function(r){return function(e){return function(n){return new t(r,e,n)}}},t}(),Re=function(t,r,e,n){if(e instanceof jt){if(n instanceof jt)return new Gt(1,1,t,r,e,n);if(n instanceof Gt)return new Gt(1+n.value0|0,1+n.value1|0,t,r,e,n);throw new Error("Failed pattern match at Data.Map.Internal (line 680, column 5 - line 684, column 39): "+[n.constructor.name])}if(e instanceof Gt){if(n instanceof jt)return new Gt(1+e.value0|0,1+e.value1|0,t,r,e,n);if(n instanceof Gt)return new Gt(1+function(){var u=e.value0>n.value0;return u?e.value0:n.value0}()|0,(1+e.value1|0)+n.value1|0,t,r,e,n);throw new Error("Failed pattern match at Data.Map.Internal (line 686, column 5 - line 690, column 68): "+[n.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 678, column 32 - line 690, column 68): "+[e.constructor.name])};var Xo=function(t){return function(r){return new Gt(1,1,t,r,jt.value,jt.value)}},ke=function(){var t=function(n){if(n instanceof jt)return 0;if(n instanceof Gt)return n.value0;throw new Error("Failed pattern match at Data.Map.Internal (line 735, column 12 - line 737, column 26): "+[n.constructor.name])},r=function(n,u,a,p,l,_,y){return _ instanceof Gt&&_.value0>t(y)?Re(_.value2,_.value3,Re(n,u,a,_.value4),Re(p,l,_.value5,y)):Re(p,l,Re(n,u,a,_),y)},e=function(n,u,a,p,l,_,y){return _ instanceof Gt&&t(l)<=_.value0?Re(_.value2,_.value3,Re(a,p,l,_.value4),Re(n,u,_.value5,y)):Re(a,p,l,Re(n,u,_,y))};return function(n,u,a,p){if(a instanceof jt)return p instanceof jt?Xo(n)(u):p instanceof Gt&&p.value0>1?r(n,u,a,p.value2,p.value3,p.value4,p.value5):Re(n,u,a,p);if(a instanceof Gt){if(p instanceof Gt){if(p.value0>(a.value0+1|0))return r(n,u,a,p.value2,p.value3,p.value4,p.value5);if(a.value0>(p.value0+1|0))return e(n,u,a.value2,a.value3,a.value4,a.value5,p)}return p instanceof jt&&a.value0>1?e(n,u,a.value2,a.value3,a.value4,a.value5,p):Re(n,u,a,p)}throw new Error("Failed pattern match at Data.Map.Internal (line 695, column 40 - line 716, column 34): "+[a.constructor.name])}}(),dp=wu("unsafeSplit","Data.Map.Internal",function(){return function(t,r,e){if(e instanceof jt)return new Vo(g.value,jt.value,jt.value);if(e instanceof Gt){var n=t(r)(e.value2);if(n instanceof K){var u=dp(771)(t,r,e.value4);return new Vo(u.value0,u.value1,ke(e.value2,e.value3,u.value2,e.value5))}if(n instanceof Q){var u=dp(774)(t,r,e.value5);return new Vo(u.value0,ke(e.value2,e.value3,e.value4,u.value1),u.value2)}if(n instanceof ft)return new Vo(new d(e.value3),e.value4,e.value5);throw new Error("Failed pattern match at Data.Map.Internal (line 769, column 5 - line 777, column 30): "+[n.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 765, column 34 - line 777, column 30): "+[e.constructor.name])}}),Zs=dp(764),tb=wu("unsafeSplitLast","Data.Map.Internal",function(){return function(t,r,e,n){if(n instanceof jt)return new Ys(t,r,e);if(n instanceof Gt){var u=tb(757)(n.value2,n.value3,n.value4,n.value5);return new Ys(u.value0,u.value1,ke(t,r,e,u.value2))}throw new Error("Failed pattern match at Data.Map.Internal (line 754, column 37 - line 758, column 57): "+[n.constructor.name])}}),uh=tb(753),gp=function(t,r){if(t instanceof jt)return r;if(t instanceof Gt){var e=uh(t.value2,t.value3,t.value4,t.value5);return ke(e.value0,e.value1,e.value2,r)}throw new Error("Failed pattern match at Data.Map.Internal (line 742, column 25 - line 746, column 38): "+[t.constructor.name,r.constructor.name])};var yp=wu("unsafeUnionWith","Data.Map.Internal",function(){return function(t,r,e,n){if(e instanceof jt)return n;if(n instanceof jt)return e;if(n instanceof Gt){var u=Zs(t,n.value2,e),a=yp(787)(t,r,u.value1,n.value4),p=yp(788)(t,r,u.value2,n.value5);if(u.value0 instanceof d)return ke(n.value2,r(u.value0.value0)(n.value3),a,p);if(u.value0 instanceof g)return ke(n.value2,n.value3,a,p);throw new Error("Failed pattern match at Data.Map.Internal (line 789, column 5 - line 793, column 46): "+[u.value0.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 782, column 42 - line 793, column 46): "+[e.constructor.name,n.constructor.name])}}),ah=yp(781),ih=function(t){var r=ct(t);return function(e){return function(n){return function(u){return ah(r,e,n,u)}}}},jo=function(t){return ih(t)(h)},rb=function(t){var r=ct(t);return function(e){return function(n){var u=function(a){if(a instanceof jt)return jt.value;if(a instanceof Gt){var p=r(n)(a.value2);if(p instanceof K)return ke(a.value2,a.value3,u(a.value4),a.value5);if(p instanceof Q)return ke(a.value2,a.value3,a.value4,u(a.value5));if(p instanceof ft){var l=e(a.value3);if(l instanceof g)return gp(a.value4,a.value5);if(l instanceof d)return new Gt(a.value0,a.value1,a.value2,l.value0,a.value4,a.value5);throw new Error("Failed pattern match at Data.Map.Internal (line 529, column 11 - line 533, column 38): "+[l.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 525, column 7 - line 533, column 38): "+[p.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 522, column 8 - line 533, column 38): "+[a.constructor.name])};return u}}};var eb=function(t){var r=ct(t);return function(e){var n=function(u){var a=!1,p;function l(_){if(_ instanceof jt)return a=!0,!1;if(_ instanceof Gt){var y=r(e)(_.value2);if(y instanceof K){u=_.value4;return}if(y instanceof Q){u=_.value5;return}if(y instanceof ft)return a=!0,!0;throw new Error("Failed pattern match at Data.Map.Internal (line 457, column 7 - line 460, column 19): "+[y.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 454, column 8 - line 460, column 19): "+[_.constructor.name])}for(;!a;)p=l(u);return p};return n}};var hi=function(t){var r=ct(t);return function(e){var n=function(u){var a=!1,p;function l(_){if(_ instanceof jt)return a=!0,g.value;if(_ instanceof Gt){var y=r(e)(_.value2);if(y instanceof K){u=_.value4;return}if(y instanceof Q){u=_.value5;return}if(y instanceof ft)return a=!0,new d(_.value3);throw new Error("Failed pattern match at Data.Map.Internal (line 281, column 7 - line 284, column 22): "+[y.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 278, column 8 - line 284, column 22): "+[_.constructor.name])}for(;!a;)p=l(u);return p};return n}};var Ci=function(t){var r=ct(t);return function(e){return function(n){var u=function(a){if(a instanceof jt)return Xo(e)(n);if(a instanceof Gt){var p=r(e)(a.value2);if(p instanceof K)return ke(a.value2,a.value3,u(a.value4),a.value5);if(p instanceof Q)return ke(a.value2,a.value3,a.value4,u(a.value5));if(p instanceof ft)return new Gt(a.value0,a.value1,e,n,a.value4,a.value5);throw new Error("Failed pattern match at Data.Map.Internal (line 469, column 7 - line 472, column 35): "+[p.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 466, column 8 - line 472, column 35): "+[a.constructor.name])};return u}}};var nb={foldr:function(t){return function(r){var e=wu("go","Data.Map.Internal",function(){return function(u,a){if(u instanceof jt)return a;if(u instanceof Gt)return e(170)(u.value4,t(u.value3)(e(170)(u.value5,a)));throw new Error("Failed pattern match at Data.Map.Internal (line 167, column 26 - line 170, column 43): "+[u.constructor.name])}}),n=e(167);return function(u){return n(u,r)}}},foldl:function(t){return function(r){var e=wu("go","Data.Map.Internal",function(){return function(u,a){if(a instanceof jt)return u;if(a instanceof Gt)return e(176)(t(e(176)(u,a.value4))(a.value3),a.value5);throw new Error("Failed pattern match at Data.Map.Internal (line 173, column 26 - line 176, column 43): "+[a.constructor.name])}}),n=e(173);return function(u){return n(r,u)}}},foldMap:function(t){var r=J(t),e=B(t.Semigroup0());return function(n){var u=function(a){if(a instanceof jt)return r;if(a instanceof Gt)return e(u(a.value4))(e(n(a.value3))(u(a.value5)));throw new Error("Failed pattern match at Data.Map.Internal (line 179, column 10 - line 182, column 28): "+[a.constructor.name])};return u}}},Fi={foldrWithIndex:function(t){return function(r){var e=wu("go","Data.Map.Internal",function(){return function(u,a){if(u instanceof jt)return a;if(u instanceof Gt)return e(190)(u.value4,t(u.value2)(u.value3)(e(190)(u.value5,a)));throw new Error("Failed pattern match at Data.Map.Internal (line 187, column 26 - line 190, column 45): "+[u.constructor.name])}}),n=e(187);return function(u){return n(u,r)}}},foldlWithIndex:function(t){return function(r){var e=wu("go","Data.Map.Internal",function(){return function(u,a){if(a instanceof jt)return u;if(a instanceof Gt)return e(196)(t(a.value2)(e(196)(u,a.value4))(a.value3),a.value5);throw new Error("Failed pattern match at Data.Map.Internal (line 193, column 26 - line 196, column 45): "+[a.constructor.name])}}),n=e(193);return function(u){return n(r,u)}}},foldMapWithIndex:function(t){var r=J(t),e=B(t.Semigroup0());return function(n){var u=function(a){if(a instanceof jt)return r;if(a instanceof Gt)return e(u(a.value4))(e(n(a.value2)(a.value3))(u(a.value5)));throw new Error("Failed pattern match at Data.Map.Internal (line 199, column 10 - line 202, column 30): "+[a.constructor.name])};return u}},Foldable0:function(){return nb}},ub=function(){return xu(Fi)(function(t){return function(r){return function(e){return new ur(t,e)}}})(Xt.value)}();var bn=function(){return jt.value}(),Sp=function(t){var r=Ci(t);return function(e){return er(e)(function(n){return function(u){return r(u.value0)(u.value1)(n)}})(bn)}};var Jo=function(t){var r=ct(t);return function(e){var n=function(u){if(u instanceof jt)return jt.value;if(u instanceof Gt){var a=r(e)(u.value2);if(a instanceof K)return ke(u.value2,u.value3,n(u.value4),u.value5);if(a instanceof Q)return ke(u.value2,u.value3,u.value4,n(u.value5));if(a instanceof ft)return gp(u.value4,u.value5);throw new Error("Failed pattern match at Data.Map.Internal (line 496, column 7 - line 499, column 43): "+[a.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 493, column 8 - line 499, column 43): "+[u.constructor.name])};return n}};var ga=function(t){var r=ct(t);return function(e){return function(n){return function(u){var a=Zs(r,n,u),p=e(a.value0);if(p instanceof g)return gp(a.value1,a.value2);if(p instanceof d)return ke(n,p.value0,a.value1,a.value2);throw new Error("Failed pattern match at Data.Map.Internal (line 512, column 3 - line 516, column 41): "+[p.constructor.name])}}}};var Lu=function(t){return t.filterMap};var Fp=Ar(),kh=kr(Ye),dh=er(Ye),yh=gr(Ye);var gh=function(t){return Fp(jo(t))};var Cp=function(t){return ub(t)};var ib=function(t){return Xo(t)(void 0)};var Tp=function(t){return{append:gh(t)}},ob=function(t){return Fp(eb(t))};var Sh=function(t){var r=Ci(t);return function(e){return function(n){return r(e)(void 0)(n)}}};var fb={foldMap:function(t){var r=kh(t);return function(e){var n=r(e);return function(u){return n(Cp(u))}}},foldl:function(t){return function(r){var e=dh(t)(r);return function(n){return e(Cp(n))}}},foldr:function(t){return function(r){var e=yh(t)(r);return function(n){return e(Cp(n))}}}};var cb=bn,xp=function(t){var r=er(t);return function(e){var n=Sh(e);return r(function(u){return function(a){return n(a)(u)}})(cb)}};var pb=function(t){var r=Tp(t);return{mempty:cb,Semigroup0:function(){return r}}};var lb=function(t){return Fp(Jo(t))};function _b(t){return function(r){return function(){return setTimeout(r,t)}}}function vb(t){return function(){clearTimeout(t)}}var hh=ct(Vt);var sb=_b;var Ch={eq:function(t){return function(r){return t===r}}},Ko={compare:function(t){return function(r){return hh(t)(r)}},Eq0:function(){return Ch}};var bb=vb;var mn=function(r){return function(e){return r(e)()}};var xi=function(r){return function(e){return function(){return r(e)}}};var Vh=function(t){var r=B(Dc(t));return{append:function(e){return function(n){return mn(function(u){return r(xi(e)(u))(xi(n)(u))})}}}};var Db=function(t){var r=J(Tn(t)),e=Vh(t.Semigroup0());return{mempty:mn(function(n){return r}),Semigroup0:function(){return e}}};var Pu=function(t){return t.keepLatest};function wp(t){return function(r){return t===r}}var Ab=wp;var yb=function(t,r,e){var n=0,u;return function(a){if(n===2)return u;if(n===1)throw new ReferenceError(t+" was needed before it finished initializing (module "+r+", line "+a+")",r,a);return n=1,u=e(),n=2,u}},gb=_n(Or),Zo=gb(Zn),Ru=P(Or),Ze=Tu(Fu),Jh=Tn(Fn),Ei=Ot($),Kh=B(xr),Sb=J(Db(Fn)),Qh=J(pb(Ko)),Yh=lb(Ko),Zh=B(Tp(Ko)),tC=gb(fb),rC=St(oi),eC=S($);var nC=function(t){return function(r){return function(e,n){var u=jr(g.value)(),a=t(e,function(l){return Xr(new d(l))(u)()}),p=r(e,function(l){var _=Sr(u)();return Zo(_)(function(y){return function(){return n(l(y))}})()});return function(){return a(),p()}}}},uC=function(t){return function(r){return function(e,n){var u=jr(g.value)(),a=t(e,function(l){var _=Sr(u)();return Zo(_)(function(y){return function(){return n(y(l))}})()}),p=r(e,function(l){return Xr(new d(l))(u)()});return function(){return a(),p()}}}},Ou=function(t){var r=kr(t)(Jh);return function(e){return function(n,u){var a=Ze(xn)();return r(function(p){return function(){var _=p(n,u);return Ei(Ze(je(_)(a)))()}})(e)(),function(){var l=Ze(yo(a))();return qs(l)}}}},kb=function(t){var r=ga(t),e=hi(t);return function(){var u=jr(bn)();return{event:function(a){return function(p,l){return Ei(Do(r(function(_){if(_ instanceof g)return new d([l]);if(_ instanceof d)return new d(Kh(_.value0)([l]));throw new Error("Failed pattern match at FRP.Event (line 568, column 17 - line 570, column 51): "+[_.constructor.name])})(a))(u))(),Ei(Do(r(function(_){if(_ instanceof g)return g.value;if(_ instanceof d)return new d(Yc(Ab)(l)(_.value0));throw new Error("Failed pattern match at FRP.Event (line 577, column 17 - line 579, column 65): "+[_.constructor.name])})(a))(u))}},push:function(a){var p=Sr(u)(),l=e(a.address)(p);if(l instanceof g)return void 0;if(l instanceof d)return Go(l.value0,function(_){return _(a.payload)});throw new Error("Failed pattern match at FRP.Event (line 586, column 9 - line 588, column 95): "+[l.constructor.name])}}}},aC=function(t){return function(r,e){var n=jr(Ru(void 0))(),u=t(r,function(a){var p=Sr(n)();p();var l=a(r,e);return Xr(l)(n)()});return function(){var p=Sr(n)();return p(),u()}}},Yt={map:function(t){return function(r){return function(e,n){return r(e,function(u){return n(t(u))})}}}},iC=S(Yt),Mi=function(t){return function(r){return function(e,n){return r(e,function(u){var a=t(u);if(a instanceof d)return n(a.value0);if(a instanceof g)return void 0;throw new Error("Failed pattern match at FRP.Event (line 225, column 31 - line 227, column 35): "+[a.constructor.name])})}}},Ip=function(t){return Mi(function(r){var e=t(r);if(e)return new d(r);if(!e)return g.value;throw new Error("Failed pattern match at FRP.Event (line 141, column 13 - line 143, column 25): "+[e.constructor.name])})},Yo=function(){var r=vp(),e=jr(0)();return{event:function(n,u){var a=jr(u)(),p=Sr(e)();return sp(p,a,r),fi(function(l){return l+1|0})(e)(),function(){return Xr(Sb)(a)(),bp(p,r),void 0}},push:function(n){return _p(r,function(u){var a=Sr(u)();return a(n)})}}},oC=function(t){return function(r,e){var n=Yo(),u=t(n.event),a=n.event(r,e),p=u(r,n.push);return function(){return p(),a()}}},fC={compact:Mi(At(kt)),separate:function(t){return{left:Mi(function(r){if(r instanceof Ut)return new d(r.value0);if(r instanceof Nt)return g.value;throw new Error("Failed pattern match at FRP.Event (line 124, column 13 - line 126, column 33): "+[r.constructor.name])})(t),right:Mi(function(r){if(r instanceof Nt)return new d(r.value0);if(r instanceof Ut)return g.value;throw new Error("Failed pattern match at FRP.Event (line 131, column 13 - line 133, column 32): "+[r.constructor.name])})(t)}}},wi={filter:Ip,filterMap:Mi,partition:function(t){return function(r){return{yes:Ip(t)(r),no:Ip(function(e){return!t(e)})(r)}}},partitionMap:function(t){return function(r){return{left:Lu(wi)(function(){var e=Au(d.create)(h(g.value));return function(n){return e(t(n))}}())(r),right:Lu(wi)(function(e){return sc(t(e))})(r)}}},Compactable0:function(){return fC},Functor1:function(){return Yt}},cC=function(t){return function(r){return function(e,n){var u=jr(g.value)(),a=Ze(xn)(),p=jr(g.value)(),l=Ze(xn)(),_=jr(!0)(),y=t(e,function(R){var _t=Sr(_)();if(_t)return Ei(Ze(je(R)(a)))();Xr(new d(R))(u)();var at=Sr(p)();return Zo(at)(function(Ct){return function(){return n(Ct(R))}})()}),w=r(e,function(R){var _t=Sr(_)();if(_t)return Ei(Ze(je(R)(l)))();Xr(new d(R))(p)();var at=Sr(u)();return Zo(at)(function(Ct){return function(){return n(R(Ct))}})()});Xr(!1)(_)();var x=Ze(yo(a))(),M=Ze(yo(l))();return function(){return x.length===0?Xr(Jc(M))(p)():Go(x,function(R){return Xr(new d(R))(u)(),Go(M,function(_t){return Xr(new d(_t))(p)(),n(_t(R))})})}(),Ze(hc(0)(qe(x))([])(a))(),Ze(hc(0)(qe(M))([])(l))(),function(){return y(),w()}}}},Ii=function(t){return function(r){return r}(Pp(345).subscribe)(t)},Pp=yb("backdoor","FRP.Event",function(){var t=function(){var e=vp(),n=jr(0)();return{event:function(u,a){var p=jr(a)(),l=Sr(n)();return sp(l,p,e),fi(function(_){return _+1|0})(n)(),function(){return Xr(Sb)(p)(),bp(l,e),void 0}},push:function(u){return function(){return _p(e,function(a){var p=Sr(a)();return p(u)})}}}};return{createO:Yo,makeEvent:function(){var r=function(e){return function(n,u){return n?Ru(void 0):e(function(a){return function(){return u(a)}})()}};return r}(),makeEventO:function(){var r=function(e){return function(n,u){return n?Ru(void 0):e(u)}};return r}(),makePureEvent:function(){var r=function(e){return function(n,u){return e(function(a){return function(){return u(a)}})()}};return r}(),makeLemmingEvent:function(){var r=function(e){return function(n,u){var a=function(p){return function(l){return function(){return p(n,mn(l))}}};return e(a)(function(p){return function(){return u(p)}})()}};return r}(),makeLemmingEventO:function(){var r=function(e){return function(n,u){var a=function(p,l){return p(n,l)};return e(a,u)}};return r}(),create:t,createPure:t,createPureO:Yo,subscribe:function(){var r=function(e){return function(n){return function(){return e(!1,mn(n))}}};return r}(),subscribeO:function(){var r=function(e,n){return e(!1,n)};return r}(),subscribePureO:function(){var r=function(e,n){return e(!0,n)};return r}(),subscribePure:function(){var r=function(){var e=function(n){return function(u){return function(){return n(!0,mn(u))}}};return e}();return r}(),bus:function(){var r=function(e){return function(n,u){var a=db(819)();return u(e(a.push)(a.event)),Ru(void 0)}};return r}(),memoize:function(){var r=function(e){return function(n){return function(u,a){var p=Yo();return a(n(p.event)),e(u,p.push)}}};return r}(),hot:function(){var r=function(e){return function(){var u=db(837)(),a=Ii(e)(u.push)();return{event:u.event,unsubscribe:a}}};return r}(),mailbox:function(){var r=function(e){return function(){var u=kb(e)();return{event:u.event,push:function(a){return function(){return u.push(a)}}}}};return r}(),mailboxed:function(){var r=function(e){var n=kb(e);return function(u){return function(a){return function(p,l){var _=n();return l(a(_.event)),u(p,_.push)}}}};return r}(),delay:function(){var r=function(e){return function(n){return function(u,a){var p=jr(Qh)(),l=n(u,function(_){var y=jr(g.value)(),w=sb(e)(function(){a(_);var M=Sr(y)();return Qt(Ru(void 0))(function(R){return fi(Yh(R))(p)})(M)()})();return Xr(new d(w))(y)(),fi(Zh(ib(w)))(p)()});return function(){var y=Sr(p)();return tC(y)(bb)(),l()}}}};return r}()}}),db=yb("create","FRP.Event",function(){return function(){return void 0,function(r){return r}(Pp(461).create)()}}),Nu=Pp(678);var Rp=function(t){return function(r){return r}(Nu.bus)(t)};var Sa=function(t){return function(r){return r}(Nu.makeEvent)(t)},$b=function(t){return function(r){return r}(Nu.makeEventO)(t)},Op=function(t){return function(r){return r}(Nu.makeLemmingEvent)(t)},Dn=function(t){return function(r){return r}(Nu.makeLemmingEventO)(t)};var tf=function(t){return function(r){return r}(Nu.memoize)(t)},hb=function(){return function(t){return t}(Nu.subscribeO)}();var Cb={apply:function(t){return function(r){return cC(t)(iC(ta)(r))}},Functor0:function(){return Yt}},pC=mr(Cb),lC=function(t){return{append:pC(B(t))}},_r={pure:function(t){return function(r,e){return e(t),Ru(void 0)}},Apply0:function(){return Cb}},_C=P(_r);var rf=function(t){var r=lC(t.Semigroup0());return{mempty:_C(J(t)),Semigroup0:function(){return r}}};var Oe={alt:function(t){return function(r){return function(e,n){return rC(eC(function(u){return function(a){return function(){return u(),a()}}})(function(){return t(e,n)}))(function(){return r(e,n)})()}}},Functor0:function(){return Yt}};var An={empty:function(t,r){return Ru(void 0)},Alt0:function(){return Oe}},vC={Applicative0:function(){return _r},Plus1:function(){return An}},$a={keepLatest:aC,sampleOnRight:nC,sampleOnLeft:uC,fix:oC,Alternative0:function(){return vC},Filterable1:function(){return wi}};var Up=function(t){var r=Vr(t);return function(){return function(e){return function(n){return en(r(e))(n)}}}};var tn=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),ha=function(){function t(){}return t.value=new t,t}();var Wp=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),Bp=function(){function t(){}return t.value=new t,t}(),Hp=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),xb=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),qp=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),Uu=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),fe=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}();var ou={eq:function(t){return function(r){return t instanceof tn&&r instanceof tn?t.value0===r.value0:t instanceof ha&&r instanceof ha}}};var Gp=function(t){return new qp(t)},Wu=function(t){return new Uu(t)};var Mb=function(t,r){for(var e=r[r.length-1],n=r.length-2;n>=0;n--)e=t(r[n])(e);return e},Eb=function(t,r){for(var e=r[0],n=r.length,u=1;u<n;u++)e=t(e)(r[u]);return e},AC=function(){function t(p){this.fn=p}var r={},e=function(p,l){this.head=p,this.tail=l};function n(p){return new e(p,r)}function u(p){return function(l){return new e(p,l)}}function a(p){for(var l=[],_=p;_!==r;)l.push(_.head),_=_.tail;return l}return function(p,l,_){var y=function(x,M){return p(l(u)(_(x)))(M)},w=function(x,M,R){if(M===0)return x;var _t=R[M-1];return new t(function(){var at=w(y(_t,x),M-1,R);return at})};return function(x){for(var M=l(n)(_(x[x.length-1])),R=w(M,x.length-1,x);R instanceof t;)R=R.fn();return l(a)(R)}}}();var Ib=function(t){return t};var Lb=ru;var Pi=Kt;var yC=Pt,Ca={foldMap1:function(t){return cs(Ca)(Pi)(t)},foldr1:tu(Mb),foldl1:tu(Eb),Foldable0:function(){return yC}};var RC=wr(),OC=Vc();var NC=Ib;var Ri=function(t){return t};var Rb=function(t){return function(r){return RC(t(Ri(r)))}},Oi=Rb(Kc);var Ob=Rb(Xc);var zp=function(t){return function(r){return t(Ri(r))}};var Ni=zp(qe);var UC=function(t){var r=zp(t);return function(e){return NC(r(e))}};var Nb=function(t){return UC(wo(t))};var Ub=function(){return zp(OC)},WC=Ub(),Wb=function(t){var r=ba(t);return function(e){var n=Ni(e),u=function(a){return new T(WC(e)(a),function(){var p=a<(n-1|0);return p?new d(a+1|0):g.value}())};return r(u)(0)}};var Ta=function(t){return t.reflectType};function qb(t){return function(){var r={};for(var e in t)hasOwnProperty.call(t,e)&&(r[e]=t[e]);return r}}var xa={};function Xp(t){return t()}function Gb(t){return function(r){return function(e){return function(n){var u=e;function a(l){return function(_){return r(_)(l)(n[l])}}for(var p in n)hasOwnProperty.call(n,p)&&(u=t(u)(a(p)));return u}}}}function ff(t){return function(r){var e=[];for(var n in r)hasOwnProperty.call(r,n)&&e.push(t(n)(r[n]));return e}}var zC=Object.keys||ff(function(t){return function(){return t}});function jp(t){return function(r){return function(e){return function(){return e[t]=r,e}}}}var Jp=function(t){return function(r){return function(){return delete r[t],r}}};var QC=gr(Pt);var YC=ff(function(t){return function(r){return r}});var ZC=qb;var zb=function(t){return function(r){return Xp(function(){var n=ZC(r)();return t(n)(),n})}};var Ma=function(t){return function(r){return zb(jp(t)(r))}};var Vb=Gb(ta),tF=function(t){var r=B(t.Semigroup0()),e=J(t);return function(n){return Vb(function(u){return function(a){return function(p){return r(u)(n(a)(p))}}})(e)}},Xb={foldl:function(t){return Vb(function(r){return function(e){return t(r)}})},foldr:function(t){return function(r){return function(e){return QC(t)(r)(YC(e))}}},foldMap:function(t){var r=tF(t);return function(e){return r(h(e))}}};var Kp=function(t){return zb(Jp(t))};var iF=Pu($a),oF=S(Yt),fF=Ou(Pt);var cF=vt(ci);var Ea=P(Dr),pF=S(Ir);var Qb=_n(Dr),lF=Qb(Zn);var kn=Ot(Ir);var _F=Qb(Pt);var vF=S(Kt),Jb=B(gc(vo)),sF=_a(Dr)(Pt),bF=B(xr),mF=er(Xb),DF=Sn(Ao),Kb=function(){function t(){}return t.value=new t,t}(),Qp=function(){function t(){}return t.value=new t,t}(),AF=function(){function t(){}return t.value=new t,t}();var rn=function(t){return function(r){return function(e){var n=function(u){return u(r)(e)};return function(u){if(u instanceof qp)return fF(vF(rn(t)(r)(e))(u.value0));if(u instanceof Uu)return iF(oF(rn(t)(r)(e))(u.value0));if(u instanceof fe)return n(t.toElt(u.value0));if(u instanceof xb)return Dn(function(a,p){var l=$r(xa)(),_=a(u.value0,function(y){var w=t.ids(e)(),x=$r(Ea(void 0))(),M=t.ids(e)(),R=$r(Ea(void 0))(),_t=$r([])(),at=$r(Ea(void 0))(),Ct=pF(tn.create)(function(){if(r.scope instanceof ha)return t.ids(e);if(r.scope instanceof tn)return Jb(Ea(r.scope.value0))(Jb(Ea("!"))(t.ids(e)));throw new Error("Failed pattern match at Bolson.Control (line 547, column 17 - line 549, column 67): "+[r.scope.constructor.name])}())(),Ft=$r(Kb.value)(),nr=a(y,function(Be){var X=lr(Ft)();if(Be instanceof Hp&&X instanceof Qp){var ar=lr(_t)();return sF(function(gn){return function(){return p(t.doLogic(Be.value0)(e)(gn))}})(ar)()}if(Be instanceof Bp&&X instanceof Qp){kn(ee(AF.value)(Ft))();var He=function(){var fu=lr(_t)();_F(fu)(function(Bn){return lF(r.parent)(function(zr){return function(){return p(t.disconnectElement(e)({id:Bn,parent:zr,scope:Ct}))}})})();var Wn=lr(x)();Wn();var nc=lr(R)();return nc(),kn(Xe(Kp(w))(l))(),kn(Xe(Kp(M))(l))()};return kn(ee(He)(at))(),He()}if(Be instanceof Wp&&X instanceof Kb){kn(ee(Qp.value)(Ft))();var co=a(rn(t)(function(){var gn={};for(var fu in r)({}).hasOwnProperty.call(r,fu)&&(gn[fu]=r[fu]);return gn.scope=Ct,gn.raiseId=function(Wn){return kn(Xe(bF([Wn]))(_t))},gn}())(e)(Be.value0),p);return kn(Xe(Ma(M)(co))(l))(),kn(ee(co)(R))()}return void 0});kn(ee(nr)(x))(),kn(Xe(Ma(w)(nr))(l))();var ye=lr(at)();return ye()});return function(){return cF(lr(l))(mF(DF)(Ea(void 0)))(),_()}});throw new Error("Failed pattern match at Bolson.Control (line 520, column 17 - line 610, column 20): "+[u.constructor.name])}}}};var cf=function(){function t(r,e){this.value0=r,this.value1=e}return t.create=function(r){return function(e){return new t(r,e)}},t}();var Yp=function(t){var r=!1,e;function n(u){if(u.value0 instanceof Xt&&u.value1 instanceof Xt)return r=!0,g.value;if(u.value0 instanceof Xt){t=new cf(kp(u.value1),Xt.value);return}if(u.value0 instanceof ur)return r=!0,new d(new T(u.value0.value0,new cf(u.value0.value1,u.value1)));throw new Error("Failed pattern match at Data.CatQueue (line 82, column 1 - line 82, column 63): "+[u.constructor.name])}for(;!r;)e=n(t);return e},Zp=function(t){return function(r){return new cf(t.value0,new ur(r,t.value1))}};var Yb=function(t){return t.value0 instanceof Xt&&t.value1 instanceof Xt};var tl=function(){return new cf(Xt.value,Xt.value)}();var wa=function(){function t(){}return t.value=new t,t}(),pf=function(){function t(r,e){this.value0=r,this.value1=e}return t.create=function(r){return function(e){return new t(r,e)}},t}();var tm=function(t){return function(r){if(t instanceof wa)return r;if(r instanceof wa)return t;if(t instanceof pf)return new pf(t.value0,Zp(t.value1)(r));throw new Error("Failed pattern match at Data.CatList (line 108, column 1 - line 108, column 54): "+[t.constructor.name,r.constructor.name])}},yF=function(t){return function(r){return function(e){var n=function(a){return function(p){return function(l){var _=a,y=p,w=!1,x;function M(R,_t,at){if(at instanceof Xt)return w=!0,_t;if(at instanceof ur){_=R,y=R(_t)(at.value0),l=at.value1;return}throw new Error("Failed pattern match at Data.CatList (line 124, column 3 - line 124, column 59): "+[R.constructor.name,_t.constructor.name,at.constructor.name])}for(;!w;)x=M(_,y,l);return x}}},u=function(a){return function(p){var l=a,_=!1,y;function w(x,M){var R=Yp(x);if(R instanceof g)return _=!0,n(function(_t){return function(at){return at(_t)}})(r)(M);if(R instanceof d){l=R.value0.value1,p=new ur(t(R.value0.value0),M);return}throw new Error("Failed pattern match at Data.CatList (line 120, column 14 - line 122, column 67): "+[R.constructor.name])}for(;!_;)y=w(l,p);return y}};return u(e)(Xt.value)}}},rm=function(t){if(t instanceof wa)return g.value;if(t instanceof pf)return new d(new T(t.value0,function(){var r=Yb(t.value1);return r?wa.value:yF(tm)(wa.value)(t.value1)}()));throw new Error("Failed pattern match at Data.CatList (line 99, column 1 - line 99, column 61): "+[t.constructor.name])};var em=function(){return wa.value}(),nm=tm;var um={append:nm};var am=function(t){return function(r){return nm(t)(new pf(r,tl))}};var SF=function(t,r,e){var n=0,u;return function(a){if(n===2)return u;if(n===1)throw new ReferenceError(t+" was needed before it finished initializing (module "+r+", line "+a+")",r,a);return n=1,u=e(),n=2,u}},$F=B(um);var rl=function(){function t(r,e){this.value0=r,this.value1=e}return t.create=function(r){return function(e){return new t(r,e)}},t}(),lf=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),Wi=function(){function t(r,e){this.value0=r,this.value1=e}return t.create=function(r){return function(e){return new t(r,e)}},t}(),hF=function(t){var r=!1,e;function n(u){var a=function(_){return _},p=function(_){return function(y){return new rl(_.value0,$F(_.value1)(y))}};if(u.value0 instanceof lf){var l=rm(u.value1);if(l instanceof g)return r=!0,new lf(u.value0.value0);if(l instanceof d){t=p(a(l.value0.value0)(u.value0.value0))(l.value0.value1);return}throw new Error("Failed pattern match at Control.Monad.Free (line 227, column 7 - line 231, column 64): "+[l.constructor.name])}if(u.value0 instanceof Wi)return r=!0,new Wi(u.value0.value0,function(_){return p(u.value0.value1(_))(u.value1)});throw new Error("Failed pattern match at Control.Monad.Free (line 225, column 3 - line 233, column 56): "+[u.value0.constructor.name])}for(;!r;)e=n(t);return e};var CF=function(t){return function(r){return function(e){var n=hF(e);if(n instanceof lf)return r(n.value0);if(n instanceof Wi)return t(n.value0)(n.value1);throw new Error("Failed pattern match at Control.Monad.Free (line 213, column 17 - line 215, column 20): "+[n.constructor.name])}}},im=function(t){var r=S(t);return CF(function(e){return function(n){return new Ut(r(n)(e))}})(Nt.create)},el=function(t){return new rl(t,em)},om=function(t){return el(new Wi(t,N))};var FF={Applicative0:function(){return nl},Bind1:function(){return _f}},TF={map:function(t){return function(r){return an(_f)(function(){var e=P(nl);return function(n){return e(t(n))}}())(r)}}},_f={bind:function(t){return function(r){return new rl(t.value0,am(t.value1)(r))}},Apply0:function(){return fm(0)}},nl={pure:function(t){return el(lf.create(t))},Apply0:function(){return fm(0)}},fm=SF("freeApply","Control.Monad.Free",function(){return{apply:ae(FF),Functor0:function(){return TF}}});var xF=P(nl);var qr=function(t){return el(new Wi(t,function(r){return xF(r)}))};var MF=At(kt);var Ia={dimap:function(t){return function(r){return function(e){return function(n){return r(e(t(n)))}}}}},lm=function(t){return t.dimap},La=function(t){var r=lm(t);return function(e){return r(e)(MF)}};var EF=P(_r);var wF=function(t){return t},On=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),Bi=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),sf=function(){function t(){}return t.value=new t,t}(),IF=function(t){return t};var bf=Ar(),i=IF,ul=function(t){return function(r){return i({key:"data-"+t,value:new On(r)})}};var c=function(){return On.create}();var E=function(){return Bi.create}(),mf=function(){var t=S(te)(S($)(h(!0)));return function(r){return wF(t(r))}}(),Hi=function(t){return t.attr};var ne=function(t){var r=Hi(t);return function(e){return function(n){return EF(r(e)(n))}}};var _m=S(Yt),LF=La(Ia);var PF=Ar();var RF=function(t){return function(r){var e=function(n){var u=function(a){return a instanceof fe?new fe(LF(function(p){return{pos:t,dynFamily:p.dynFamily,ez:p.ez,parent:p.parent,raiseId:p.raiseId,scope:p.scope}})(a.value0)):a instanceof Uu?new Uu(_m(u)(a.value0)):a};return u(n)};return e(r)}},vm=function(t){return RF(d.create(t))};var sm=function(t){return Rp(t)};var OF=function(t){var r=function(n){return new Uu(PF(n))},e=sm(t);return r(_m(function(n){return n})(e))},bm=function(t){return OF(ca(t))};var Am=S(Yt);var al=Ou(Pt),Pa=P(_r),km=v(An),dm=P(Dr);var WF=Ar(),BF=Jr(),HF=j(ou),ym=qt(Oe),qF=B(xr),GF=vn(En),Dm=S(te);var zF=function(t){return function(r){return function(e){return Am(function(n){return t.setText(function(u){return{id:r,text:u}}(n))})(e)}}},VF=function(t){return function(r){return function(e){return Am(function(n){return function(u){if(u.value instanceof On)return t.setProp({id:r,key:u.key,value:u.value.value0});if(u.value instanceof Bi)return t.setCb({id:r,key:u.key,value:u.value.value0});if(u.value instanceof sf)return t.unsetAttribute({id:r,key:u.key});throw new Error("Failed pattern match at Deku.Control (line 72, column 28 - line 75, column 47): "+[u.value.constructor.name])}(bf(n))})(e)}}};var XF=function(t){var r=function(n){return function(u){return Dn(function(a,p){var l=u.ids();n.raiseId(l)();var _=a(al([Pa(u.makeText({id:l,parent:n.parent,pos:n.pos,scope:n.scope,dynFamily:n.dynFamily})),zF(u)(l)(t),Qt(km)(function(y){return Pa(u.attributeParent({id:l,parent:y,pos:n.pos,dynFamily:n.dynFamily,ez:n.ez}))})(n.parent)]),p);return function(){return p(u.deleteFromCache({id:l})),_()}})}},e=new fe(r);return e},D=function(t){return XF(Pa(t))};var jF=function(){return{doLogic:function(t){return function(r){return function(e){return r.sendToPos({id:e,pos:t})}}},ids:function(t){return function(r){return r.ids}(BF(t))},disconnectElement:function(t){return function(r){return t.disconnectElement({id:r.id,scope:r.scope,parent:r.parent,scopeEq:HF})}},toElt:function(t){return t}}},JF=jF();var gm=function(t){return function(r){return function(e){return rn(JF)(t)(r)(e)}}},Sm=function(t){return function(r){var e=function(n){return function(u){return Dn(function(a,p){return a(ym(Pa(u.makeRoot({id:"deku-root",root:t})))(gm({parent:new d("deku-root"),scope:new tn("rootScope"),raiseId:function(l){return dm(void 0)},ez:!0,pos:g.value,dynFamily:g.value})(u)(n)),p)})}};return e(r)}},KF=function(t){return function(r){return function(e){var n=function(u){return function(a){return Dn(function(p,l){var _=a.ids();u.raiseId(_)();var y=p(ym(al(qF([Pa(a.makeElement({id:_,parent:u.parent,scope:u.scope,tag:t,pos:u.pos,dynFamily:u.dynFamily})),VF(a)(_)(r)])(Qt([])(function(w){return[Pa(a.attributeParent({id:_,parent:w,pos:u.pos,dynFamily:u.dynFamily,ez:u.ez}))]})(u.parent))))(gm({parent:new d(_),scope:u.scope,ez:!0,raiseId:function(w){return dm(void 0)},pos:g.value,dynFamily:g.value})(a)(e)),l);return function(){return l(a.deleteFromCache({id:_})),y()}})}};return n}}},A=function(t){return function(r){return function(e){var n=function(a){return a.length===0?km:a.length===1?a[0]:al(a)},u=function(a){return new fe(KF(t)(n(r))(Gp(WF(a))))};return u(GF(Dm(Dm(function(a){return a}))(vm))(e))}}};var $m=t=>r=>e=>()=>{if(e.units[r.id]){let n=e.units[r.parent].main;e.units[r.id].main&&e.units[r.id].main.parentNode||e.units[r.id].startBeacon&&e.units[r.id].startBeacon.parentNode||(r.ez?(()=>(e.units[r.id].main?n.appendChild(e.units[r.id].main):(n.appendChild(e.units[r.id].startBeacon),n.appendChild(e.units[r.id].endBeacon)),!0))():t(r.pos)(a=>()=>t(r.dynFamily)(p=>()=>{for(var l=0,_=0,y;_<n.childNodes.length;){if(n.childNodes[_].nodeType===8&&n.childNodes[_].nodeValue==="%-%"+p){_+=1;break}_++}let w=M=>{let R=n.childNodes[M];e.units[r.id].startBeacon?(n.insertBefore(e.units[r.id].startBeacon,R),n.insertBefore(e.units[r.id].endBeacon,R)):n.insertBefore(e.units[r.id].main,R)};for(;_<n.childNodes.length;){var x;if((x=n.childNodes[_].$dekuId)&&t(e.units[x].dynFamily)(R=>()=>t(e.units[x].pos)(at=>()=>p===R&&a<=at?(w(_),!0):!1)())())return!0;if(l===a||n.childNodes[_].nodeType===8&&n.childNodes[_].nodeValue==="%-%"+p+"%-%")return w(_),!0;n.childNodes[_].nodeType===8&&n.childNodes[_].nodeValue.substring(0,3)==="%-%"&&!y&&(y=n.childNodes[_].nodeValue+"%-%"),y||l++,n.childNodes[_].nodeType===8&&n.childNodes[_].nodeValue===y&&(y=void 0,l++),_++}return!1})())())||(r.parent.indexOf("@!%")!==-1?t(r.dynFamily)(p=>()=>(e.units[r.id].main?e.units[p].endBeacon.parentNode.insertBefore(e.units[r.id].main,e.units[p].endBeacon):(e.units[p].endBeacon.parentNode.insertBefore(e.units[r.id].endBeacon,e.units[p].endBeacon),e.units[p].endBeacon.parentNode.insertBefore(e.units[r.id].startBeacon,e.units[r.id].endBeacon)),!0))()||(e.units[r.id].main?n.parentNode.replaceChild(e.units[r.id].main,n):(n.parentNode.replaceChild(e.units[r.id].endBeacon,n),e.units[r.id].endBeacon.parentNode.insertBefore(e.units[r.id].startBeacon,e.units[r.id].endBeacon))):t(r.dynFamily)(p=>()=>(e.units[r.id].startBeacon?(n.insertBefore(e.units[r.id].startBeacon,e.units[p].endBeacon),n.insertBefore(e.units[r.id].endBeacon,e.units[p].endBeacon)):n.insertBefore(e.units[r.id].main,e.units[p].endBeacon),!0))()||(e.units[r.id].startBeacon?(n.appendChild(e.units[r.id].startBeacon),n.appendChild(e.units[r.id].endBeacon)):n.appendChild(e.units[r.id].main)))}};var hm=t=>r=>e=>n=>()=>{var u,a,p=e.id;if(n.scopes[e.scope]||(n.scopes[e.scope]=[]),n.scopes[e.scope].push(p),!t(e.parent)(()=>()=>n.hydrating&&r&&(u=n.allBeacons[e.id])&&(a=n.allBeacons[`${e.id}%-%`])?(n.units[p]={listeners:{},parent:e.parent,scope:e.scope,pos:e.pos,dynFamily:e.dynFamily,startBeacon:u,endBeacon:a},u.$dekuId=p,a.$dekuId=p,!0):!1)()){let _=document.createComment(`%-%${e.id}`),y=document.createComment(`%-%${e.id}%-%`);n.units[p]={listeners:{},parent:e.parent,dynFamily:e.dynFamily,scope:e.scope,pos:e.pos,startBeacon:_,endBeacon:y},_.$dekuId=p,y.$dekuId=p}},QF=new Set(["animate","animateMotion","animateTransform","circle","clipPath","defs","desc","discard","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","foreignObject","g","image","line","linearGradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialGradient","rect","set","stop","svg","switch","symbol","text","textPath","title","tspan","use","view"]);var Cm=t=>r=>()=>r.units[t]&&r.units[t].dynFamily?r.units[t].dynFamily:(()=>{throw new Error(`No positional information for ${t}`)})(),Fm=t=>r=>()=>r.units[t]&&r.units[t].main&&r.units[t].main.parentNode&&r.units[t].main.parentNode.$dekuId?r.units[t].main.parentNode.$dekuId:r.units[t]&&r.units[t].startBeacon&&r.units[t].startBeacon.parentNode&&r.units[t].startBeacon.parentNode.$dekuId?r.units[t].startBeacon.parentNode.$dekuId:(()=>{throw new Error(`No parent information for ${t}`)})(),il=t=>r=>()=>r.units[t]&&r.units[t].scope?r.units[t].scope:(()=>{throw new Error(`No scope information for ${t}`)})(),Tm=t=>r=>e=>n=>()=>{var u,a=e.id;if(n.scopes[e.scope]||(n.scopes[e.scope]=[]),n.scopes[e.scope].push(a),!t(e.parent)(()=>()=>n.hydrating&&r&&(u=document.documentElement.querySelector(`[data-deku-ssr="${a}"]`))?(n.units[a]={listeners:{},pos:e.pos,parent:e.parent,scope:e.scope,dynFamily:e.dynFamily,main:u},u.$dekuId=a,!0):!1)()){let l=QF.has(e.tag)?document.createElementNS("http://www.w3.org/2000/svg",e.tag):document.createElement(e.tag);n.units[a]={listeners:{},parent:e.parent,pos:e.pos,scope:e.scope,dynFamily:e.dynFamily,main:l},l.$dekuId=a}},xm=t=>r=>e=>n=>u=>()=>{var a=n.id,p;if(u.scopes[n.scope]||(u.scopes[n.scope]=[]),u.scopes[n.scope].push(a),!t(n.parent)(_=>()=>{if(u.hydrating&&r&&(p=document.documentElement.querySelector(`[data-deku-ssr="${_}"]`))){for(var y=0;y<p.childNodes.length;y++){let M=a.split("@-@");if(p.childNodes[y].nodeType===8&&p.childNodes[y].nodeValue===M[0]){var w=y===0||p.childNodes[y-1].nodeType!==3;w&&y!==0?p.insertBefore(document.createTextNode(""),p.childNodes[y]):w?p.prepend(document.createTextNode("")):y=y-1;break}}let x=p.childNodes[y];return u.units[a]={main:x,pos:n.pos,parent:n.parent,scope:n.scope},x.$dekuId=a,!0}return!1})()){let _=document.createTextNode("");u.units[a]={main:_,parent:n.parent,scope:n.scope,pos:n.pos,dynFamily:n.dynFamily},_.$dekuId=a}};function ol(){return{units:{},scopes:{},allBeacons:{}}}var Mm=t=>r=>e=>()=>{if(e.units[r.id]){var n=r.id,u=r.value;e.hydrating&&t&&!e.units[n]&&(dom=document.documentElement.querySelector(`[data-deku-ssr="${n}"]`))&&(e.units[n]={listeners:{},parent:r.parent,scope:r.scope,main:dom},e.scopes[r.scope]||(e.scopes[r.scope]=[]),e.scopes[r.scope].push(n)),e.units[n].main.tagName==="INPUT"&&r.key==="value"||e.units[n].main.tagName==="TEXTAREA"&&r.key==="value"?e.units[n].main.value=u:e.units[n].main.tagName==="INPUT"&&r.key==="checked"?e.units[n].main.checked=u==="true":r.key==="disabled"?e.units[n].main.disabled=u==="true":e.units[n].main.setAttribute(r.key,u)}},Em=t=>r=>e=>()=>{if(e.units[r.id]){var n=r.id,u=r.value;if(e.hydrating&&t&&!e.units[n]&&(dom=document.documentElement.querySelector(`[data-deku-ssr="${n}"]`))&&(e.units[n]={listeners:{},parent:r.parent,scope:r.scope,main:dom},e.scopes[r.scope]||(e.scopes[r.scope]=[]),e.scopes[r.scope].push(n)),r.key==="@self@")u(e.units[n].main)();else{e.units[n].listeners[r.key]&&e.units[n].main.removeEventListener(r.key,e.units[n].listeners[r.key]);var a=p=>u(p)();e.units[n].main.addEventListener(r.key,a),e.units[n].listeners[r.key]=a}}},wm=t=>r=>e=>()=>{if(e.units[r.id]){var n=r.id;e.hydrating&&t&&!e.units[n]&&(dom=document.documentElement.querySelector(`[data-deku-ssr="${n}"]`))&&(e.units[n]={listeners:{},parent:r.parent,scope:r.scope,main:dom},e.scopes[r.scope]||(e.scopes[r.scope]=[]),e.scopes[r.scope].push(n)),e.units[n].main.removeAttribute(r.key)}},Im=t=>r=>()=>{if(r.units[t.id]){var e=t.id;r.units[e].main.nodeValue=t.text}},Lm=t=>r=>e=>n=>u=>()=>{var a,p,l=n.id,_=n.html,y=n.verb,w=n.cache,x=n.parent,M=n.scope,R=n.pxScope;let _t=t(n.parent)(()=>()=>u.hydrating&&r&&(a=document.documentElement.querySelector(`[data-deku-ssr="${l}"]`))?(u.units[l]={listeners:{},pos:n.pos,scope:M,parent:x,main:a},a.$dekuId=l,!0):!1)();if(!_t){let Ct=Object.entries(w);for(var at=0;at<Ct.length;at++){let Ft=Ct[at][0];Ct[at][1]===!0?_=_.replace(y+Ft+y,'data-deku-attr-internal="'+Ft+'"'):_=_.replace(y+Ft+y,'<span style="display:contents;" data-deku-elt-internal="'+Ft+'"></span>')}p=document.createElement("div"),p.innerHTML=_.trim(),u.units[l]={listeners:{},pos:n.pos,scope:M,parent:x,main:p.firstChild},p.firstChild.$dekuId=l}u.scopes[M]||(u.scopes[M]=[]),u.scopes[M].push(l),p||(p=a),p.querySelectorAll("[data-deku-attr-internal]").forEach(function(Ct){var Ft=Ct.getAttribute("data-deku-attr-internal");let nr=Ft+"@!%"+R;u.units[nr]={listeners:{},main:Ct,scope:M},u.scopes[M].push(nr)}),p.querySelectorAll("[data-deku-elt-internal]").forEach(function(Ct){var Ft=Ct.getAttribute("data-deku-elt-internal");let nr=Ft+"@!%"+R;u.units[Ft+"@!%"+R]={listeners:{},main:Ct,scope:M},u.scopes[M].push(nr)}),_t||u.units[l].main.remove()},Pm=t=>r=>()=>{var e=t.id;r.units[e]={main:t.root},t.root.$dekuId=e},fl=t=>r=>e=>n=>()=>{let u=(_t,at,Ct)=>{if(n.units[_t].startBeacon){var Ft=n.units[_t].startBeacon,nr=Ft.nextSibling;for(n.units[at].main.insertBefore(Ft,Ct),Ft=nr;Ft&&Ft!==n.units[_t].endBeacon;)nr=Ft.nextSibling,n.units[at].main.insertBefore(Ft,Ct),Ft=nr}else n.units[at].main.insertBefore(n.units[_t].main,Ct)},a=[];a.push(e);for(var p=0;p<a.length;p++){let _t=a[p],at=_t.id,Ct=_t.parent;n.units[at].containingScope=_t.scope;var l=void 0;r(_t.pos)(nr=>()=>(l=nr,!0))(),l===void 0&&(l=Number.MAX_VALUE);let Ft=n.units[Ct].main.childNodes;for(var _=0,y=!1,w=0;_<Ft.length;){var x;if(x=Ft[_].$dekuId){if(r(_t.dynFamily)(ye=>()=>y?!1:n.units[x].endBeacon===Ft[_]&&ye===x?(n.units[at].pos=t(w),u(at,Ct,Ft[_]),!0):!1)()){y=!0;break}if(n.units[x].dynFamily!==n.units[at].dynFamily){_++;continue}if(y){_++;continue}w===l?(u(at,Ct,Ft[_]),w++,y=!0):n.units[x].endBeacon!==Ft[_]&&(n.units[x].pos=t(w),w++)}_++}if(y)return;if(n.units[at].main)n.units[Ct].main.appendChild(n.units[at].main);else{var M=n.units[at].startBeacon,R=M.nextSibling;for(n.units[Ct].main.appendChild(M),M=R;M&&M!==n.units[at].endBeacon;)R=M.nextSibling,n.units[Ct].main.appendChild(M),M=R}}},Rm=t=>r=>()=>{if(r.units[t.id]){var e=t.id;if(r.units[e].containingScope&&!t.scopeEq(r.units[e].containingScope)(t.scope))return;if(r.units[e].main)r.units[e].main.remove();else{let a=document.createElement("div");var n=r.units[e].startBeacon,u=n.nextSibling;for(a.appendChild(n),n=u;n&&n!==r.units[e].endBeacon;)u=n.nextSibling,a.appendChild(n),n=u;n===r.units[e].endBeacon&&a.appendChild(n)}}},Om=t=>r=>()=>r.units[t]!==void 0,cl=t=>r=>()=>{r.units[t.id]&&delete r.units[t.id]},Nm=cl;function Um(t,r){return r.includes(t)}var q3=typeof Array.from=="function",G3=typeof Symbol<"u"&&Symbol!=null&&typeof Symbol.iterator<"u"&&typeof String.prototype[Symbol.iterator]=="function",z3=typeof String.prototype.fromCodePoint=="function",V3=typeof String.prototype.codePointAt=="function";var Wm=function(t){return function(r){return function(e){return(e|0)===e?t(e):r}}},vr=function(t){return t};var Df=isFinite;var pl=function(t){return function(r){return Math.atan2(t,r)}};var ll=Math.cos;var _l=Math.floor;var qi=function(t){return function(r){return t%r}};var vl=Math.sin;var Gi=3.141592653589793;var Bm=be(mu),Hm=he(mu);var sl=function(){return Wm(d.create)(g.value)}(),oT=function(t){if(!Df(t))return 0;if(t>=vr(Bm))return Bm;if(t<=vr(Hm))return Hm;if(br)return Er(0)(sl(t));throw new Error("Failed pattern match at Data.Int (line 72, column 1 - line 72, column 29): "+[t.constructor.name])};var Ra=function(t){return oT(_l(t))};var df=function(t){return t.toLowerCase()};var rD=function(t){return function(r){return Um(t,r)}};var kl=Math.random;var $f=function(t){return function(r){return function(){var n=kl(),u=(vr(r)-vr(t)+1)*n+vr(t);return Ra(u)}}};var CT=Ve(Te),FT=wr();var nD=function(t){return t};var TT=1,dl=2147483647,xT=function(){return dl-1|0}(),uD=function(t){var r=function(e){return function(n){return function(u){var a=n-e|0,p=CT(u)(a),l=p<e;return l?p+n|0:p}}};return r(TT)(xT)(t)};var MT=0,ET=48271,aD=function(t){return function(r){return FT(sl(qi(vr(ET)*vr(r)+vr(t))(vr(dl))))}},iD=aD(MT);var Nn=function(t){return t.state};var dn=function(t){return t.liftEffect};var Mf=function(t){var r=S(t);return{map:function(e){return function(n){return function(u){return r(function(a){return new T(e(a.value0),a.value1)})(n(u))}}}}};var $l=function(t){return{Applicative0:function(){return Cl(t)},Bind1:function(){return hl(t)}}},hl=function(t){var r=vt(t.Bind1());return{bind:function(e){return function(n){return function(u){return r(e(u))(function(a){var p=n(a.value0);return p(a.value1)})}}},Apply0:function(){return Ef(t)}}},Ef=function(t){var r=Mf(t.Bind1().Apply0().Functor0());return{apply:ae($l(t)),Functor0:function(){return r}}},Cl=function(t){var r=P(t.Applicative0());return{pure:function(e){return function(n){return r(new T(e,n))}},Apply0:function(){return Ef(t)}}};var Fl=function(t){var r=P(t.Applicative0()),e=$l(t);return{state:function(n){return function(u){return r(n(u))}},Monad0:function(){return e}}};var DD=function(t){return function(r){var e=t(r);return e.value0}};var ZT=Fl(ii),tx=Nn(ZT);var rx=Mf(ku);var ex=se(ni);var nx=dr(ni);var ux=function(t){return t};var ax=function(){var t=function(r){return new T(nD(r.newSeed),function(){var e={};for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e.newSeed=iD(r.newSeed),e}())};return tx(t)}();var dD=rx,wf=S(dD);var yD=function(t){return DD(ux(t))};var gD=Ef(ii),ix=St(gD),kD=function(t){return function(r){var e=vr(r),n=vr(t),u=function(l){return n+qi(l)(e-n+1)},a=wf(vr)(ax),p=ix(wf(nx)(a))(wf(ex(2))(a));return wf(function(l){return Ra(u(l))})(p)}},SD=function(t){return function(r){var e=t<=r;return e?kD(t)(r):kD(r)(t)}};var CD=function(t){return t.arbitrary};var FD=function(){return{arbitrary:SD(-1e6)(1e6)}}();var TD=S(Yt),lx=S(te),_x=S($),vx=Ot(Ir);var sx=ut(me),bx=CD(FD),mx=dr(bu);var If=P(Or),Dx=J(Qn(mv(Fn))),Ax=v(An),xD=Ar(),kx=Jr(),dx=j(ou),yx=ra(_f),Kr=P(_r);var ce=function(t){return t},MD={map:function(t){return function(r){return TD(lx(_x(t)))(r)}}};var Vu=function(t){return function(r){return t instanceof d?r(t.value0):If(!1)}},gx=function(t){return function(r){return function(){var n=il(t.id)(r)(),u=Fm(t.id)(r)(),a=Cm(t.id)(r)(),p={scope:n,parent:u,dynFamily:a,id:t.id,pos:new d(t.pos),ez:!1,raiseId:Dx,ctor:Wu(Ax)};return xD(fl(d.create)(Vu)(p))(r)()}}},Sx=function(t){return function(r){return function(e){return rn({doLogic:function(n){return function(u){return function(a){return u.sendToPos({id:a,pos:n})}}},ids:function(n){return function(u){return u.ids}(kx(n))},disconnectElement:function(n){return function(u){return n.disconnectElement({id:u.id,scope:u.scope,parent:u.parent,scopeEq:dx})}},toElt:function(n){return n}})(t)(r)(xD(e))}}},$x=function(t){return function(r){return function(e){return function(n){return yx(qr(Kr(function(u){var a=function(){var l=TD(function(_){return function(y){return If(_)}})(Sx({dynFamily:n.dynFamily,ez:n.ez,parent:new d(n.parent),pos:n.pos,raiseId:n.raiseId,scope:n.scope})(t)(n.ctor));return If(om(l))}(),p=If(qr(Kr(fl(r)(e)(n))));return function(){var _=Om(n.id)(u)();if(_){var y=il(n.id)(u)();if(y instanceof ha)return p();if(y instanceof tn&&n.scope instanceof tn){var w=rD(y.value0)(n.scope.value0);return w?p():a()}return a()}return a()}})))}}}},ED=function(t){var r={ids:function(){var n=lr(t)(),u=sx(yD(bx)({newSeed:uD(n),size:5}));return vx(Xe(mx(1))(t))(),u},makeElement:function(){var e=Tm(Vu)(!1);return function(n){return qr(ce(Kr(e(n))))}}(),makeDynBeacon:function(){var e=hm(Vu)(!1);return function(n){return qr(ce(Kr(e(n))))}}(),attributeParent:function(){var e=$m(Vu);return function(n){return qr(ce(Kr(e(n))))}}(),makeRoot:function(e){return qr(ce(Kr(Pm(e))))},makeText:function(){var e=xm(Vu)(!1)(Qt(void 0));return function(n){return qr(ce(Kr(e(n))))}}(),makePursx:function(){var e=Lm(Vu)(!1)(Qt(void 0));return function(n){return qr(ce(Kr(e(n))))}}(),setProp:function(){var e=Mm(!1);return function(n){return qr(ce(Kr(e(n))))}}(),setCb:function(){var e=Em(!1);return function(n){return qr(ce(Kr(e(n))))}}(),unsetAttribute:function(){var e=wm(!1);return function(n){return qr(ce(Kr(e(n))))}}(),setText:function(e){return qr(ce(Kr(Im(e))))},sendToPos:function(e){return qr(ce(Kr(gx(e))))},removeDynBeacon:function(e){return qr(ce(Kr(Nm(e))))},deleteFromCache:function(e){return qr(ce(Kr(cl(e))))},giveNewParent:function(e){return $x(r)(d.create)(Vu)(e)},disconnectElement:function(e){return qr(ce(Kr(Rm(e))))}};return r};var xl=function(){return window};function ID(t,r,e){return t==null?r:e(t)}var Lr=function(t){return ID(t,g.value,d.create)};function LD(t){return t.body}var Ux=S($);var PD=function(t){return Ux(Lr)(function(){return LD(t)})};var RD=N;function Ml(t){return function(){return t.document}}var ND=Pu($a),UD=S(Yt),AM=im(MD),WD=Tn(Fn),kM=J(rf(Qn(WD))),dM=P(Or),El=vt(aa),yM=zt($),gM=Tu(Fu),SM=J(Tn(WD)),$M=S(tr),hM=Ot($);var CM=function(t){var r=function(u){var a=UD(e(u));return function(p){return ND(a(p))}},e=function(u){return function(a){return function(p){if(p instanceof Ut)return ND(UD(n(u))(p.value0));if(p instanceof Nt)return kM;throw new Error("Failed pattern match at Deku.Toplevel (line 47, column 21 - line 49, column 22): "+[p.constructor.name])}(AM(a))}},n=function(u){return function(a){return r(u+1|0)(Sa(function(p){return function(){return void 0,El(a(t))(p)(),dM(void 0)}}))}};return r(0)},FM=function(t){return function(r){return function(){var n=ol(),u=yM(gM($r(0)))(function(){var a=Sm(t)(r);return function(p){return a(ED(p))}}())();return Ii(CM(n)(u))(function(a){return a(n)})()}}},BD=function(t){return function(){var e=El(El(xl)(Ml))(PD)();return Qt(SM)(function(n){return FM(n)(t)})($M(RD)(e))()}},HD=function(t){return hM(BD(t))};var yn=function(t){return function(){console.log(t)}};var Il=function(){function t(){}return t.value=new t,t}();var qD={attr:function(t){return function(r){return i({key:"class",value:c(r)})}}};var GD={attr:function(t){return function(r){return i({key:"class",value:c(r)})}}};var Ki={attr:function(t){return function(r){return i({key:"class",value:c(r)})}}};var zD={attr:function(t){return function(r){return i({key:"class",value:c(r)})}}};var Lf=function(){function t(){}return t.value=new t,t}();var VD={attr:function(t){return function(r){return i({key:"href",value:c(r)})}}};var Pl=function(){function t(){}return t.value=new t,t}();var Rl={attr:function(t){return function(r){return i({key:"style",value:c(r)})}}};var JD=zt(Yt),KD=P(_r),Ol=function(t){var r=Hi(t);return function(e){return JD(e)(function(n){return r(Pl.value)(n)})}},QD=function(t){var r=Ol(t);return function(e){return r(KD(e))}},Nl=function(t){var r=Hi(t);return function(e){return JD(e)(function(n){return r(Il.value)(n)})}},Ba=function(t){var r=Nl(t);return function(e){return r(KD(e))}};var RM=zt(Yt),YD=Ar();var OM={append:function(t){return function(r){if(t==="")return r;if(r==="")return t;if(br)return t+(" "+r);throw new Error("Failed pattern match at ClassName (line 31, column 1 - line 39, column 19): "+[t.constructor.name,r.constructor.name])}}},NM={mempty:"",Semigroup0:function(){return OM}},UM=kr(Pt)(rf(NM)),Ha=function(t){return function(r){return RM(t)(function(e){return e?r:""})}},Pf=function(t){var r=Nl(t),e=UM(YD);return function(n){return r(YD(e(n)))}};var Wl=t=>()=>new Array(t);var WM=Ot(Ir),Rf=function(t){return function(r){var e=Fc(t)(h(r));return function(n){return WM(e(n))}}};var Xu=function(t){return t.inhabitants};var ju=function(t){return t.invert};var HM=hi(Vt),qM=rb(Vt),GM=Jo(Vt),zM=xu(Fi),VM=jo(Vt);var XM=function(t){return t};var Hl=XM;var jM=function(t){return function(r){return Er(r)(HM(r)(t))}};var JM=function(t){return{append:function(r){return function(e){var n=function(a){return function(p){return function(l){return{p:qM(function(_){var y=jM(e)(p),w=a===y;return w?g.value:new d(y)})(a)(l.p),q:GM(p)(l.q)}}}},u=zM(n)({p:r,q:e})(r);return Hl(VM(u.p)(u.q))}}}},rA=function(t){var r=JM(t);return{mempty:bn,Semigroup0:function(){return r}}};var eA=function(t){return t};var uA=oe(ie),KM=Xu(Wo(uA)),QM=Sp(Vt)(Pt),YM=zt(Kt),ZM=dr(Bo(uA)),qa=Oo(Ro),aA=_n(Dr)(Pt),tE=mp(Dr)(Fi);var Cr=function(){function t(){}return t.value=new t,t}(),Fr=function(){function t(){}return t.value=new t,t}(),Qr=function(){function t(){}return t.value=new t,t}(),Yr=function(){function t(){}return t.value=new t,t}(),Zr=function(){function t(){}return t.value=new t,t}(),pe=function(){function t(){}return t.value=new t,t}();var Qi={toPerm:function(t){return Hl(QM(YM(KM)(function(r){var e=H(t.ring)(Ke(r)),n=H(t.ring)(Ke(ZM(r)(t.amount)));return new T(lp(e),lp(n))})))}},iA={toPerm:At(kt)};var rE={to:function(t){if(t instanceof Mr)return Cr.value;if(t instanceof xt&&t.value0 instanceof Mr)return Fr.value;if(t instanceof xt&&t.value0 instanceof xt&&t.value0.value0 instanceof Mr)return Qr.value;if(t instanceof xt&&t.value0 instanceof xt&&t.value0.value0 instanceof xt&&t.value0.value0.value0 instanceof Mr)return Yr.value;if(t instanceof xt&&t.value0 instanceof xt&&t.value0.value0 instanceof xt&&t.value0.value0.value0 instanceof xt&&t.value0.value0.value0.value0 instanceof Mr)return Zr.value;if(t instanceof xt&&t.value0 instanceof xt&&t.value0.value0 instanceof xt&&t.value0.value0.value0 instanceof xt&&t.value0.value0.value0.value0 instanceof xt)return pe.value;throw new Error("Failed pattern match at Data.Gemini (line 79, column 1 - line 79, column 32): "+[t.constructor.name])},from:function(t){if(t instanceof Cr)return new Mr(Ge.value);if(t instanceof Fr)return new xt(new Mr(Ge.value));if(t instanceof Qr)return new xt(new xt(new Mr(Ge.value)));if(t instanceof Yr)return new xt(new xt(new xt(new Mr(Ge.value))));if(t instanceof Zr)return new xt(new xt(new xt(new xt(new Mr(Ge.value)))));if(t instanceof pe)return new xt(new xt(new xt(new xt(new xt(Ge.value)))));throw new Error("Failed pattern match at Data.Gemini (line 79, column 1 - line 79, column 32): "+[t.constructor.name])}},oA={show:No(rE)(uu(qa({reflectSymbol:function(){return"White"}}))(uu(qa({reflectSymbol:function(){return"Yellow"}}))(uu(qa({reflectSymbol:function(){return"Black"}}))(uu(qa({reflectSymbol:function(){return"Red"}}))(uu(qa({reflectSymbol:function(){return"Green"}}))(qa({reflectSymbol:function(){return"Blue"}})))))))};var fA={eq:function(t){return function(r){return t instanceof Cr&&r instanceof Cr||t instanceof Fr&&r instanceof Fr||t instanceof Qr&&r instanceof Qr||t instanceof Yr&&r instanceof Yr||t instanceof Zr&&r instanceof Zr||t instanceof pe&&r instanceof pe}}},cA={compare:function(t){return function(r){if(t instanceof Cr&&r instanceof Cr)return ft.value;if(t instanceof Cr)return K.value;if(r instanceof Cr)return Q.value;if(t instanceof Fr&&r instanceof Fr)return ft.value;if(t instanceof Fr)return K.value;if(r instanceof Fr)return Q.value;if(t instanceof Qr&&r instanceof Qr)return ft.value;if(t instanceof Qr)return K.value;if(r instanceof Qr)return Q.value;if(t instanceof Yr&&r instanceof Yr)return ft.value;if(t instanceof Yr)return K.value;if(r instanceof Yr)return Q.value;if(t instanceof Zr&&r instanceof Zr)return ft.value;if(t instanceof Zr)return K.value;if(r instanceof Zr)return Q.value;if(t instanceof pe&&r instanceof pe)return ft.value;throw new Error("Failed pattern match at Data.Gemini (line 0, column 0 - line 0, column 0): "+[t.constructor.name,r.constructor.name])}},Eq0:function(){return fA}},eE=function(t){return function(){var e=Wl(54)(),n=function(u){return function(a){return Rf(Ae(u))(a)(e)}};return aA(t)(function(u){return function(){n(u.value0)(u.value1)();var p=Si(u.value0);if(p instanceof g)return void 0;if(p instanceof d)return n(p.value0)(u.value1)();throw new Error("Failed pattern match at Data.Gemini (line 127, column 5 - line 131, column 21): "+[p.constructor.name])}})(),Yn(e)()}()},ql=function(t){return t.toPerm},nE=function(t){return function(r){return function(){var n=hv(r)();return tE(eA(t))(function(u){return function(a){var p=Ie(r)(u);if(p instanceof g)return Le("wat");if(p instanceof d)return Rf(a)(p.value0)(n);throw new Error("Failed pattern match at Data.Gemini (line 204, column 7 - line 209, column 39): "+[p.constructor.name])}})(),aA(hu)(function(u){return function(){var p=Cc(Ae(u.canonical))(n)();if(p instanceof g)return Le("wat")();if(p instanceof d)return Rf(Ae(u.alternate))(p.value0)(n)();throw new Error("Failed pattern match at Data.Gemini (line 213, column 7 - line 217, column 65): "+[p.constructor.name])}})(),Yn(n)()}()}},Gl=function(t){return function(r){var e=Ie(r)(Ae(t));if(e instanceof d)return e.value0;if(e instanceof g)return Le("geminiLookup");throw new Error("Failed pattern match at Data.Gemini (line 116, column 3 - line 118, column 46): "+[e.constructor.name])}},pA=function(t){return t},lt=function(t){return function(r){return{color:t,label:r}}},lA=function(){return eE([new T(H($t.value)(12),lt(Yr.value)(1)),new T(H($t.value)(13),lt(Yr.value)(2)),new T(H($t.value)(14),lt(Yr.value)(3)),new T(H($t.value)(15),lt(Yr.value)(4)),new T(H($t.value)(16),lt(Yr.value)(5)),new T(H($t.value)(17),lt(Yr.value)(6)),new T(H($t.value)(0),lt(Yr.value)(7)),new T(H($t.value)(1),lt(Yr.value)(8)),new T(H($t.value)(3),lt(Fr.value)(1)),new T(H($t.value)(4),lt(Fr.value)(2)),new T(H($t.value)(5),lt(Fr.value)(3)),new T(H($t.value)(6),lt(Fr.value)(4)),new T(H($t.value)(7),lt(Fr.value)(5)),new T(H($t.value)(8),lt(Fr.value)(6)),new T(H($t.value)(9),lt(Fr.value)(7)),new T(H($t.value)(10),lt(Fr.value)(8)),new T(H($t.value)(11),lt(Fr.value)(9)),new T(H(Dt.value)(12),lt(Qr.value)(1)),new T(H(Dt.value)(13),lt(Qr.value)(2)),new T(H(Dt.value)(14),lt(Qr.value)(3)),new T(H(Dt.value)(15),lt(Qr.value)(4)),new T(H(Dt.value)(16),lt(Qr.value)(5)),new T(H(Dt.value)(17),lt(Qr.value)(6)),new T(H(Dt.value)(0),lt(Qr.value)(7)),new T(H(Dt.value)(1),lt(Qr.value)(8)),new T(H(Dt.value)(3),lt(pe.value)(1)),new T(H(Dt.value)(4),lt(pe.value)(2)),new T(H(Dt.value)(5),lt(pe.value)(3)),new T(H(Dt.value)(6),lt(pe.value)(4)),new T(H(Dt.value)(7),lt(pe.value)(5)),new T(H(Dt.value)(8),lt(pe.value)(6)),new T(H(Dt.value)(9),lt(pe.value)(7)),new T(H(Dt.value)(10),lt(pe.value)(8)),new T(H(Mt.value)(3),lt(Zr.value)(1)),new T(H(Mt.value)(4),lt(Zr.value)(2)),new T(H(Mt.value)(5),lt(Zr.value)(3)),new T(H(Mt.value)(6),lt(Zr.value)(4)),new T(H(Mt.value)(7),lt(Zr.value)(5)),new T(H(Mt.value)(8),lt(Zr.value)(6)),new T(H(Mt.value)(9),lt(Zr.value)(7)),new T(H(Mt.value)(10),lt(Zr.value)(8)),new T(H(Mt.value)(12),lt(Cr.value)(1)),new T(H(Mt.value)(13),lt(Cr.value)(2)),new T(H(Mt.value)(14),lt(Cr.value)(3)),new T(H(Mt.value)(15),lt(Cr.value)(4)),new T(H(Mt.value)(16),lt(Cr.value)(5)),new T(H(Mt.value)(17),lt(Cr.value)(6)),new T(H(Mt.value)(0),lt(Cr.value)(7)),new T(H(Mt.value)(1),lt(Cr.value)(8)),new T(H(Mt.value)(2),lt(Cr.value)(9))])}(),Yi=function(t){var r=ql(t);return function(e){return nE(r(e))}};var uE=I($),zl=function(){function t(){}return t.value=new t,t}();var _A={attr:function(t){return function(r){return i({key:"click",value:E(h(uE(r)(!0)))})}}};var Vl=function(){function t(){}return t.value=new t,t}();var vA={attr:function(t){return function(r){return i({key:"keydown",value:E(r)})}}};var Xl=function(){function t(){}return t.value=new t,t}();var sA={attr:function(t){return function(r){return i({key:"mouseleave",value:E(r)})}}};var jl=function(){function t(){}return t.value=new t,t}();var bA={attr:function(t){return function(r){return i({key:"mousemove",value:E(r)})}}};var Jl=function(){function t(){}return t.value=new t,t}();var mA={attr:function(t){return function(r){return i({key:"mouseup",value:E(r)})}}};var Kl=function(){function t(){}return t.value=new t,t}();var DA={attr:function(t){return function(r){return i({key:"pointerdown",value:E(r)})}}};var Ql=function(){function t(){}return t.value=new t,t}();var AA={attr:function(t){return function(r){return i({key:"touchcancel",value:E(r)})}}};var Yl=function(){function t(){}return t.value=new t,t}();var kA={attr:function(t){return function(r){return i({key:"touchend",value:E(r)})}}};var Zl=function(){function t(){}return t.value=new t,t}();var dA={attr:function(t){return function(r){return i({key:"touchmove",value:E(r)})}}};var t_=function(){function t(){}return t.value=new t,t}();var yA={attr:function(t){return function(r){return i({key:"touchstart",value:E(r)})}}};var r_=function(){function t(){}return t.value=new t,t}();var gA={attr:function(t){return function(r){return i({key:"src",value:c(r)})}}};var Of=A("div");var SA=function(){function t(){}return t.value=new t,t}();var $A={attr:function(t){return function(r){return i({key:"@self@",value:E(r)})}}};var Ue=function(t){return function(r){return t(r)}},hA=Ue;function n_(t){return t.key}var yE=ut(me),Ga=function(t){return mf(function(r){return t(function(e){return e.changedTouches.item(0)}(r))})},CA=S(Yt)(function(t){return i({key:"tabIndex",value:new On(yE(t))})}),za=function(t){return mf(function(r){return t(r)})},FA=function(t){return mf(function(r){return t(r)})},TA=function(){return P(_r)(i({key:"autofocus",value:new On("")}))}();var de=function(){var t={},r="Pure",e="Throw",n="Catch",u="Sync",a="Async",p="Bind",l="Bracket",_="Fork",y="Sequential",w="Map",x="Apply",M="Alt",R="Cons",_t="Resume",at="Release",Ct="Finalizer",Ft="Finalized",nr="Forked",ye="Fiber",Be="Thunk";function X(z,Rt,fr,Bt){this.tag=z,this._1=Rt,this._2=fr,this._3=Bt}function ar(z){var Rt=function(fr,Bt,Y){return new X(z,fr,Bt,Y)};return Rt.tag=z,Rt}function He(z){return new X(r,void 0)}function co(z){try{z()}catch(Rt){setTimeout(function(){throw Rt},0)}}function gn(z,Rt,fr){try{return Rt(fr())}catch(Bt){return z(Bt)}}function fu(z,Rt,fr){try{return Rt(fr)()}catch(Bt){return fr(z(Bt))(),He}}var Wn=function(){var z=1024,Rt=0,fr=0,Bt=new Array(z),Y=!1;function W(){var Wt;for(Y=!0;Rt!==0;)Rt--,Wt=Bt[fr],Bt[fr]=void 0,fr=(fr+1)%z,Wt();Y=!1}return{isDraining:function(){return Y},enqueue:function(Wt){var dt,ir;Rt===z&&(ir=Y,W(),Y=ir),Bt[(fr+Rt)%z]=Wt,Rt++,Y||W()}}}();function nc(z){var Rt={},fr=0,Bt=0;return{register:function(Y){var W=fr++;Y.onComplete({rethrow:!0,handler:function(Wt){return function(){Bt--,delete Rt[W]}}})(),Rt[W]=Y,Bt++},isEmpty:function(){return Bt===0},killAll:function(Y,W){return function(){if(Bt===0)return W();var Wt=0,dt={};function ir(Jt){dt[Jt]=Rt[Jt].kill(Y,function(sr){return function(){delete dt[Jt],Wt--,z.isLeft(sr)&&z.fromLeft(sr)&&setTimeout(function(){throw z.fromLeft(sr)},0),Wt===0&&W()}})()}for(var Tr in Rt)Rt.hasOwnProperty(Tr)&&(Wt++,ir(Tr));return Rt={},fr=0,Bt=0,function(Jt){return new X(u,function(){for(var sr in dt)dt.hasOwnProperty(sr)&&dt[sr]()})}}}}}var Bn=0,zr=1,po=2,lo=3,_o=4,le=5,Ya=6;function uc(z,Rt,fr){var Bt=0,Y=Bn,W=fr,Wt=null,dt=null,ir=null,Tr=null,Jt=null,sr=0,cu=0,ge=null,Hn=!0;function qn(Z){for(var nt,Et,Lt;;)switch(nt=null,Et=null,Lt=null,Y){case po:Y=zr;try{W=ir(W),Tr===null?ir=null:(ir=Tr._1,Tr=Tr._2)}catch(Pr){Y=le,Wt=z.left(Pr),W=null}break;case lo:z.isLeft(W)?(Y=le,Wt=W,W=null):ir===null?Y=le:(Y=po,W=z.fromRight(W));break;case zr:switch(W.tag){case p:ir&&(Tr=new X(R,ir,Tr)),ir=W._2,Y=zr,W=W._1;break;case r:ir===null?(Y=le,W=z.right(W._1)):(Y=po,W=W._1);break;case u:Y=lo,W=gn(z.left,z.right,W._1);break;case a:Y=_o,W=fu(z.left,W._1,function(Pr){return function(){Bt===Z&&(Bt++,Wn.enqueue(function(){Bt===Z+1&&(Y=lo,W=Pr,qn(Bt))}))}});return;case e:Y=le,Wt=z.left(W._1),W=null;break;case n:ir===null?Jt=new X(R,W,Jt,dt):Jt=new X(R,W,new X(R,new X(_t,ir,Tr),Jt,dt),dt),ir=null,Tr=null,Y=zr,W=W._1;break;case l:sr++,ir===null?Jt=new X(R,W,Jt,dt):Jt=new X(R,W,new X(R,new X(_t,ir,Tr),Jt,dt),dt),ir=null,Tr=null,Y=zr,W=W._1;break;case _:Y=lo,nt=uc(z,Rt,W._2),Rt&&Rt.register(nt),W._1&&nt.run(),W=z.right(nt);break;case y:Y=zr,W=Bk(z,Rt,W._1);break}break;case le:if(ir=null,Tr=null,Jt===null)Y=Ya,W=dt||Wt||W;else switch(nt=Jt._3,Lt=Jt._1,Jt=Jt._2,Lt.tag){case n:dt&&dt!==nt&&sr===0?Y=le:Wt&&(Y=zr,W=Lt._2(z.fromLeft(Wt)),Wt=null);break;case _t:dt&&dt!==nt&&sr===0||Wt?Y=le:(ir=Lt._1,Tr=Lt._2,Y=po,W=z.fromRight(W));break;case l:sr--,Wt===null&&(Et=z.fromRight(W),Jt=new X(R,new X(at,Lt._2,Et),Jt,nt),(dt===nt||sr>0)&&(Y=zr,W=Lt._3(Et)));break;case at:Jt=new X(R,new X(Ft,W,Wt),Jt,dt),Y=zr,dt&&dt!==nt&&sr===0?W=Lt._1.killed(z.fromLeft(dt))(Lt._2):Wt?W=Lt._1.failed(z.fromLeft(Wt))(Lt._2):W=Lt._1.completed(z.fromRight(W))(Lt._2),Wt=null,sr++;break;case Ct:sr++,Jt=new X(R,new X(Ft,W,Wt),Jt,dt),Y=zr,W=Lt._1;break;case Ft:sr--,Y=le,W=Lt._1,Wt=Lt._2;break}break;case Ya:for(var pr in ge)ge.hasOwnProperty(pr)&&(Hn=Hn&&ge[pr].rethrow,co(ge[pr].handler(W)));ge=null,dt&&Wt?setTimeout(function(){throw z.fromLeft(Wt)},0):z.isLeft(W)&&Hn&&setTimeout(function(){if(Hn)throw z.fromLeft(W)},0);return;case Bn:Y=zr;break;case _o:return}}function cr(Z){return function(){if(Y===Ya)return Hn=Hn&&Z.rethrow,Z.handler(W)(),function(){};var nt=cu++;return ge=ge||{},ge[nt]=Z,function(){ge!==null&&delete ge[nt]}}}function it(Z,nt){return function(){if(Y===Ya)return nt(z.right(void 0))(),function(){};var Et=cr({rethrow:!1,handler:function(){return nt(z.right(void 0))}})();switch(Y){case Bn:dt=z.left(Z),Y=Ya,W=dt,qn(Bt);break;case _o:dt===null&&(dt=z.left(Z)),sr===0&&(Y===_o&&(Jt=new X(R,new X(Ct,W(Z)),Jt,dt)),Y=le,W=null,Wt=null,qn(++Bt));break;default:dt===null&&(dt=z.left(Z)),sr===0&&(Y=le,W=null,Wt=null)}return Et}}function gt(Z){return function(){var nt=cr({rethrow:!1,handler:Z})();return Y===Bn&&qn(Bt),nt}}return{kill:it,join:gt,onComplete:cr,isSuspended:function(){return Y===Bn},run:function(){Y===Bn&&(Wn.isDraining()?qn(Bt):Wn.enqueue(function(){qn(Bt)}))}}}function Wk(z,Rt,fr,Bt){var Y=0,W={},Wt=0,dt={},ir=new Error("[ParAff] Early exit"),Tr=null,Jt=t;function sr(cr,it,gt){var Z=it,nt=null,Et=null,Lt=0,pr={},Pr,Za;t:for(;;)switch(Pr=null,Z.tag){case nr:if(Z._3===t&&(Pr=W[Z._1],pr[Lt++]=Pr.kill(cr,function(Hk){return function(){Lt--,Lt===0&&gt(Hk)()}})),nt===null)break t;Z=nt._2,Et===null?nt=null:(nt=Et._1,Et=Et._2);break;case w:Z=Z._2;break;case x:case M:nt&&(Et=new X(R,nt,Et)),nt=Z,Z=Z._1;break}if(Lt===0)gt(z.right(void 0))();else for(Za=0,Pr=Lt;Za<Pr;Za++)pr[Za]=pr[Za]();return pr}function cu(cr,it,gt){var Z,nt,Et,Lt,pr,Pr;for(z.isLeft(cr)?(Z=cr,nt=null):(nt=cr,Z=null);;){if(Et=null,Lt=null,pr=null,Pr=null,Tr!==null)return;if(it===null){Bt(Z||nt)();return}if(it._3!==t)return;switch(it.tag){case w:Z===null?(it._3=z.right(it._1(z.fromRight(nt))),nt=it._3):it._3=Z;break;case x:if(Et=it._1._3,Lt=it._2._3,Z){if(it._3=Z,pr=!0,Pr=Wt++,dt[Pr]=sr(ir,Z===Et?it._2:it._1,function(){return function(){delete dt[Pr],pr?pr=!1:gt===null?cu(Z,null,null):cu(Z,gt._1,gt._2)}}),pr){pr=!1;return}}else{if(Et===t||Lt===t)return;nt=z.right(z.fromRight(Et)(z.fromRight(Lt))),it._3=nt}break;case M:if(Et=it._1._3,Lt=it._2._3,Et===t&&z.isLeft(Lt)||Lt===t&&z.isLeft(Et))return;if(Et!==t&&z.isLeft(Et)&&Lt!==t&&z.isLeft(Lt))Z=nt===Et?Lt:Et,nt=null,it._3=Z;else if(it._3=nt,pr=!0,Pr=Wt++,dt[Pr]=sr(ir,nt===Et?it._2:it._1,function(){return function(){delete dt[Pr],pr?pr=!1:gt===null?cu(nt,null,null):cu(nt,gt._1,gt._2)}}),pr){pr=!1;return}break}gt===null?it=null:(it=gt._1,gt=gt._2)}}function ge(cr){return function(it){return function(){delete W[cr._1],cr._3=it,cu(it,cr._2._1,cr._2._2)}}}function Hn(){var cr=zr,it=fr,gt=null,Z=null,nt,Et;t:for(;;)switch(nt=null,Et=null,cr){case zr:switch(it.tag){case w:gt&&(Z=new X(R,gt,Z)),gt=new X(w,it._1,t,t),it=it._2;break;case x:gt&&(Z=new X(R,gt,Z)),gt=new X(x,t,it._2,t),it=it._1;break;case M:gt&&(Z=new X(R,gt,Z)),gt=new X(M,t,it._2,t),it=it._1;break;default:Et=Y++,cr=le,nt=it,it=new X(nr,Et,new X(R,gt,Z),t),nt=uc(z,Rt,nt),nt.onComplete({rethrow:!1,handler:ge(it)})(),W[Et]=nt,Rt&&Rt.register(nt)}break;case le:if(gt===null)break t;gt._1===t?(gt._1=it,cr=zr,it=gt._2,gt._2=t):(gt._2=it,it=gt,Z===null?gt=null:(gt=Z._1,Z=Z._2))}for(Jt=it,Et=0;Et<Y;Et++)W[Et].run()}function qn(cr,it){Tr=z.left(cr);var gt;for(var Z in dt)if(dt.hasOwnProperty(Z)){gt=dt[Z];for(Z in gt)gt.hasOwnProperty(Z)&&gt[Z]()}dt=null;var nt=sr(cr,Jt,it);return function(Et){return new X(a,function(Lt){return function(){for(var pr in nt)nt.hasOwnProperty(pr)&&nt[pr]();return He}})}}return Hn(),function(cr){return new X(a,function(it){return function(){return qn(cr,it)}})}}function Bk(z,Rt,fr){return new X(a,function(Bt){return function(){return Wk(z,Rt,fr,Bt)}})}return X.EMPTY=t,X.Pure=ar(r),X.Throw=ar(e),X.Catch=ar(n),X.Sync=ar(u),X.Async=ar(a),X.Bind=ar(p),X.Bracket=ar(l),X.Fork=ar(_),X.Seq=ar(y),X.ParMap=ar(w),X.ParApply=ar(x),X.ParAlt=ar(M),X.Fiber=uc,X.Supervisor=nc,X.Scheduler=Wn,X.nonCanceler=He,X}(),MA=de.Pure,gE=de.Throw;function EA(t){return function(r){return r.tag===de.Pure.tag?de.Pure(t(r._1)):de.Bind(r,function(e){return de.Pure(t(e))})}}function wA(t){return function(r){return de.Bind(t,r)}}var IA=de.Sync;var LA=de.Async;function PA(t,r){return function(){return de.Fiber(t,null,r)}}var RA=function(){function t(e,n){return e===0&&typeof setImmediate<"u"?setImmediate(n):setTimeout(n,e)}function r(e,n){return e===0&&typeof clearImmediate<"u"?clearImmediate(n):clearTimeout(n)}return function(e,n){return de.Async(function(u){return function(){var a=t(n,u(e()));return function(){return de.Sync(function(){return e(r(n,a))})}}})}}(),SE=de.Seq;var Nf=function(t){return t()};var NE=function(t,r,e){var n=0,u;return function(a){if(n===2)return u;if(n===1)throw new ReferenceError(t+" was needed before it finished initializing (module "+r+", line "+a+")",r,a);return n=1,u=e(),n=2,u}};var UE=Ot($);var WE={map:EA};var BE=function(){var t=function(n){if(n instanceof Nt)return n.value0;if(n instanceof Ut)return Le("unsafeFromRight: Left");throw new Error("Failed pattern match at Effect.Aff (line 412, column 21 - line 414, column 54): "+[n.constructor.name])},r=function(n){if(n instanceof Ut)return n.value0;if(n instanceof Nt)return Le("unsafeFromLeft: Right");throw new Error("Failed pattern match at Effect.Aff (line 407, column 20 - line 409, column 55): "+[n.constructor.name])},e=function(n){if(n instanceof Ut)return!0;if(n instanceof Nt)return!1;throw new Error("Failed pattern match at Effect.Aff (line 402, column 12 - line 404, column 21): "+[n.constructor.name])};return{isLeft:e,fromLeft:r,fromRight:t,left:Ut.create,right:Nt.create}}(),HE=function(t){return PA(BE,t)},WA=function(t){return function(){var e=HE(t)();return e.run(),e}},BA=function(t){return UE(WA(t))};var HA=function(t){return RA(Nt.create,t)};var qA={Applicative0:function(){return qE},Bind1:function(){return Uf}},Uf={bind:wA,Apply0:function(){return GA(0)}},qE={pure:MA,Apply0:function(){return GA(0)}},GA=NE("applyAff","Effect.Aff",function(){return{apply:ae(qA),Functor0:function(){return WE}}});var zA={liftEffect:IA,Monad0:function(){return qA}};var GE=Tu(Fu),zE=Ot(Ir),Va=S(Yt),XA=qt(Oe),jA=P(_r);var VE=S(te),a_=bm,Wf=function(t){return function(r){return function(e){var n=Op(function(p){return function(l){return function(){var y=$r(t)();return l(e(GE(lr(y))))(),p(r)(function(w){return zE(ee(w)(y))})()}}}),u=Va(function(p){return p})(n),a=Wu(Va(function(p){return p})(u));return a}}};var XE=function(t){return function(r){var e=tf(t)(r),n=Va(function(a){return a})(e),u=Wu(Va(function(a){return a})(n));return u}},JA=function(t){return function(r){return Ue(a_)(function(e){return Ue(XE(XA(e.value1)(jA(t))))(function(n){return r(new T(e.value0,n))})})}};var jE=function(t){return function(r){return function(e){var n=XA(jA(e(void 0)))($b(function(l){return hb(t,mn(r))})),u=Va(function(l){return l})(n),a=Va(function(l){return l})(u),p=Wu(a);return p}}};var KA=function(t){var r=jE(t),e=VE(BA);return function(n){return r(e(n))}};var i_=v(An),JE=Ou(Pt),YA=P(_r),KE=P(Dr),QE={reflectType:function(){return"~"}},ZA=qt(Oe),YE=S(Yt),ZE=La(Ia),tw=Jr(),rw=j(ou),ew=Ar();var to={pursxToElement:function(t){return function(r){return function(e){return{cache:xa,element:new fe(function(n){return function(u){return i_}})}}}}},o_=function(t){return t.pursxToElement},Ju=function(){return yt.value}(),f_=function(t){var r=function(e){return e instanceof fe?e.value0:function(n){return function(u){return i_}}};return r(t)},nw=function(t){var r=Ta(t);return function(e){var n=Ta(e);return function(){return function(){return function(u){var a=o_(u);return function(p){return function(l){return function(_){var y=function(x){return function(M){return Dn(function(R,_t){var at=M.ids(),Ct=M.ids();x.raiseId(at)();var Ft=a(Ct)(yt.value)(_),nr=f_(Ft.element),ye=R(JE([YA(M.makePursx({id:at,parent:x.parent,cache:Ft.cache,dynFamily:x.dynFamily,pos:x.pos,pxScope:Ct,scope:x.scope,html:r(l),verb:n(p)})),nr(x)(M),Qt(i_)(function(Be){return YA(M.attributeParent({id:at,parent:Be,pos:x.pos,dynFamily:x.dynFamily,ez:!1}))})(x.parent)]),_t);return function(){return _t(M.deleteFromCache({id:at})),ye()}})}},w=new fe(y);return w}}}}}}}},Ku=function(t){var r=nw(t)(QE)()();return function(){return function(){return function(e){return r(e)(yt.value)}}}};var Bf=function(){return function(t){var r=o_(t);return function(e){var n=Ta(e);return function(u){var a=Up(u)();return{pursxToElement:function(p){return function(l){return function(_){var y=r(p)(yt.value)(_);return{cache:Ma(n(yt.value))(!0)(y.cache),element:new fe(function(w){return function(x){return ZA(YE(ZE(bf)(function(M){if(M.value instanceof On)return x.setProp({id:n(yt.value)+("@!%"+p),key:M.key,value:M.value.value0});if(M.value instanceof Bi)return x.setCb({id:n(yt.value)+("@!%"+p),key:M.key,value:M.value.value0});if(M.value instanceof sf)return x.unsetAttribute({id:n(yt.value)+("@!%"+p),key:M.key});throw new Error("Failed pattern match at Deku.Pursx (line 2487, column 52 - line 2504, column 38): "+[M.value.constructor.name])}))(a(yt.value)(_)))(function(){var M=f_(y.element);return M}()(w)(x))}})}}}}}}}}};var uw=function(t){return function(r){return function(e){return rn({doLogic:function(n){return function(u){return function(a){return u.sendToPos({id:a,pos:n})}}},ids:function(n){return function(u){return u.ids}(tw(n))},disconnectElement:function(n){return function(u){return n.disconnectElement({id:u.id,scope:u.scope,parent:u.parent,scopeEq:rw})}},toElt:function(n){return n}})(t)(r)(ew(e))}}},tk=function(){return function(t){var r=o_(t);return function(e){var n=Ta(e);return function(u){var a=Up(u)();return{pursxToElement:function(p){return function(l){return function(_){var y=r(p)(yt.value)(_);return{cache:Ma(n(yt.value))(!1)(y.cache),element:new fe(function(w){return function(x){return ZA(uw({parent:new d(n(yt.value)+("@!%"+p)),scope:w.scope,raiseId:function(M){return KE(void 0)},pos:w.pos,ez:!1,dynFamily:g.value})(x)(function(M){return M}(a(yt.value)(_))))(function(){var M=f_(y.element);return M}()(w)(x))}})}}}}}}}}};var Xa=Qe(oe(ie)),ek=function(t){return{amount:Xa(-t|0),ring:Mt.value}},nk=function(t){return{amount:Xa(t),ring:Mt.value}},uk=function(t){return{amount:Xa(-t|0),ring:$t.value}},ak=function(t){return{amount:Xa(t),ring:$t.value}},ik=function(t){return{amount:Xa(-t|0),ring:Dt.value}},ok=function(t){return{amount:Xa(t),ring:Dt.value}};var fk=function(t){return{head:t.value0,tail:t.value1}};var ow=_e(ve)(re),fw=$n(jn),cw=j(da),pw=P(Fe),lw=qt(ai),_w=an(re),vw=Gn(Os),sw=fs(Ca),bw=Gn(Vt),mw=oe(ie),Dw=Wb(Qs),ck=S(Pi),Aw=In(Lb)(Fe),kw=Di(Pt)(Mn),dw=zt(Pi),yw=Gn(cA);var gw=function(t){return function(r){var e=function(n){return ow(fw(cw(n.ring)(t)))(function(){return pw(n)})};return lw(e(r))(_w(e)(Si(r)))}},Sw=function(t){var r=Ts(t),e=hn(fp(t));return function(n){return function(u){var a=function(y){return function(w){var x=r(y)(w);return x instanceof ip||x instanceof Uo}},p=function(y){return function(w){var x=r(y)(w);return x instanceof op||x instanceof Uo}},l=function(y){return function(w){return function(x){var M=y,R=w,_t=!1,at;function Ct(Ft,nr,ye){var Be=function(ar){return function(He){if(a(ar)(nr)&&Ke(e(ye)(ar))<n){M=He,R=ar,x=ye;return}if(p(ar)(ye)&&Ke(e(ar)(nr))<n){M=He,R=nr,x=ar;return}if(a(ar)(ye)&&p(ar)(nr)){M=He,R=nr,x=ye;return}if(br)return _t=!0,!1;throw new Error("Failed pattern match at Data.Gemini.Solve (line 111, column 5 - line 119, column 26): "+[ar.constructor.name,He.constructor.name])}},X=Ap(Ft);if(X instanceof g)return _t=!0,!0;if(X instanceof d)return Be(X.value0.head)(X.value0.tail);throw new Error("Failed pattern match at Data.Gemini.Solve (line 107, column 5 - line 109, column 47): "+[X.constructor.name])}for(;!_t;)at=Ct(M,R,x);return at}}},_=fk(u);return l(_.tail)(_.head)(_.head)}}},$w=Sw(mw);var hw=function(t){return t instanceof Cr||t instanceof Fr?9:8},Cw=function(t){return function(r){var e=Nb(vw(function(p){return function(l){return l.ring}(qo(p))}))(r),n=Ni(e),u=function(p){return p.ring}(qo(Oi(sw(bw(Ni))(e)))),a=n>2;return a?!1:Qt(!1)(function(){var p=$w(hw(t)),l=ck(function(_){return function(y){return y.position}(qo(_))});return function(_){return p(Dw(l(_)))}}())(Aw(ck(gw(u))(r)))}},Hf=function(t){return kw(function(r){var e=Ob(r);return Cw(e.head.value1.color)(dw(r)(function(n){return Ws(n.value0)}))})(wo(yw(function(r){return r.value1.color}))(jc(T.create)(pA(t))))};var c_=function(t){return function(r){return Ue(JA(t))(function(e){return Ue(Wf(t)(e.value1))(function(n){return r({event:e.value1,ref:n,pusher:e.value0})})})}},ja=function(t){return t.event},qf=function(t){return function(r){return t.pusher(r)}},Qu=function(t){return t.ref},ro=function(t){return function(r){return function(){var n=t.ref();return t.pusher(r(n))()}}};var p_=function(){function t(){}return t.value=new t,t}(),Ja=function(){function t(){}return t.value=new t,t}(),lk=function(){function t(){}return t.value=new t,t}();var Fw=wr(),Tw=ls(Or)(eu)(ru),xw=St(oi),Mw=S($),Ew=Qe(oe(ie)),ww=kr(Pt)(rA(ep(ds))),Iw=ql(Qi),Lw=Yi(iA),Pw=Yi(Qi),Rw=un(Or),Ow=function(t){return function(r){return Fw(Ie(t)(r))}},_k=function(t){var r=Xu(Ho);return function(){var n=Tw(1e3)(xw(Mw(function(a){return function(p){return{ring:Ow(r)(p),amount:Ew(a)}}})($f(1)(17)))($f(0)(2)))(),u=ww(Iw)(n);return ro(t)(Lw(u))()}},vk=function(t){var r=function(e){return function(){ro(t.gemini)(Pw(e))();var u=Qu(t.gemini)();return Rw(Hf(u))(t.pushConfetti(Ja.value))()}};return function(e){return function(n){return n==="q"?r(uk(1)):n==="w"?r(ak(1)):n==="t"?r(ik(1)):n==="y"?r(ok(1)):n==="o"?r(ek(1)):n==="p"?r(nk(1)):yn(n)}(n_(e))}};var zf=function(){function t(){}return t.value=new t,t}(),sk=function(){function t(){}return t.value=new t,t}(),Ka=function(){function t(){}return t.value=new t,t}();var eo={append:function(t){return function(r){return t+r}}},no={mempty:0,Semigroup0:function(){return eo}},Vf={invert:function(t){return-t},Monoid0:function(){return no}},Uw=function(t){return t*2*Gi},bk=function(t){return vl(t)},Ww=function(t){return t/(2*Gi)},Bw=function(t){return t*180/Gi},Hw=function(t){return t*Gi/180},mk=function(t){return ll(t)},__=function(t){return function(r){if(r instanceof sk)return t;if(r instanceof zf)return Hw(t);if(r instanceof Ka)return Uw(t);throw new Error("Failed pattern match at Data.Angle (line 25, column 3 - line 28, column 38): "+[r.constructor.name])}},Dk=function(t){return function(r){if(r instanceof sk)return t;if(r instanceof zf)return Bw(t);if(r instanceof Ka)return Ww(t);throw new Error("Failed pattern match at Data.Angle (line 32, column 3 - line 35, column 36): "+[r.constructor.name])}},Ak=function(t){return function(r){return pl(t)(r)}};var uo={append:function(t){return function(r){return{x:t.x+r.x,y:t.y+r.y}}}},s_={mempty:{x:0,y:0},Semigroup0:function(){return uo}},Xf={invert:function(t){return{x:-t.x,y:-t.y}},Monoid0:function(){return s_}},jf=function(t){return Ak(t.y)(t.x)};var qw=zt($),Gw=B(uo),zw=ju(Xf),Vw=J(no),Xw=B(eo),jw=ju(Vf),Jw=Yi(Qi),Kw=un(Or),Qw=function(t){return function(r){return qw(t)(function(e){return e.ringCenter(r)})}},kk=function(t){return{x:t.clientX,y:t.clientY}},Jf=function(t){return function(r){var e=kk(r);return function(){var u=Qu(t.drag)();if(u instanceof g)return void 0;if(u instanceof d)return qf(t.drag)(new d({currentPoint:e,chosen:u.value0.chosen,initialPoint:u.value0.initialPoint,location:u.value0.location}))();throw new Error("Failed pattern match at Gemini.Component.Puzzle.Actions (line 50, column 3 - line 58, column 14): "+[u.constructor.name])}}},m_=function(t){return function(r){var e=kk(r);return qf(t.drag)(new d({location:Hs(t.location),chosen:g.value,initialPoint:e,currentPoint:e}))}},ao=function(t){if(t.location instanceof cp)return t.location.value0;if(t.location instanceof pp){if(t.chosen instanceof d&&t.chosen.value0 instanceof Ps)return t.location.value0;if(t.chosen instanceof d&&t.chosen.value0 instanceof Rs)return t.location.value1;if(t.chosen instanceof g)return t.location.value0;throw new Error("Failed pattern match at Gemini.Component.Puzzle.Actions (line 131, column 7 - line 135, column 24): "+[t.chosen.constructor.name])}throw new Error("Failed pattern match at Gemini.Component.Puzzle.Actions (line 128, column 3 - line 135, column 24): "+[t.location.constructor.name])},Yw=function(t){var r=function(e){return function(n){return function(){var a=Qw(t.domInfo)(e)(),p=Gw(n)(zw(a));return jf(p)}}};return function(){var n=Qu(t.drag)();if(n instanceof g)return Vw;if(n instanceof d){var u=ao(n.value0),a=r(u.ring)(n.value0.initialPoint)(),p=r(u.ring)(n.value0.currentPoint)();return Xw(p)(jw(a))}throw new Error("Failed pattern match at Gemini.Component.Puzzle.Actions (line 108, column 3 - line 114, column 43): "+[n.constructor.name])}},Zw=function(t){var r=nu(t.Nat0()),e=Qe(t);return function(n){var u=Dk(n)(Ka.value),a=vr(r);return e(Ra(a*u+.5))}},t0=Zw(oe(ie)),io=function(t){return function(r){return function(){Jf(t)(r)();var n=Qu(t.drag)();if(n instanceof g)return void 0;if(n instanceof d){var u=Yw(t)(),a=ao(n.value0),p=t0(u),l={amount:p,ring:a.ring};qf(t.drag)(g.value)(),ro(t.gemini)(Jw(l))();var _=Qu(t.gemini)();return Kw(Hf(_))(t.pushConfetti(Ja.value))()}throw new Error("Failed pattern match at Gemini.Component.Puzzle.Actions (line 76, column 3 - line 87, column 28): "+[n.constructor.name])}}};var Kf=window.matchMedia("(pointer: coarse), (hover: none)").matches;var Qf=typeof module>"u"?void 0:module.require,a8t=function(){try{return Qf===void 0?void 0:Qf("util")}catch{return}}();var i8t=function(){var t;if(typeof performance<"u")t=performance;else if(Qf)try{t=Qf("perf_hooks").performance}catch{}return function(){return(t||Date).now()}}();var n0=N_(aa);var Yf=function(t){return function(r){return Sa(function(e){return function(){var u=Ii(t)(n0(r)(e))();return u}})}};var A_=xp(Pt)(Vt),fo=S(Kt),u0=zt($),a0=J(no),i0=vt(re),o0=_e(ve)(re),f0=$n(jn),c0=j(da),p0=ju(Xf),l0=B(uo),_0=P(Fe),k_=B(eo),v0=ju(Vf),gk=ut(_c),s0=ob(Vt),hk=oe(ie),Sk=zt(Yt),b0=ut(oA),m0=Ku({reflectType:function(){return"<div ~diskAttrs~ />"}})()()(Bf()(to)({reflectType:function(){return"diskAttrs"}})({reflectSymbol:function(){return"diskAttrs"}})),oo=qt(Oe),D0=Pf(Ki),Zf=P(_r),D_=S(Yt),A0=Ol(Rl),k0=ne(DA),d0=ne(yA),y0=Xu(Wo(hk)),$k=Ba(Ki),g0=QD(Rl),S0=Xu(Ho),$0=function(t){if(t instanceof $t)return"left: 14.9%";if(t instanceof Mt)return"right: 14.9%";if(t instanceof Dt)return"";throw new Error("Failed pattern match at Gemini.Component.Puzzle (line 130, column 3 - line 133, column 21): "+[t.constructor.name])},h0=function(){return A_(fo(Ae)([H(Dt.value)(2),H(Dt.value)(7)]))}(),C0=function(){return A_(fo(Ae)([H(Dt.value)(16),H(Dt.value)(11)]))}(),F0=function(t){return Yf(ja(t.drag))(function(r){return u0(t.domInfo)(function(e){return{drag:r,domInfo:e}})})},T0=function(t){return function(r){return Er(a0)(i0(r.drag)(function(e){var n=ao(e);return o0(f0(c0(t)(n.ring)))(function(){var u=p0(r.domInfo.ringCenter(n.ring)),a=function(){var p=l0(u);return function(l){return jf(p(l))}}();return _0(k_(a(e.currentPoint))(v0(a(e.initialPoint))))})}))}},x0=function(t){var r=43*(1+mk(t)),e=43*(1+bk(t));return"left: "+(gk(r)+("%; top: "+(gk(e)+"%")))},M0=function(){return A_(fo(Ae)([H($t.value)(2),H($t.value)(7),H(Mt.value)(16),H(Mt.value)(11)]))}(),E0=function(t){var r=ao(t);if(r.ring instanceof $t)return C0;if(r.ring instanceof Dt)return M0;if(r.ring instanceof Mt)return h0;throw new Error("Failed pattern match at Gemini.Component.Puzzle (line 137, column 3 - line 140, column 32): "+[r.ring.constructor.name])},w0=function(t){return function(r){if(r instanceof g)return!1;if(r instanceof d)return s0(Ae(t))(E0(r.value0));throw new Error("Failed pattern match at Gemini.Component.Puzzle (line 109, column 1 - line 109, column 44): "+[t.constructor.name,r.constructor.name])}},I0=function(t){var r=nu(t.Nat0());return function(e){var n=__(vr(Ke(e))/vr(r))(Ka.value);return k_(n)(__(-90)(zf.value))}},L0=I0(hk),P0=function(t){return function(r){var e=L0(t.position),n=F0(r),u=Sk(n)(T0(t.ring)),a=Sk(ja(r.gemini))(function(){var p=Gl(t);return function(l){return df(b0(function(_){return _.color}(p(l))))}}());return m0(Ju)({diskAttrs:oo(D0([Zf("disk"),a,Ha(D_(w0(t))(ja(r.drag)))("hidden")]))(oo(Zf(ul("disk")("")))(oo(A0(D_(x0)(oo(Zf(e))(D_(k_(e))(u)))))(oo(k0(Kl.value)(za(m_({drag:r.drag,location:t}))))(d0(t_.value)(Ga(m_({drag:r.drag,location:t})))))))})}},Ck=function(t){var r=function(n){return Ht(fo)(y0)(function(u){var a={ring:n,position:u};return P0(a)(t)})},e=function(n){return Of([$k("w-full relative"),g0($0(n)),Zf(ul("ring")(function(){if(n instanceof $t)return"left";if(n instanceof Dt)return"center";if(n instanceof Mt)return"right";throw new Error("Failed pattern match at Gemini.Component.Puzzle (line 57, column 13 - line 60, column 35): "+[n.constructor.name])}()))])(r(n))};return Of([$k("gemini")])(fo(e)(S0))};var Tk=()=>({ringRadius:O0(),leftRingCenter:d_('[data-ring="left"]'),centerRingCenter:d_('[data-ring="center"]'),rightRingCenter:d_('[data-ring="right"]')});function d_(t){let e=document.querySelector(t).getBoundingClientRect(),n=e.width,u=e.left,a=e.top,p=n/2;return{x:u+p,y:a+p}}function Fk(t){return document.querySelector(t).getBoundingClientRect().width}function O0(){let t=Fk("[data-ring]"),r=Fk("[data-disk]");return(t-r)/2}var xk=zt($)(Tk)(function(t){return{ringRadius:t.ringRadius,ringCenter:function(r){if(r instanceof $t)return t.leftRingCenter;if(r instanceof Dt)return t.centerRingCenter;if(r instanceof Mt)return t.rightRingCenter;throw new Error("Failed pattern match at Gemini.DomInfo (line 30, column 13 - line 33, column 43): "+[r.constructor.name])}}}),Mk={ringRadius:0,ringCenter:J(Qn(s_))};var Ek=t=>new ResizeObserver(r=>t(r)()),wk=t=>r=>()=>r.observe(t),y_=t=>()=>t.disconnect();var g_=function(){var t=function(){var r=Nf(Cu($r(J(Qn(Tn(Fn)))))),e=Ek(function(n){var u=Oi(n);return function(){var p=Cu(lr(r))();return p(u.target)()}});return{ref:r,ob:e}}();return{event:Sa(function(r){return function(){return Cu(ee(r)(t.ref))(),y_(t.ob)}}),listen:function(r){return function(){y_(t.ob)();var n=Cu(lr(t.ref))();return n(r)(),wk(r)(t.ob)()}}}}();var Yu=Bf(),rc=tk(),Lk=Yu(to),H0=Ku({reflectType:function(){return`
    <a target="_blank" rel="noopener noreferrer" ~linkAttrs~>
        <img ~imgAttrs~ />
        <span ~labelAttrs~>~label~</span>
    </a>
  `}})()()(Yu(rc(Yu(Lk({reflectType:function(){return"linkAttrs"}})({reflectSymbol:function(){return"linkAttrs"}}))({reflectType:function(){return"labelAttrs"}})({reflectSymbol:function(){return"labelAttrs"}}))({reflectType:function(){return"label"}})({reflectSymbol:function(){return"label"}}))({reflectType:function(){return"imgAttrs"}})({reflectSymbol:function(){return"imgAttrs"}})),We=qt(Oe),q0=Ba(zD),G0=ne(VD),z0=Ba(GD),V0=ne(gA),X0=Ba(qD),j0=Ku({reflectType:function(){return`
    <div ~headerAttrs~>
      <button class="action-button" ~buttonAttrs~>
        Scramble
      </button>
    </div>
  `}})()()(Yu(Lk({reflectType:function(){return"headerAttrs"}})({reflectSymbol:function(){return"headerAttrs"}}))({reflectType:function(){return"buttonAttrs"}})({reflectSymbol:function(){return"buttonAttrs"}})),ec=Pf(Ki),Qa=P(_r),J0=ne(_A),Pk=rc(to),Rk={reflectType:function(){return"footer"}},Ok={reflectSymbol:function(){return"footer"}},tc=dn(zA),Ik=_e(ve)(Uf),K0=Ku({reflectType:function(){return`
          <div ~attrs~>
            <div ~confettiAttrs~ >
            </div>
            <div class="mt-12 flex flex-col gap-12 items-center">
              ~header~
              ~puzzle~
              ~footer~
            </div>
          </div>
        `}})()()(Yu(Yu(rc(rc(Pk({reflectType:function(){return"puzzle"}})({reflectSymbol:function(){return"puzzle"}}))({reflectType:function(){return"header"}})({reflectSymbol:function(){return"header"}}))(Rk)(Ok))({reflectType:function(){return"confettiAttrs"}})({reflectSymbol:function(){return"confettiAttrs"}}))({reflectType:function(){return"attrs"}})({reflectSymbol:function(){return"attrs"}})),Q0=zt(Yt),Y0=ne($A),Z0=ne(vA),t1=ne(bA),r1=ne(mA),e1=ne(sA),n1=ne(dA),u1=ne(kA),a1=ne(AA),i1=function(t){return function(r){return function(e){return H0(Ju)({linkAttrs:We(q0("flex items-center p-2 underline decoration-sky-500/30"))(G0(Lf.value)(r)),imgAttrs:We(z0("h-[20px] m-2"))(V0(r_.value)(t)),labelAttrs:X0("decoration-sky-500/30"),label:D(e)})}}},o1=function(t){return j0(Ju)({headerAttrs:ec([Qa("flex justify-center"),Ha(Qa(Kf))("hidden")]),buttonAttrs:J0(zl.value)(_k(t))})},f1=Ku({reflectType:function(){return`
      <div ~footer~>
        <div class="text-2xl">
          <div>Q: Rotate left disk counter clockwise</div>
          <div>W: Rotate left disk clockwise</div>
          <div>T: Rotate center disk counter clockwise</div>
          <div>Y: Rotate center disk clockwise</div>
          <div>O: Rotate right disk counter clockwise</div>
          <div>P: Rotate right disk clockwise</div>
        </div>
        <div class="fixed bottom-0 left-0">
          ~viewSource~
        </div>
      </div>
    `}})()()(Yu(Pk({reflectType:function(){return"viewSource"}})({reflectSymbol:function(){return"viewSource"}}))(Rk)(Ok))(Ju)({footer:ec([Ha(Qa(Kf))("hidden")]),viewSource:i1("./github.png")("https://github.com/CharlesTaylor7/gemini")("View Source")}),Nk=Ue(c_(lA))(function(t){return Ue(c_(g.value))(function(r){return Ue(a_)(function(e){return hA(KA(e.value1)(function(n){if(n instanceof Ja)return tc(yn("fade in"));if(n instanceof lk)return Ik(tc(yn("fade out")))(function(){return Ik(HA(1e3))(function(){return tc(e.value0(p_.value))})});if(n instanceof p_)return tc(yn("off"));throw new Error("Failed pattern match at Gemini.Component.App (line 27, column 7 - line 40, column 41): "+[n.constructor.name])}))(function(){return Ue(Wf(Mk)(Yf(g_.event)(h(xk))))(function(n){var u={gemini:t,drag:r,domInfo:n,pushConfetti:e.value0};return K0(Ju)({header:o1(t),confettiAttrs:ec([Qa("confetti")]),attrs:We(ec([Qa("fixed w-full h-full flex justify-center"),Ha(Q0(ja(r))(ui))("cursor-grabbing")]))(We(TA)(We(CA(Qa(0)))(We(Y0(SA.value)(function(a){return g_.listen(a)}))(We(Z0(Vl.value)(FA(vk(u))))(We(t1(jl.value)(za(Jf(u))))(We(r1(Jl.value)(za(io(u))))(We(e1(Xl.value)(za(io(u))))(We(n1(Zl.value)(Ga(Jf(u))))(We(u1(Yl.value)(Ga(io(u))))(a1(Ql.value)(Ga(io(u))))))))))))),puzzle:Ck(u),footer:f1})})})})})});var Uk=function(){return yn(ut(Vn(me))(zt(Kt)(hu)(function(r){return Ae(function(e){return e.alternate}(r))})))(),HD(Nk)()};Uk();})();
//# sourceMappingURL=index.js.map
