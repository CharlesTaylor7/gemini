(()=>{var Sk=function(t){return function(r){return function(e){return function(n){return function(u){return n<u?t:n===u?r:e}}}}};var Ql=Sk;var Yl=function(t){return function(r){return t===r}},Zl=Yl,t_=Yl;var vt=function(){function t(){}return t.value=new t,t}();var Or=function(t){return t.reflectSymbol};var Le=function(t){return function(r){return r[t]}};var Xu={eq:t_};var Jf={eq:Zl};var j=function(t){return t.eq},Tk=j(Jf);var ja=function(t){var r=j(t);return function(e){return function(n){return Tk(r(e)(n))(!1)}}};var bt=function(){function t(){}return t.value=new t,t}(),kt=function(){function t(){}return t.value=new t,t}(),wt=function(){function t(){}return t.value=new t,t}();var r_=function(t){return function(r){return t-r|0}};var e_=function(t){return function(r){return t+r|0}},n_=function(t){return function(r){return t*r|0}},u_=function(t){return function(r){return t+r}},a_=function(t){return function(r){return t*r}};var Ja={add:u_,zero:0,mul:a_,one:1},tu={add:e_,zero:0,mul:n_,one:1};var ae=function(t){return t.mul};var Nr=function(t){return t.add};var io={sub:r_,Semiring0:function(){return tu}};var Gt=function(){return{compare:Ql(bt.value)(wt.value)(kt.value),Eq0:function(){return Xu}}}();var ot=function(t){return t.compare};var i_=function(t){var r=ot(t);return function(e){return function(n){var u=r(e)(n);return!(u instanceof bt)}}},Qf=function(t){var r=ot(t);return function(e){return function(n){var u=r(e)(n);return u instanceof bt}}};var Yf=function(t){var r=ot(t);return function(e){return function(n){var u=r(e)(n);return!(u instanceof kt)}}};var o_=t=>{for(var r=0,e=t.length;r<e;r++)t[r]()},co=(t,r)=>{for(var e=0,n=t.length;e<n;e++)r(t[e])},Zf=(t,r)=>{for(let e in t)r(t[e])},tc=()=>({}),rc=(t,r,e)=>{e[t]=r},ec=(t,r)=>{delete r[t]};var f_=function(t){return function(r){for(var e=r.length,n=new Array(e),u=0;u<e;u++)n[u]=t(r[u]);return n}};var ru={compose:function(t){return function(r){return function(e){return t(r(e))}}}},ju=function(t){return t.compose};var dt=function(t){return t.identity},yt={identity:function(t){return t},Semigroupoid0:function(){return ru}};var vr=!0;var Wt=function(t){return function(r){return function(e){return t(e)(r)}}},h=function(t){return function(r){return t}};var Ka=function(t){return function(r){return r(t)}};var g=function(t){return t.map},Yt=function(t){var r=g(t);return function(e){return function(n){return r(n)(e)}}},jt=function(t){return g(t)(h(void 0))},E=function(t){var r=g(t);return function(e){return function(n){return r(h(n))(e)}}};var Qr={map:ju(ru)},Vt={map:f_};var c_=function(t){return function(r){return t+r}},p_=function(t){return function(r){return t.length===0?r:r.length===0?t:t.concat(r)}};var __={append:function(t){return function(r){return void 0}}},po={append:c_};var Sr={append:p_};var U=function(t){return t.append},v_=function(t){var r=U(t);return{append:function(e){return function(n){return function(u){return r(e(u))(n(u))}}}}};var zt=function(t){return t.alt};var Hk=dt(yt);var Mt=function(t){return t.apply};var on=function(t){var r=Mt(t),e=g(t.Functor0());return function(n){return function(u){return r(e(h(Hk))(n))(u)}}},mr=function(t){var r=Mt(t),e=g(t.Functor0());return function(n){return function(u){return function(f){return r(e(n)(u))(f)}}}};var I=function(t){return t.pure};var Qa=function(t){var r=Mt(t.Apply0()),e=I(t);return function(n){return function(u){return r(e(n))(u)}}};var N=function(t){return t};var nu=N;var m_=function(t){return function(r){return function(){return t(r())}}},A_=function(t){return function(){return t}},k_=function(t){return function(r){return function(){return r(t())()}}};function Ur(t){return function(){return{value:t}}}var kr=function(t){return function(){return t.value}},D_=function(t){return function(r){return function(){var e=t(r.value);return r.value=e.state,e.value}}},ie=function(t){return function(r){return function(){return r.value=t}}};var Vk=dt(yt),Ne=function(t){return t.discard};var ut=function(t){return t.bind},En=function(t){return Wt(ut(t))};var d_=function(t){var r=ut(t);return function(e){return function(n){return function(u){return r(e(u))(n)}}}};var Ue={discard:function(t){return ut(t)}};var Ju=function(t){var r=ut(t);return function(e){return r(e)(Vk)}};var oe=function(t){var r=ut(t.Bind1()),e=I(t.Applicative0());return function(n){return function(u){return r(n)(function(f){return r(u)(function(p){return e(f(p))})})}}};var Xk=String.fromCharCode(65535),jk=String.fromCharCode(0),Jk=Number.POSITIVE_INFINITY,Kk=Number.NEGATIVE_INFINITY;var fe=function(t){return t.top};var uu={top:2147483647,bottom:-2147483648,Ord0:function(){return Gt}};var se=function(t){return t.bottom};var S_=function(t){return t.toString()},$_=function(t){var r=t.toString();return isNaN(r+".0")?r:r+".0"};var Za={show:$_},In={show:S_};var ft=function(t){return t.show};var Wr=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),Rt=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}();var fn=function(){function t(){}return t.value=new t,t}();var oc=function(t){return t.from};var aD=dt(yt),S=function(){function t(){}return t.value=new t,t}(),y=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}();var rr=function(t){return function(r){return function(e){if(e instanceof S)return t;if(e instanceof y)return r(e.value0);throw new Error("Failed pattern match at Data.Maybe (line 237, column 1 - line 237, column 51): "+[t.constructor.name,r.constructor.name,e.constructor.name])}}},Yu=rr(!0)(h(!1)),ti=rr(!1)(h(!0));var nr={map:function(t){return function(r){return r instanceof y?new y(t(r.value0)):S.value}}},iD=g(nr);var Dr=function(t){return rr(t)(aD)},dr=function(){return function(t){if(t instanceof y)return t.value0;throw new Error("Failed pattern match at Data.Maybe (line 288, column 1 - line 288, column 46): "+[t.constructor.name])}};var au={apply:function(t){return function(r){if(t instanceof y)return iD(t.value0)(r);if(t instanceof S)return S.value;throw new Error("Failed pattern match at Data.Maybe (line 67, column 1 - line 69, column 30): "+[t.constructor.name,r.constructor.name])}},Functor0:function(){return nr}};var Er={bind:function(t){return function(r){if(t instanceof y)return r(t.value0);if(t instanceof S)return S.value;throw new Error("Failed pattern match at Data.Maybe (line 125, column 1 - line 127, column 28): "+[t.constructor.name,r.constructor.name])}},Apply0:function(){return au}};var Ce=function(){return{pure:y.create,Apply0:function(){return au}}}();var fc={alt:function(t){return function(r){return t instanceof S?r:t}},Functor0:function(){return nr}},oD=function(){return{empty:S.value,Alt0:function(){return fc}}}(),Pn={Applicative0:function(){return Ce},Plus1:function(){return oD}};var Jt=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),Kt=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}();var iu=function(t){return function(r){return function(e){if(e instanceof Jt)return t(e.value0);if(e instanceof Kt)return r(e.value0);throw new Error("Failed pattern match at Data.Either (line 208, column 1 - line 208, column 64): "+[t.constructor.name,r.constructor.name,e.constructor.name])}}},cc=function(){return iu(h(S.value))(y.create)}();var cn=function(t){return t};var ou={map:function(t){return function(r){return t(r)}}};var h_={apply:function(t){return function(r){return t(r)}},Functor0:function(){return ou}},fD={bind:function(t){return function(r){return r(t)}},Apply0:function(){return h_}},cD={pure:cn,Apply0:function(){return h_}},ri={Applicative0:function(){return cD},Bind1:function(){return fD}};var F_=function(t){return Math.min(Math.abs(t),2147483647)},T_=function(t){return function(r){return r===0?0:r>0?Math.floor(t/r):-Math.floor(t/-r)}},x_=function(t){return function(r){if(r===0)return 0;var e=Math.abs(r);return(t%e+e)%e}};var M_={Ring0:function(){return io}};var ce=function(t){return t.mod};var Yr={degree:F_,div:T_,mod:x_,CommutativeRing0:function(){return M_}},pn=function(t){return t.div};var _n={mempty:void 0,Semigroup0:function(){return __}};var V=function(t){return t.mempty},Ln=function(t){var r=V(t),e=v_(t.Semigroup0());return{mempty:function(n){return r},Semigroup0:function(){return e}}};var pc=function(t){return function(){return t}},E_=function(t){return function(r){return function(){return r(t())()}}};var w_=function(t,r,e){var n=0,u;return function(f){if(n===2)return u;if(n===1)throw new ReferenceError(t+" was needed before it finished initializing (module "+r+", line "+f+")",r,f);return n=1,u=e(),n=2,u}},Zu={Applicative0:function(){return Zr},Bind1:function(){return ta}},ta={bind:E_,Apply0:function(){return lc(0)}},Zr={pure:pc,Apply0:function(){return lc(0)}},I_=w_("functorEffect","Effect",function(){return{map:Qa(Zr)}}),lc=w_("applyEffect","Effect",function(){return{apply:oe(Zu),Functor0:function(){return I_(0)}}}),$=I_(20),lo=lc(23),bD=mr(lo),_c=function(t){return{append:bD(U(t))}},vn=function(t){var r=_c(t.Semigroup0());return{mempty:pc(V(t)),Semigroup0:function(){return r}}};var P_=function(t){return function(){return{value:t}}};var yr=function(t){return function(){return t.value}},L_=function(t){return function(r){return function(){var e=t(r.value);return r.value=e.state,e.value}}},Br=function(t){return function(r){return function(){r.value=t}}};var AD=jt($),Hr=P_,kD=L_,_o=function(t){return kD(function(r){var e=t(r);return{state:e,value:e}})},ni=function(t){return function(r){return AD(_o(t)(r))}};var $D=function(t,r,e){var n=0,u;return function(f){if(n===2)return u;if(n===1)throw new ReferenceError(t+" was needed before it finished initializing (module "+r+", line "+f+")",r,f);return n=1,u=e(),n=2,u}},CD=D_,He=function(t){return CD(function(r){var e=t(r);return{state:e,value:e}})},pe={map:m_};var bc={Applicative0:function(){return $r},Bind1:function(){return ui}},ui={bind:k_,Apply0:function(){return mc(0)}},$r={pure:A_,Apply0:function(){return mc(0)}},mc=$D("applyST","Control.Monad.ST.Internal",function(){return{apply:oe(bc),Functor0:function(){return pe}}}),vo=mc(47),hD=mr(vo);var FD=I($r),Ac=function(t){return{append:hD(U(t))}};var O_=function(t){var r=Ac(t.Semigroup0());return{mempty:FD(V(t)),Semigroup0:function(){return r}}};var fu={liftST:nu,Monad0:function(){return Zu}},cu=function(t){return t.liftST};var TD=function(t,r){if(t<1)return[];var e=new Array(t);return e.fill(r)},xD=function(t,r){for(var e=[],n=0,u=0;u<t;u++)e[n++]=r;return e},MD=typeof Array.prototype.fill=="function"?TD:xD,N_=function(){function t(u,f){this.head=u,this.tail=f}var r={};function e(u){return function(f){return new t(u,f)}}function n(u){for(var f=[],p=0,_=u;_!==r;)f[p++]=_.head,_=_.tail;return f}return function(u,f){return n(u(e)(r)(f))}}(),qe=function(t){return t.length};var U_=function(t,r,e,n){return n<0||n>=e.length?r:t(e[n])};var W_=function(t,r,e,n){for(var u=0,f=n.length;u<f;u++)if(e(n[u]))return t(u);return r};var B_=function(t,r,e,n){if(e<0||e>=n.length)return r;var u=n.slice();return u.splice(e,1),t(u)};var bo=function(t){return t.slice().reverse()};var ED=function(){function t(r,e,n,u,f,p){var _,l,d,L,P,T,w;for(_=f+(p-f>>1),_-f>1&&t(r,e,u,n,f,_),p-_>1&&t(r,e,u,n,_,p),l=f,d=_,L=f;l<_&&d<p;)P=u[l],T=u[d],w=e(r(P)(T)),w>0?(n[L++]=T,++d):(n[L++]=P,++l);for(;l<_;)n[L++]=u[l++];for(;d<p;)n[L++]=u[d++]}return function(r,e,n){var u;return n.length<2?n:(u=n.slice(0),t(r,e,u,n.slice(0),0,n.length),u)}}();var H_=function(t,r){return t[r]};function pu(){return[]}var q_=function(t,r){return r.push.apply(r,t)};var G_=function(t,r,e,n){return n.splice.apply(n,[t,r].concat(e))};function ID(t){return t.slice()}var z_=ID;var PD=function(){function t(r,e,n,u,f,p){var _,l,d,L,P,T,w;for(_=f+(p-f>>1),_-f>1&&t(r,e,u,n,f,_),p-_>1&&t(r,e,u,n,_,p),l=f,d=_,L=f;l<_&&d<p;)P=u[l],T=u[d],w=e(r(P)(T)),w>0?(n[L++]=T,++d):(n[L++]=P,++l);for(;l<_;)n[L++]=u[l++];for(;d<p;)n[L++]=u[d++]}return function(r,e,n){return n.length<2||t(r,e,n,n.slice(0),0,n.length),n}}();var kc=function(r){return function(e){return function(){return r(e)}}},Dc=function(r){return function(e){return function(n){return function(){return r(e,n)}}}};var dc=function(r){return function(e){return function(n){return function(u){return function(f){return function(){return r(e,n,u,f)}}}}}};var yc=dc(G_);var Rn=function(t){return Dc(q_)([t])};var Ao=kc(z_);var j_=function(t){return function(r){return function(e){for(var n=r,u=e.length,f=u-1;f>=0;f--)n=t(e[f])(n);return n}}},J_=function(t){return function(r){return function(e){for(var n=r,u=e.length,f=0;f<u;f++)n=t(n)(e[f]);return n}}};var v=function(t){return t.empty};var x=function(){function t(r,e){this.value0=r,this.value1=e}return t.create=function(r){return function(e){return new t(r,e)}},t}();var wr=function(t){return t.value1};var Ae=function(t){return t.value0};var ra=function(t){return function(r){return function(e){return t(new x(r,e))}}};var Ar=function(){return N};var YD=Ar();var qr=function(){return YD};var ir=function(t){return t.foldr};var ua=function(t){var r=on(t.Apply0()),e=I(t);return function(n){var u=ir(n);return function(f){return u(function(p){return r(f(p))})(e(void 0))}}},On=function(t){var r=ua(t);return function(e){return Wt(r(e))}};var er=function(t){return t.foldl};var Nn={foldr:function(t){return function(r){return function(e){if(e instanceof S)return r;if(e instanceof y)return t(e.value0)(r);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[t.constructor.name,r.constructor.name,e.constructor.name])}}},foldl:function(t){return function(r){return function(e){if(e instanceof S)return r;if(e instanceof y)return t(r)(e.value0);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[t.constructor.name,r.constructor.name,e.constructor.name])}}},foldMap:function(t){var r=V(t);return function(e){return function(n){if(n instanceof S)return r;if(n instanceof y)return e(n.value0);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[e.constructor.name,n.constructor.name])}}}};var ev=function(t){var r=ir(t);return function(e){var n=U(e.Semigroup0()),u=V(e);return function(f){return r(function(p){return function(_){return n(f(p))(_)}})(u)}}},ht={foldr:j_,foldl:J_,foldMap:function(t){return ev(ht)(t)}};var br=function(t){return t.foldMap};var aa=function(t){return function(r){return function(e){return t(r,e)}}};var ia=function(t){return function(r){return function(e){return function(n){return function(u){return t(r,e,n,u)}}}}};var nv=function(t){return function(r){for(var e=r.length,n=Array(e),u=0;u<e;u++)n[u]=t(u)(r[u]);return n}};var bn=function(t){return t.mapWithIndex};var Un={mapWithIndex:nv,Functor0:function(){return Vt}};var ov=function(){function t(u){return[u]}function r(u){return function(f){return[u,f]}}function e(u){return function(f){return function(p){return[u,f,p]}}}function n(u){return function(f){return u.concat(f)}}return function(u){return function(f){return function(p){return function(_){return function(l){function d(L,P){switch(P-L){case 0:return p([]);case 1:return f(t)(_(l[L]));case 2:return u(f(r)(_(l[L])))(_(l[L+1]));case 3:return u(u(f(e)(_(l[L])))(_(l[L+1])))(_(l[L+2]));default:var T=L+Math.floor((P-L)/4)*2;return u(f(n)(d(L,T)))(d(T,P))}}return d(0,l.length)}}}}}}();var Nd=dt(yt),De=function(t){return t.traverse};var dv=function(t){var r=De(t);return function(e){return r(e)(Nd)}},_u={traverse:function(t){var r=t.Apply0();return ov(Mt(r))(g(r.Functor0()))(I(t))},sequence:function(t){return dv(_u)(t)},Functor0:function(){return Vt},Foldable1:function(){return ht}},vu=function(t){return t.sequence};var yv=function(t){return function(r){return function(e){return function(n){return function(u){return function(f){for(var p=[],_=f;;){var l=u(_);if(t(l))return p;var d=r(l);p.push(e(d)),_=n(d)}}}}}}};var gv=function(t){return function(r){return function(e){return function(n){return function(u){return function(f){for(var p=[],_=f;;){var l=u(_);p.push(e(l));var d=n(l);if(t(d))return p;_=r(d)}}}}}}};var jd=dr(),si=function(t){return t.unfoldr1};var fa={unfoldr1:gv(Yu)(jd)(Ae)(wr)},Sv=function(t){var r=si(t);return function(e){return function(n){var u=function(f){if(f<=0)return new x(n,S.value);if(vr)return new x(n,new y(f-1|0));throw new Error("Failed pattern match at Data.Unfoldable1 (line 68, column 5 - line 68, column 39): "+[f.constructor.name])};return r(u)(e-1|0)}}};var Rc=function(t){return Sv(t)(1)};var Jd=dr(),An=function(t){return t.unfoldr};var su={unfoldr:yv(Yu)(Jd)(Ae)(wr),Unfoldable10:function(){return fa}},Kd=function(t){var r=An(t);return function(e){return function(n){var u=function(f){var p=f<=0;return p?S.value:new y(new x(n,f-1|0))};return r(u)(e)}}},$v=function(t){return function(r){var e=Kd(r);return function(n){var u=vu(n)(t);return function(f){return function(p){return u(e(f)(p))}}}}};var ey=g(nr);var ny=dr();var hv=function(){return aa(H_)},uy=hv();var Oc=function(t){return[t]};var bu=function(){return ia(U_)(y.create)(S.value)}(),Nc=function(t){return bu(t)(qe(t)-1|0)};var bi=function(t){return aa(N_)(ir(t))};var Uc=function(){return ia(W_)(y.create)(S.value)}(),Mo=function(t){return function(r){return ey(uy(r))(Uc(t)(r))}};var Fv=function(){return ia(B_)(y.create)(S.value)}(),Wc=function(t){return function(r){return function(e){return e.length===0?[]:rr(e)(function(n){return ny(Fv(n)(e))})(Uc(t(r))(e))}}};var Eo=function(t){return t.foldrWithIndex};var Au=function(){function t(r,e){this.value0=r,this.value1=e}return t.create=function(r){return function(e){return new t(r,e)}},t}();var St=function(){function t(){}return t.value=new t,t}(),lt=function(){function t(r,e){this.value0=r,this.value1=e}return t.create=function(r){return function(e){return new t(r,e)}},t}();var cy=function(t){var r=function(e){return function(n){var u=e,f=!1,p;function _(l,d){if(d instanceof lt&&d.value1 instanceof lt&&d.value1.value1 instanceof lt){u=new lt(d,l),n=d.value1.value1.value1;return}var L=function(T){return T instanceof lt&&T.value1 instanceof lt&&T.value1.value1 instanceof St?new lt(t(T.value0),new lt(t(T.value1.value0),St.value)):T instanceof lt&&T.value1 instanceof St?new lt(t(T.value0),St.value):St.value},P=function(T){return function(w){var nt=T,J=!1,ct;function _t(Pt,zr){if(Pt instanceof lt&&Pt.value0 instanceof lt&&Pt.value0.value1 instanceof lt&&Pt.value0.value1.value1 instanceof lt){nt=Pt.value1,w=new lt(t(Pt.value0.value0),new lt(t(Pt.value0.value1.value0),new lt(t(Pt.value0.value1.value1.value0),zr)));return}return J=!0,zr}for(;!J;)ct=_t(nt,w);return ct}};return f=!0,P(l)(L(d))}for(;!f;)p=_(u,n);return p}};return r(St.value)},wo={map:cy},py=g(wo);var le={foldr:function(t){return function(r){var e=function(){var u=function(f){return function(p){var _=f,l=!1,d;function L(P,T){if(T instanceof St)return l=!0,P;if(T instanceof lt){_=new lt(T.value0,P),p=T.value1;return}throw new Error("Failed pattern match at Data.List.Types (line 107, column 7 - line 107, column 23): "+[P.constructor.name,T.constructor.name])}for(;!l;)d=L(_,p);return d}};return u(St.value)}(),n=er(le)(Wt(t))(r);return function(u){return n(e(u))}}},foldl:function(t){var r=function(e){return function(n){var u=e,f=!1,p;function _(l,d){if(d instanceof St)return f=!0,l;if(d instanceof lt){u=t(l)(d.value0),n=d.value1;return}throw new Error("Failed pattern match at Data.List.Types (line 111, column 12 - line 113, column 30): "+[d.constructor.name])}for(;!f;)p=_(u,n);return p}};return r},foldMap:function(t){var r=U(t.Semigroup0()),e=V(t);return function(n){return er(le)(function(u){var f=r(u);return function(p){return f(n(p))}})(e)}}};var ly=ir(le);var Bc={append:function(t){return function(r){return ly(lt.create)(r)(t)}}},Iv=U(Bc);var Pv={apply:function(t){return function(r){if(t instanceof St)return St.value;if(t instanceof lt)return Iv(py(t.value0)(r))(Mt(Pv)(t.value1)(r));throw new Error("Failed pattern match at Data.List.Types (line 157, column 1 - line 159, column 48): "+[t.constructor.name,r.constructor.name])}},Functor0:function(){return wo}};var Hc={bind:function(t){return function(r){if(t instanceof St)return St.value;if(t instanceof lt)return Iv(r(t.value0))(ut(Hc)(t.value1)(r));throw new Error("Failed pattern match at Data.List.Types (line 164, column 1 - line 166, column 37): "+[t.constructor.name,r.constructor.name])}},Apply0:function(){return Pv}};var ky=ut(Hc);var qc=function(){var t=function(r){return function(e){var n=r,u=!1,f;function p(_,l){if(l instanceof St)return u=!0,_;if(l instanceof lt){n=new lt(l.value0,_),e=l.value1;return}throw new Error("Failed pattern match at Data.List (line 368, column 3 - line 368, column 19): "+[_.constructor.name,l.constructor.name])}for(;!u;)f=p(n,e);return f}};return t(St.value)}();var Io=function(t){return ir(t)(lt.create)(St.value)};var Lv=Wt(ky);var Du=function(t,r,e){var n=0,u;return function(f){if(n===2)return u;if(n===1)throw new ReferenceError(t+" was needed before it finished initializing (module "+r+", line "+f+")",r,f);return n=1,u=e(),n=2,u}};var Zt=function(){function t(){}return t.value=new t,t}(),Qt=function(){function t(r,e,n,u,f,p){this.value0=r,this.value1=e,this.value2=n,this.value3=u,this.value4=f,this.value5=p}return t.create=function(r){return function(e){return function(n){return function(u){return function(f){return function(p){return new t(r,e,n,u,f,p)}}}}}},t}();var Po=function(){function t(r,e,n){this.value0=r,this.value1=e,this.value2=n}return t.create=function(r){return function(e){return function(n){return new t(r,e,n)}}},t}(),Rv=function(){function t(r,e,n){this.value0=r,this.value1=e,this.value2=n}return t.create=function(r){return function(e){return function(n){return new t(r,e,n)}}},t}(),ge=function(t,r,e,n){if(e instanceof Zt){if(n instanceof Zt)return new Qt(1,1,t,r,e,n);if(n instanceof Qt)return new Qt(1+n.value0|0,1+n.value1|0,t,r,e,n);throw new Error("Failed pattern match at Data.Map.Internal (line 680, column 5 - line 684, column 39): "+[n.constructor.name])}if(e instanceof Qt){if(n instanceof Zt)return new Qt(1+e.value0|0,1+e.value1|0,t,r,e,n);if(n instanceof Qt)return new Qt(1+function(){var u=e.value0>n.value0;return u?e.value0:n.value0}()|0,(1+e.value1|0)+n.value1|0,t,r,e,n);throw new Error("Failed pattern match at Data.Map.Internal (line 686, column 5 - line 690, column 68): "+[n.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 678, column 32 - line 690, column 68): "+[e.constructor.name])};var Ro=function(t){return function(r){return new Qt(1,1,t,r,Zt.value,Zt.value)}},Fe=function(){var t=function(n){if(n instanceof Zt)return 0;if(n instanceof Qt)return n.value0;throw new Error("Failed pattern match at Data.Map.Internal (line 735, column 12 - line 737, column 26): "+[n.constructor.name])},r=function(n,u,f,p,_,l,d){return l instanceof Qt&&l.value0>t(d)?ge(l.value2,l.value3,ge(n,u,f,l.value4),ge(p,_,l.value5,d)):ge(p,_,ge(n,u,f,l),d)},e=function(n,u,f,p,_,l,d){return l instanceof Qt&&t(_)<=l.value0?ge(l.value2,l.value3,ge(f,p,_,l.value4),ge(n,u,l.value5,d)):ge(f,p,_,ge(n,u,l,d))};return function(n,u,f,p){if(f instanceof Zt)return p instanceof Zt?Ro(n)(u):p instanceof Qt&&p.value0>1?r(n,u,f,p.value2,p.value3,p.value4,p.value5):ge(n,u,f,p);if(f instanceof Qt){if(p instanceof Qt){if(p.value0>(f.value0+1|0))return r(n,u,f,p.value2,p.value3,p.value4,p.value5);if(f.value0>(p.value0+1|0))return e(n,u,f.value2,f.value3,f.value4,f.value5,p)}return p instanceof Zt&&f.value0>1?e(n,u,f.value2,f.value3,f.value4,f.value5,p):ge(n,u,f,p)}throw new Error("Failed pattern match at Data.Map.Internal (line 695, column 40 - line 716, column 34): "+[f.constructor.name])}}(),Gc=Du("unsafeSplit","Data.Map.Internal",function(){return function(t,r,e){if(e instanceof Zt)return new Po(S.value,Zt.value,Zt.value);if(e instanceof Qt){var n=t(r)(e.value2);if(n instanceof bt){var u=Gc(771)(t,r,e.value4);return new Po(u.value0,u.value1,Fe(e.value2,e.value3,u.value2,e.value5))}if(n instanceof kt){var u=Gc(774)(t,r,e.value5);return new Po(u.value0,Fe(e.value2,e.value3,e.value4,u.value1),u.value2)}if(n instanceof wt)return new Po(new y(e.value3),e.value4,e.value5);throw new Error("Failed pattern match at Data.Map.Internal (line 769, column 5 - line 777, column 30): "+[n.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 765, column 34 - line 777, column 30): "+[e.constructor.name])}}),Ov=Gc(764),Nv=Du("unsafeSplitLast","Data.Map.Internal",function(){return function(t,r,e,n){if(n instanceof Zt)return new Rv(t,r,e);if(n instanceof Qt){var u=Nv(757)(n.value2,n.value3,n.value4,n.value5);return new Rv(u.value0,u.value1,Fe(t,r,e,u.value2))}throw new Error("Failed pattern match at Data.Map.Internal (line 754, column 37 - line 758, column 57): "+[n.constructor.name])}}),yy=Nv(753),Uv=function(t,r){if(t instanceof Zt)return r;if(t instanceof Qt){var e=yy(t.value2,t.value3,t.value4,t.value5);return Fe(e.value0,e.value1,e.value2,r)}throw new Error("Failed pattern match at Data.Map.Internal (line 742, column 25 - line 746, column 38): "+[t.constructor.name,r.constructor.name])};var zc=Du("unsafeUnionWith","Data.Map.Internal",function(){return function(t,r,e,n){if(e instanceof Zt)return n;if(n instanceof Zt)return e;if(n instanceof Qt){var u=Ov(t,n.value2,e),f=zc(787)(t,r,u.value1,n.value4),p=zc(788)(t,r,u.value2,n.value5);if(u.value0 instanceof y)return Fe(n.value2,r(u.value0.value0)(n.value3),f,p);if(u.value0 instanceof S)return Fe(n.value2,n.value3,f,p);throw new Error("Failed pattern match at Data.Map.Internal (line 789, column 5 - line 793, column 46): "+[u.value0.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 782, column 42 - line 793, column 46): "+[e.constructor.name,n.constructor.name])}}),gy=zc(781),Sy=function(t){var r=ot(t);return function(e){return function(n){return function(u){return gy(r,e,n,u)}}}},Wv=function(t){return Sy(t)(h)};var Bv=function(t){var r=ot(t);return function(e){var n=function(u){var f=!1,p;function _(l){if(l instanceof Zt)return f=!0,!1;if(l instanceof Qt){var d=r(e)(l.value2);if(d instanceof bt){u=l.value4;return}if(d instanceof kt){u=l.value5;return}if(d instanceof wt)return f=!0,!0;throw new Error("Failed pattern match at Data.Map.Internal (line 457, column 7 - line 460, column 19): "+[d.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 454, column 8 - line 460, column 19): "+[l.constructor.name])}for(;!f;)p=_(u);return p};return n}};var du=function(t){var r=ot(t);return function(e){var n=function(u){var f=!1,p;function _(l){if(l instanceof Zt)return f=!0,S.value;if(l instanceof Qt){var d=r(e)(l.value2);if(d instanceof bt){u=l.value4;return}if(d instanceof kt){u=l.value5;return}if(d instanceof wt)return f=!0,new y(l.value3);throw new Error("Failed pattern match at Data.Map.Internal (line 281, column 7 - line 284, column 22): "+[d.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 278, column 8 - line 284, column 22): "+[l.constructor.name])}for(;!f;)p=_(u);return p};return n}};var Ai=function(t){var r=ot(t);return function(e){return function(n){var u=function(f){if(f instanceof Zt)return Ro(e)(n);if(f instanceof Qt){var p=r(e)(f.value2);if(p instanceof bt)return Fe(f.value2,f.value3,u(f.value4),f.value5);if(p instanceof kt)return Fe(f.value2,f.value3,f.value4,u(f.value5));if(p instanceof wt)return new Qt(f.value0,f.value1,e,n,f.value4,f.value5);throw new Error("Failed pattern match at Data.Map.Internal (line 469, column 7 - line 472, column 35): "+[p.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 466, column 8 - line 472, column 35): "+[f.constructor.name])};return u}}};var Hv={foldr:function(t){return function(r){var e=Du("go","Data.Map.Internal",function(){return function(u,f){if(u instanceof Zt)return f;if(u instanceof Qt)return e(170)(u.value4,t(u.value3)(e(170)(u.value5,f)));throw new Error("Failed pattern match at Data.Map.Internal (line 167, column 26 - line 170, column 43): "+[u.constructor.name])}}),n=e(167);return function(u){return n(u,r)}}},foldl:function(t){return function(r){var e=Du("go","Data.Map.Internal",function(){return function(u,f){if(f instanceof Zt)return u;if(f instanceof Qt)return e(176)(t(e(176)(u,f.value4))(f.value3),f.value5);throw new Error("Failed pattern match at Data.Map.Internal (line 173, column 26 - line 176, column 43): "+[f.constructor.name])}}),n=e(173);return function(u){return n(r,u)}}},foldMap:function(t){var r=V(t),e=U(t.Semigroup0());return function(n){var u=function(f){if(f instanceof Zt)return r;if(f instanceof Qt)return e(u(f.value4))(e(n(f.value3))(u(f.value5)));throw new Error("Failed pattern match at Data.Map.Internal (line 179, column 10 - line 182, column 28): "+[f.constructor.name])};return u}}},$y={foldrWithIndex:function(t){return function(r){var e=Du("go","Data.Map.Internal",function(){return function(u,f){if(u instanceof Zt)return f;if(u instanceof Qt)return e(190)(u.value4,t(u.value2)(u.value3)(e(190)(u.value5,f)));throw new Error("Failed pattern match at Data.Map.Internal (line 187, column 26 - line 190, column 45): "+[u.constructor.name])}}),n=e(187);return function(u){return n(u,r)}}},foldlWithIndex:function(t){return function(r){var e=Du("go","Data.Map.Internal",function(){return function(u,f){if(f instanceof Zt)return u;if(f instanceof Qt)return e(196)(t(f.value2)(e(196)(u,f.value4))(f.value3),f.value5);throw new Error("Failed pattern match at Data.Map.Internal (line 193, column 26 - line 196, column 45): "+[f.constructor.name])}}),n=e(193);return function(u){return n(r,u)}}},foldMapWithIndex:function(t){var r=V(t),e=U(t.Semigroup0());return function(n){var u=function(f){if(f instanceof Zt)return r;if(f instanceof Qt)return e(u(f.value4))(e(n(f.value2)(f.value3))(u(f.value5)));throw new Error("Failed pattern match at Data.Map.Internal (line 199, column 10 - line 202, column 30): "+[f.constructor.name])};return u}},Foldable0:function(){return Hv}},qv=function(){return Eo($y)(function(t){return function(r){return function(e){return new lt(t,e)}}})(St.value)}();var Ge=function(){return Zt.value}(),Oo=function(t){var r=Ai(t);return function(e){return er(e)(function(n){return function(u){return r(u.value0)(u.value1)(n)}})(Ge)}};var Gv=function(t){var r=ot(t);return function(e){var n=function(u){if(u instanceof Zt)return Zt.value;if(u instanceof Qt){var f=r(e)(u.value2);if(f instanceof bt)return Fe(u.value2,u.value3,n(u.value4),u.value5);if(f instanceof kt)return Fe(u.value2,u.value3,u.value4,n(u.value5));if(f instanceof wt)return Uv(u.value4,u.value5);throw new Error("Failed pattern match at Data.Map.Internal (line 496, column 7 - line 499, column 43): "+[f.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 493, column 8 - line 499, column 43): "+[u.constructor.name])};return n}};var la=function(t){var r=ot(t);return function(e){return function(n){return function(u){var f=Ov(r,n,u),p=e(f.value0);if(p instanceof S)return Uv(f.value1,f.value2);if(p instanceof y)return Fe(n,p.value0,f.value1,f.value2);throw new Error("Failed pattern match at Data.Map.Internal (line 512, column 3 - line 516, column 41): "+[p.constructor.name])}}}};var gu=function(t){return t.filterMap};var Jc=Ar(),Oy=br(le),Ny=er(le),Uy=ir(le);var Wy=function(t){return Jc(Wv(t))};var jc=function(t){return qv(t)};var Vv=function(t){return Ro(t)(void 0)};var Kc=function(t){return{append:Wy(t)}},No=function(t){return Jc(Bv(t))};var By=function(t){var r=Ai(t);return function(e){return function(n){return r(e)(void 0)(n)}}};var Xv={foldMap:function(t){var r=Oy(t);return function(e){var n=r(e);return function(u){return n(jc(u))}}},foldl:function(t){return function(r){var e=Ny(t)(r);return function(n){return e(jc(n))}}},foldr:function(t){return function(r){var e=Uy(t)(r);return function(n){return e(jc(n))}}}};var jv=Ge,Uo=function(t){var r=er(t);return function(e){var n=By(e);return r(function(u){return function(f){return n(f)(u)}})(jv)}};var Jv=function(t){var r=Kc(t);return{mempty:jv,Semigroup0:function(){return r}}};var Kv=function(t){return Jc(Gv(t))};function Qv(t){return function(r){return function(){return setTimeout(r,t)}}}function Yv(t){return function(){clearTimeout(t)}}var qy=ot(Gt);var Zv=Qv;var Gy={eq:function(t){return function(r){return t===r}}},Wo={compare:function(t){return function(r){return qy(t)(r)}},Eq0:function(){return Gy}};var ts=Yv;var kn=function(r){return function(e){return r(e)()}};var Di=function(r){return function(e){return function(){return r(e)}}};var pg=function(t){var r=U(_c(t));return{append:function(e){return function(n){return kn(function(u){return r(Di(e)(u))(Di(n)(u))})}}}};var es=function(t){var r=V(vn(t)),e=pg(t.Semigroup0());return{mempty:kn(function(n){return r}),Semigroup0:function(){return e}}};var Su=function(t){return t.keepLatest};function Zc(t){return function(r){return t===r}}var ns=Zc;var is=function(t,r,e){var n=0,u;return function(f){if(n===2)return u;if(n===1)throw new ReferenceError(t+" was needed before it finished initializing (module "+r+", line "+f+")",r,f);return n=1,u=e(),n=2,u}},os=On(Zr),qo=os(Nn),$u=I(Zr),Te=cu(fu),vg=vn(_n),yi=jt($),sg=U(Sr),fs=V(es(_n)),bg=V(Jv(Wo)),mg=Kv(Wo),Ag=U(Kc(Wo)),kg=os(Xv),Dg=Mt(lo),dg=g($);var yg=function(t){return function(r){return function(e,n){var u=Hr(S.value)(),f=t(e,function(_){return Br(new y(_))(u)()}),p=r(e,function(_){var l=yr(u)();return qo(l)(function(d){return function(){return n(_(d))}})()});return function(){return f(),p()}}}},gg=function(t){return function(r){return function(e,n){var u=Hr(S.value)(),f=t(e,function(_){var l=yr(u)();return qo(l)(function(d){return function(){return n(d(_))}})()}),p=r(e,function(_){return Br(new y(_))(u)()});return function(){return f(),p()}}}},Cu=function(t){var r=br(t)(vg);return function(e){return function(n,u){var f=Te(pu)();return r(function(p){return function(){var l=p(n,u);return yi(Te(Rn(l)(f)))()}})(e)(),function(){var _=Te(Ao(f))();return o_(_)}}}},us=function(t){var r=la(t),e=du(t);return function(){var u=Hr(Ge)();return{event:function(f){return function(p,_){return yi(_o(r(function(l){if(l instanceof S)return new y([_]);if(l instanceof y)return new y(sg(l.value0)([_]));throw new Error("Failed pattern match at FRP.Event (line 568, column 17 - line 570, column 51): "+[l.constructor.name])})(f))(u))(),yi(_o(r(function(l){if(l instanceof S)return S.value;if(l instanceof y)return new y(Wc(ns)(_)(l.value0));throw new Error("Failed pattern match at FRP.Event (line 577, column 17 - line 579, column 65): "+[l.constructor.name])})(f))(u))}},push:function(f){var p=yr(u)(),_=e(f.address)(p);if(_ instanceof S)return void 0;if(_ instanceof y)return co(_.value0,function(l){return l(f.payload)});throw new Error("Failed pattern match at FRP.Event (line 586, column 9 - line 588, column 95): "+[_.constructor.name])}}}},Sg=function(t){return function(r,e){var n=Hr($u(void 0))(),u=t(r,function(f){var p=yr(n)();p();var _=f(r,e);return Br(_)(n)()});return function(){var p=yr(n)();return p(),u()}}},Ht={map:function(t){return function(r){return function(e,n){return r(e,function(u){return n(t(u))})}}}},$g=g(Ht),di=function(t){return function(r){return function(e,n){return r(e,function(u){var f=t(u);if(f instanceof y)return n(f.value0);if(f instanceof S)return void 0;throw new Error("Failed pattern match at FRP.Event (line 225, column 31 - line 227, column 35): "+[f.constructor.name])})}}},tp=function(t){return di(function(r){var e=t(r);if(e)return new y(r);if(!e)return S.value;throw new Error("Failed pattern match at FRP.Event (line 141, column 13 - line 143, column 25): "+[e.constructor.name])})},Ho=function(){var r=tc(),e=Hr(0)();return{event:function(n,u){var f=Hr(u)(),p=yr(e)();return rc(p,f,r),ni(function(_){return _+1|0})(e)(),function(){return Br(fs)(f)(),ec(p,r),void 0}},push:function(n){return Zf(r,function(u){var f=yr(u)();return f(n)})}}},Cg=function(t){return function(r,e){var n=Ho(),u=t(n.event),f=n.event(r,e),p=u(r,n.push);return function(){return p(),f()}}},hg={compact:di(dt(yt)),separate:function(t){return{left:di(function(r){if(r instanceof Jt)return new y(r.value0);if(r instanceof Kt)return S.value;throw new Error("Failed pattern match at FRP.Event (line 124, column 13 - line 126, column 33): "+[r.constructor.name])})(t),right:di(function(r){if(r instanceof Kt)return new y(r.value0);if(r instanceof Jt)return S.value;throw new Error("Failed pattern match at FRP.Event (line 131, column 13 - line 133, column 32): "+[r.constructor.name])})(t)}}},gi={filter:tp,filterMap:di,partition:function(t){return function(r){return{yes:tp(t)(r),no:tp(function(e){return!t(e)})(r)}}},partitionMap:function(t){return function(r){return{left:gu(gi)(function(){var e=iu(y.create)(h(S.value));return function(n){return e(t(n))}}())(r),right:gu(gi)(function(e){return cc(t(e))})(r)}}},Compactable0:function(){return hg},Functor1:function(){return Ht}},Fg=function(t){return function(r){return function(e,n){var u=Hr(S.value)(),f=Te(pu)(),p=Hr(S.value)(),_=Te(pu)(),l=Hr(!0)(),d=t(e,function(w){var nt=yr(l)();if(nt)return yi(Te(Rn(w)(f)))();Br(new y(w))(u)();var J=yr(p)();return qo(J)(function(ct){return function(){return n(ct(w))}})()}),L=r(e,function(w){var nt=yr(l)();if(nt)return yi(Te(Rn(w)(_)))();Br(new y(w))(p)();var J=yr(u)();return qo(J)(function(ct){return function(){return n(w(ct))}})()});Br(!1)(l)();var P=Te(Ao(f))(),T=Te(Ao(_))();return function(){return P.length===0?Br(Nc(T))(p)():co(P,function(w){return Br(new y(w))(u)(),co(T,function(nt){return Br(new y(nt))(p)(),n(nt(w))})})}(),Te(yc(0)(qe(P))([])(f))(),Te(yc(0)(qe(T))([])(_))(),function(){return d(),L()}}}},Si=function(t){return function(r){return r}(ep(345).subscribe)(t)},ep=is("backdoor","FRP.Event",function(){var t=function(){var e=tc(),n=Hr(0)();return{event:function(u,f){var p=Hr(f)(),_=yr(n)();return rc(_,p,e),ni(function(l){return l+1|0})(n)(),function(){return Br(fs)(p)(),ec(_,e),void 0}},push:function(u){return function(){return Zf(e,function(f){var p=yr(f)();return p(u)})}}}};return{createO:Ho,makeEvent:function(){var r=function(e){return function(n,u){return n?$u(void 0):e(function(f){return function(){return u(f)}})()}};return r}(),makeEventO:function(){var r=function(e){return function(n,u){return n?$u(void 0):e(u)}};return r}(),makePureEvent:function(){var r=function(e){return function(n,u){return e(function(f){return function(){return u(f)}})()}};return r}(),makeLemmingEvent:function(){var r=function(e){return function(n,u){var f=function(p){return function(_){return function(){return p(n,kn(_))}}};return e(f)(function(p){return function(){return u(p)}})()}};return r}(),makeLemmingEventO:function(){var r=function(e){return function(n,u){var f=function(p,_){return p(n,_)};return e(f,u)}};return r}(),create:t,createPure:t,createPureO:Ho,subscribe:function(){var r=function(e){return function(n){return function(){return e(!1,kn(n))}}};return r}(),subscribeO:function(){var r=function(e,n){return e(!1,n)};return r}(),subscribePureO:function(){var r=function(e,n){return e(!0,n)};return r}(),subscribePure:function(){var r=function(){var e=function(n){return function(u){return function(){return n(!0,kn(u))}}};return e}();return r}(),bus:function(){var r=function(e){return function(n,u){var f=as(819)();return u(e(f.push)(f.event)),$u(void 0)}};return r}(),memoize:function(){var r=function(e){return function(n){return function(u,f){var p=Ho();return f(n(p.event)),e(u,p.push)}}};return r}(),hot:function(){var r=function(e){return function(){var u=as(837)(),f=Si(e)(u.push)();return{event:u.event,unsubscribe:f}}};return r}(),mailbox:function(){var r=function(e){return function(){var u=us(e)();return{event:u.event,push:function(f){return function(){return u.push(f)}}}}};return r}(),mailboxed:function(){var r=function(e){var n=us(e);return function(u){return function(f){return function(p,_){var l=n();return _(f(l.event)),u(p,l.push)}}}};return r}(),delay:function(){var r=function(e){return function(n){return function(u,f){var p=Hr(bg)(),_=n(u,function(l){var d=Hr(S.value)(),L=Zv(e)(function(){f(l);var T=yr(d)();return rr($u(void 0))(function(w){return ni(mg(w))(p)})(T)()})();return Br(new y(L))(d)(),ni(Ag(Vv(L)))(p)()});return function(){var d=yr(p)();return kg(d)(ts)(),_()}}}};return r}()}}),as=is("create","FRP.Event",function(){return function(){return void 0,function(r){return r}(ep(461).create)()}}),$i=ep(678);var np=function(t){return function(r){return r}($i.bus)(t)};var _a=function(t){return function(r){return r}($i.makeEvent)(t)};var up=function(t){return function(r){return r}($i.makeLemmingEvent)(t)},ze=function(t){return function(r){return r}($i.makeLemmingEventO)(t)};var Go=function(t){return function(r){return r}($i.memoize)(t)};var cs={apply:function(t){return function(r){return Fg(t)($g(Ka)(r))}},Functor0:function(){return Ht}},Tg=mr(cs),xg=function(t){return{append:Tg(U(t))}},or={pure:function(t){return function(r,e){return e(t),$u(void 0)}},Apply0:function(){return cs}},Mg=I(or);var zo=function(t){var r=xg(t.Semigroup0());return{mempty:Mg(V(t)),Semigroup0:function(){return r}}};var te={alt:function(t){return function(r){return function(e,n){return Dg(dg(function(u){return function(f){return function(){return u(),f()}}})(function(){return t(e,n)}))(function(){return r(e,n)})()}}},Functor0:function(){return Ht}};var Ve={empty:function(t,r){return $u(void 0)},Alt0:function(){return te}},Eg={Applicative0:function(){return or},Plus1:function(){return Ve}},va={keepLatest:Sg,sampleOnRight:yg,sampleOnLeft:gg,fix:Cg,Alternative0:function(){return Eg},Filterable1:function(){return gi}};var ip=function(t){var r=Or(t);return function(){return function(e){return function(n){return Le(r(e))(n)}}}};var xe=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),sa=function(){function t(){}return t.value=new t,t}();var op=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),fp=function(){function t(){}return t.value=new t,t}(),cp=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),_s=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),pp=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),hu=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),re=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}();var Hn={eq:function(t){return function(r){return t instanceof xe&&r instanceof xe?t.value0===r.value0:t instanceof sa&&r instanceof sa}}};var lp=function(t){return new pp(t)},ba=function(t){return new hu(t)};var Rg=function(){function t(p){this.fn=p}var r={},e=function(p,_){this.head=p,this.tail=_};function n(p){return new e(p,r)}function u(p){return function(_){return new e(p,_)}}function f(p){for(var _=[],l=p;l!==r;)_.push(l.head),l=l.tail;return _}return function(p,_,l){var d=function(P,T){return p(_(u)(l(P)))(T)},L=function(P,T,w){if(T===0)return P;var nt=w[T-1];return new t(function(){var J=L(d(nt,P),T-1,w);return J})};return function(P){for(var T=_(n)(l(P[P.length-1])),w=L(T,P.length-1,P);w instanceof t;)w=w.fn();return _(f)(w)}}}();var ma=function(t){return t.reflectType};function ds(t){return function(){var r={};for(var e in t)hasOwnProperty.call(t,e)&&(r[e]=t[e]);return r}}var Aa={};function sp(t){return t()}function ys(t){return function(r){return function(e){return function(n){var u=e;function f(_){return function(l){return r(l)(_)(n[_])}}for(var p in n)hasOwnProperty.call(n,p)&&(u=t(u)(f(p)));return u}}}}function Qo(t){return function(r){var e=[];for(var n in r)hasOwnProperty.call(r,n)&&e.push(t(n)(r[n]));return e}}var uS=Object.keys||Qo(function(t){return function(){return t}});function bp(t){return function(r){return function(e){return function(){return e[t]=r,e}}}}var mp=function(t){return function(r){return function(){return delete r[t],r}}};var lS=ir(ht);var _S=Qo(function(t){return function(r){return r}});var vS=ds;var gs=function(t){return function(r){return sp(function(){var n=vS(r)();return t(n)(),n})}};var ka=function(t){return function(r){return gs(bp(t)(r))}};var Ss=ys(Ka),sS=function(t){var r=U(t.Semigroup0()),e=V(t);return function(n){return Ss(function(u){return function(f){return function(p){return r(u)(n(f)(p))}}})(e)}},$s={foldl:function(t){return Ss(function(r){return function(e){return t(r)}})},foldr:function(t){return function(r){return function(e){return lS(t)(r)(_S(e))}}},foldMap:function(t){var r=sS(t);return function(e){return r(h(e))}}};var Ap=function(t){return gs(mp(t))};var dS=Su(va),yS=g(Ht),gS=Cu(ht);var SS=ut(ui);var Da=I($r),$S=g(pe);var Ts=On($r),CS=Ts(Nn);var Xe=jt(pe);var hS=Ts(ht);var FS=g(Vt),hs=U(Ac(po)),TS=ua($r)(ht),xS=U(Sr),MS=er($s),ES=on(vo),Fs=function(){function t(){}return t.value=new t,t}(),kp=function(){function t(){}return t.value=new t,t}(),wS=function(){function t(){}return t.value=new t,t}();var Me=function(t){return function(r){return function(e){var n=function(u){return u(r)(e)};return function(u){if(u instanceof pp)return gS(FS(Me(t)(r)(e))(u.value0));if(u instanceof hu)return dS(yS(Me(t)(r)(e))(u.value0));if(u instanceof re)return n(t.toElt(u.value0));if(u instanceof _s)return ze(function(f,p){var _=Ur(Aa)(),l=f(u.value0,function(d){var L=t.ids(e)(),P=Ur(Da(void 0))(),T=t.ids(e)(),w=Ur(Da(void 0))(),nt=Ur([])(),J=Ur(Da(void 0))(),ct=$S(xe.create)(function(){if(r.scope instanceof sa)return t.ids(e);if(r.scope instanceof xe)return hs(Da(r.scope.value0))(hs(Da("!"))(t.ids(e)));throw new Error("Failed pattern match at Bolson.Control (line 547, column 17 - line 549, column 67): "+[r.scope.constructor.name])}())(),_t=Ur(Fs.value)(),Pt=f(d,function(jr){var K=kr(_t)();if(jr instanceof cp&&K instanceof kp){var Jr=kr(nt)();return TS(function(un){return function(){return p(t.doLogic(jr.value0)(e)(un))}})(Jr)()}if(jr instanceof fp&&K instanceof kp){Xe(ie(wS.value)(_t))();var Vu=function(){var Qn=kr(nt)();hS(Qn)(function(Tn){return CS(r.parent)(function(Rr){return function(){return p(t.disconnectElement(e)({id:Tn,parent:Rr,scope:ct}))}})})();var Fn=kr(P)();Fn();var Xf=kr(w)();return Xf(),Xe(He(Ap(L))(_))(),Xe(He(Ap(T))(_))()};return Xe(ie(Vu)(J))(),Vu()}if(jr instanceof op&&K instanceof Fs){Xe(ie(kp.value)(_t))();var eo=f(Me(t)(function(){var un={};for(var Qn in r)({}).hasOwnProperty.call(r,Qn)&&(un[Qn]=r[Qn]);return un.scope=ct,un.raiseId=function(Fn){return Xe(He(xS([Fn]))(nt))},un}())(e)(jr.value0),p);return Xe(He(ka(T)(eo))(_))(),Xe(ie(eo)(w))()}return void 0});Xe(ie(Pt)(P))(),Xe(He(ka(L)(Pt))(_))();var zr=kr(J)();return zr()});return function(){return SS(kr(_))(MS(ES)(Da(void 0)))(),l()}});throw new Error("Failed pattern match at Bolson.Control (line 520, column 17 - line 610, column 20): "+[u.constructor.name])}}}};var Yo=function(){function t(r,e){this.value0=r,this.value1=e}return t.create=function(r){return function(e){return new t(r,e)}},t}();var Dp=function(t){var r=!1,e;function n(u){if(u.value0 instanceof St&&u.value1 instanceof St)return r=!0,S.value;if(u.value0 instanceof St){t=new Yo(qc(u.value1),St.value);return}if(u.value0 instanceof lt)return r=!0,new y(new x(u.value0.value0,new Yo(u.value0.value1,u.value1)));throw new Error("Failed pattern match at Data.CatQueue (line 82, column 1 - line 82, column 63): "+[u.constructor.name])}for(;!r;)e=n(t);return e},dp=function(t){return function(r){return new Yo(t.value0,new lt(r,t.value1))}};var xs=function(t){return t.value0 instanceof St&&t.value1 instanceof St};var yp=function(){return new Yo(St.value,St.value)}();var da=function(){function t(){}return t.value=new t,t}(),Zo=function(){function t(r,e){this.value0=r,this.value1=e}return t.create=function(r){return function(e){return new t(r,e)}},t}();var Es=function(t){return function(r){if(t instanceof da)return r;if(r instanceof da)return t;if(t instanceof Zo)return new Zo(t.value0,dp(t.value1)(r));throw new Error("Failed pattern match at Data.CatList (line 108, column 1 - line 108, column 54): "+[t.constructor.name,r.constructor.name])}},LS=function(t){return function(r){return function(e){var n=function(f){return function(p){return function(_){var l=f,d=p,L=!1,P;function T(w,nt,J){if(J instanceof St)return L=!0,nt;if(J instanceof lt){l=w,d=w(nt)(J.value0),_=J.value1;return}throw new Error("Failed pattern match at Data.CatList (line 124, column 3 - line 124, column 59): "+[w.constructor.name,nt.constructor.name,J.constructor.name])}for(;!L;)P=T(l,d,_);return P}}},u=function(f){return function(p){var _=f,l=!1,d;function L(P,T){var w=Dp(P);if(w instanceof S)return l=!0,n(function(nt){return function(J){return J(nt)}})(r)(T);if(w instanceof y){_=w.value0.value1,p=new lt(t(w.value0.value0),T);return}throw new Error("Failed pattern match at Data.CatList (line 120, column 14 - line 122, column 67): "+[w.constructor.name])}for(;!l;)d=L(_,p);return d}};return u(e)(St.value)}}},ws=function(t){if(t instanceof da)return S.value;if(t instanceof Zo)return new y(new x(t.value0,function(){var r=xs(t.value1);return r?da.value:LS(Es)(da.value)(t.value1)}()));throw new Error("Failed pattern match at Data.CatList (line 99, column 1 - line 99, column 61): "+[t.constructor.name])};var Is=function(){return da.value}(),Ps=Es;var Ls={append:Ps};var Rs=function(t){return function(r){return Ps(t)(new Zo(r,yp))}};var OS=function(t,r,e){var n=0,u;return function(f){if(n===2)return u;if(n===1)throw new ReferenceError(t+" was needed before it finished initializing (module "+r+", line "+f+")",r,f);return n=1,u=e(),n=2,u}},NS=U(Ls);var gp=function(){function t(r,e){this.value0=r,this.value1=e}return t.create=function(r){return function(e){return new t(r,e)}},t}(),tf=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),Fi=function(){function t(r,e){this.value0=r,this.value1=e}return t.create=function(r){return function(e){return new t(r,e)}},t}(),US=function(t){var r=!1,e;function n(u){var f=function(l){return l},p=function(l){return function(d){return new gp(l.value0,NS(l.value1)(d))}};if(u.value0 instanceof tf){var _=ws(u.value1);if(_ instanceof S)return r=!0,new tf(u.value0.value0);if(_ instanceof y){t=p(f(_.value0.value0)(u.value0.value0))(_.value0.value1);return}throw new Error("Failed pattern match at Control.Monad.Free (line 227, column 7 - line 231, column 64): "+[_.constructor.name])}if(u.value0 instanceof Fi)return r=!0,new Fi(u.value0.value0,function(l){return p(u.value0.value1(l))(u.value1)});throw new Error("Failed pattern match at Control.Monad.Free (line 225, column 3 - line 233, column 56): "+[u.value0.constructor.name])}for(;!r;)e=n(t);return e};var WS=function(t){return function(r){return function(e){var n=US(e);if(n instanceof tf)return r(n.value0);if(n instanceof Fi)return t(n.value0)(n.value1);throw new Error("Failed pattern match at Control.Monad.Free (line 213, column 17 - line 215, column 20): "+[n.constructor.name])}}},Os=function(t){var r=g(t);return WS(function(e){return function(n){return new Jt(r(n)(e))}})(Kt.create)},Sp=function(t){return new gp(t,Is)},Ns=function(t){return Sp(new Fi(t,N))};var BS={Applicative0:function(){return $p},Bind1:function(){return rf}},HS={map:function(t){return function(r){return En(rf)(function(){var e=I($p);return function(n){return e(t(n))}}())(r)}}},rf={bind:function(t){return function(r){return new gp(t.value0,Rs(t.value1)(r))}},Apply0:function(){return Us(0)}},$p={pure:function(t){return Sp(tf.create(t))},Apply0:function(){return Us(0)}},Us=OS("freeApply","Control.Monad.Free",function(){return{apply:oe(BS),Functor0:function(){return HS}}});var qS=I($p);var Pr=function(t){return Sp(new Fi(t,function(r){return qS(r)}))};var GS=dt(yt);var ya={dimap:function(t){return function(r){return function(e){return function(n){return r(e(t(n)))}}}}},Hs=function(t){return t.dimap},ga=function(t){var r=Hs(t);return function(e){return r(e)(GS)}};var zS=I(or);var VS=function(t){return t},Dn=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),Ti=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),nf=function(){function t(){}return t.value=new t,t}(),XS=function(t){return t};var uf=Ar(),a=XS,af=function(t){return function(r){return a({key:"data-"+t,value:new Dn(r)})}};var c=function(){return Dn.create}();var M=function(){return Ti.create}(),Cp=function(){var t=g(Qr)(g($)(h(!0)));return function(r){return VS(t(r))}}(),xi=function(t){return t.attr};var ee=function(t){var r=xi(t);return function(e){return function(n){return zS(r(e)(n))}}};var qs=g(Ht),jS=ga(ya);var JS=Ar();var KS=function(t){return function(r){var e=function(n){var u=function(f){return f instanceof re?new re(jS(function(p){return{pos:t,dynFamily:p.dynFamily,ez:p.ez,parent:p.parent,raiseId:p.raiseId,scope:p.scope}})(f.value0)):f instanceof hu?new hu(qs(u)(f.value0)):f};return u(n)};return e(r)}},Gs=function(t){return KS(y.create(t))};var zs=function(t){return np(t)};var QS=function(t){var r=function(n){return new hu(JS(n))},e=zs(t);return r(qs(function(n){return n})(e))},Vs=function(t){return QS(ra(t))};var Js=g(Ht);var hp=Cu(ht),Sa=I(or),Ks=v(Ve),Qs=I($r);var t$=Ar(),r$=qr(),e$=j(Hn),Ys=zt(te),n$=U(Sr),u$=bn(Un),js=g(Qr);var a$=function(t){return function(r){return function(e){return Js(function(n){return t.setText(function(u){return{id:r,text:u}}(n))})(e)}}},i$=function(t){return function(r){return function(e){return Js(function(n){return function(u){if(u.value instanceof Dn)return t.setProp({id:r,key:u.key,value:u.value.value0});if(u.value instanceof Ti)return t.setCb({id:r,key:u.key,value:u.value.value0});if(u.value instanceof nf)return t.unsetAttribute({id:r,key:u.key});throw new Error("Failed pattern match at Deku.Control (line 72, column 28 - line 75, column 47): "+[u.value.constructor.name])}(uf(n))})(e)}}};var o$=function(t){var r=function(n){return function(u){return ze(function(f,p){var _=u.ids();n.raiseId(_)();var l=f(hp([Sa(u.makeText({id:_,parent:n.parent,pos:n.pos,scope:n.scope,dynFamily:n.dynFamily})),a$(u)(_)(t),rr(Ks)(function(d){return Sa(u.attributeParent({id:_,parent:d,pos:n.pos,dynFamily:n.dynFamily,ez:n.ez}))})(n.parent)]),p);return function(){return p(u.deleteFromCache({id:_})),l()}})}},e=new re(r);return e},A=function(t){return o$(Sa(t))};var f$=function(){return{doLogic:function(t){return function(r){return function(e){return r.sendToPos({id:e,pos:t})}}},ids:function(t){return function(r){return r.ids}(r$(t))},disconnectElement:function(t){return function(r){return t.disconnectElement({id:r.id,scope:r.scope,parent:r.parent,scopeEq:e$})}},toElt:function(t){return t}}},c$=f$();var Zs=function(t){return function(r){return function(e){return Me(c$)(t)(r)(e)}}},tb=function(t){return function(r){var e=function(n){return function(u){return ze(function(f,p){return f(Ys(Sa(u.makeRoot({id:"deku-root",root:t})))(Zs({parent:new y("deku-root"),scope:new xe("rootScope"),raiseId:function(_){return Qs(void 0)},ez:!0,pos:S.value,dynFamily:S.value})(u)(n)),p)})}};return e(r)}},p$=function(t){return function(r){return function(e){var n=function(u){return function(f){return ze(function(p,_){var l=f.ids();u.raiseId(l)();var d=p(Ys(hp(n$([Sa(f.makeElement({id:l,parent:u.parent,scope:u.scope,tag:t,pos:u.pos,dynFamily:u.dynFamily})),i$(f)(l)(r)])(rr([])(function(L){return[Sa(f.attributeParent({id:l,parent:L,pos:u.pos,dynFamily:u.dynFamily,ez:u.ez}))]})(u.parent))))(Zs({parent:new y(l),scope:u.scope,ez:!0,raiseId:function(L){return Qs(void 0)},pos:S.value,dynFamily:S.value})(f)(e)),_);return function(){return _(f.deleteFromCache({id:l})),d()}})}};return n}}},k=function(t){return function(r){return function(e){var n=function(f){return f.length===0?Ks:f.length===1?f[0]:hp(f)},u=function(f){return new re(p$(t)(n(r))(lp(t$(f))))};return u(u$(js(js(function(f){return f}))(Gs))(e))}}};var rb=t=>r=>e=>()=>{if(e.units[r.id]){let n=e.units[r.parent].main;e.units[r.id].main&&e.units[r.id].main.parentNode||e.units[r.id].startBeacon&&e.units[r.id].startBeacon.parentNode||(r.ez?(()=>(e.units[r.id].main?n.appendChild(e.units[r.id].main):(n.appendChild(e.units[r.id].startBeacon),n.appendChild(e.units[r.id].endBeacon)),!0))():t(r.pos)(f=>()=>t(r.dynFamily)(p=>()=>{for(var _=0,l=0,d;l<n.childNodes.length;){if(n.childNodes[l].nodeType===8&&n.childNodes[l].nodeValue==="%-%"+p){l+=1;break}l++}let L=T=>{let w=n.childNodes[T];e.units[r.id].startBeacon?(n.insertBefore(e.units[r.id].startBeacon,w),n.insertBefore(e.units[r.id].endBeacon,w)):n.insertBefore(e.units[r.id].main,w)};for(;l<n.childNodes.length;){var P;if((P=n.childNodes[l].$dekuId)&&t(e.units[P].dynFamily)(w=>()=>t(e.units[P].pos)(J=>()=>p===w&&f<=J?(L(l),!0):!1)())())return!0;if(_===f||n.childNodes[l].nodeType===8&&n.childNodes[l].nodeValue==="%-%"+p+"%-%")return L(l),!0;n.childNodes[l].nodeType===8&&n.childNodes[l].nodeValue.substring(0,3)==="%-%"&&!d&&(d=n.childNodes[l].nodeValue+"%-%"),d||_++,n.childNodes[l].nodeType===8&&n.childNodes[l].nodeValue===d&&(d=void 0,_++),l++}return!1})())())||(r.parent.indexOf("@!%")!==-1?t(r.dynFamily)(p=>()=>(e.units[r.id].main?e.units[p].endBeacon.parentNode.insertBefore(e.units[r.id].main,e.units[p].endBeacon):(e.units[p].endBeacon.parentNode.insertBefore(e.units[r.id].endBeacon,e.units[p].endBeacon),e.units[p].endBeacon.parentNode.insertBefore(e.units[r.id].startBeacon,e.units[r.id].endBeacon)),!0))()||(e.units[r.id].main?n.parentNode.replaceChild(e.units[r.id].main,n):(n.parentNode.replaceChild(e.units[r.id].endBeacon,n),e.units[r.id].endBeacon.parentNode.insertBefore(e.units[r.id].startBeacon,e.units[r.id].endBeacon))):t(r.dynFamily)(p=>()=>(e.units[r.id].startBeacon?(n.insertBefore(e.units[r.id].startBeacon,e.units[p].endBeacon),n.insertBefore(e.units[r.id].endBeacon,e.units[p].endBeacon)):n.insertBefore(e.units[r.id].main,e.units[p].endBeacon),!0))()||(e.units[r.id].startBeacon?(n.appendChild(e.units[r.id].startBeacon),n.appendChild(e.units[r.id].endBeacon)):n.appendChild(e.units[r.id].main)))}};var eb=t=>r=>e=>n=>()=>{var u,f,p=e.id;if(n.scopes[e.scope]||(n.scopes[e.scope]=[]),n.scopes[e.scope].push(p),!t(e.parent)(()=>()=>n.hydrating&&r&&(u=n.allBeacons[e.id])&&(f=n.allBeacons[`${e.id}%-%`])?(n.units[p]={listeners:{},parent:e.parent,scope:e.scope,pos:e.pos,dynFamily:e.dynFamily,startBeacon:u,endBeacon:f},u.$dekuId=p,f.$dekuId=p,!0):!1)()){let l=document.createComment(`%-%${e.id}`),d=document.createComment(`%-%${e.id}%-%`);n.units[p]={listeners:{},parent:e.parent,dynFamily:e.dynFamily,scope:e.scope,pos:e.pos,startBeacon:l,endBeacon:d},l.$dekuId=p,d.$dekuId=p}},l$=new Set(["animate","animateMotion","animateTransform","circle","clipPath","defs","desc","discard","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","foreignObject","g","image","line","linearGradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialGradient","rect","set","stop","svg","switch","symbol","text","textPath","title","tspan","use","view"]);var nb=t=>r=>()=>r.units[t]&&r.units[t].dynFamily?r.units[t].dynFamily:(()=>{throw new Error(`No positional information for ${t}`)})(),ub=t=>r=>()=>r.units[t]&&r.units[t].main&&r.units[t].main.parentNode&&r.units[t].main.parentNode.$dekuId?r.units[t].main.parentNode.$dekuId:r.units[t]&&r.units[t].startBeacon&&r.units[t].startBeacon.parentNode&&r.units[t].startBeacon.parentNode.$dekuId?r.units[t].startBeacon.parentNode.$dekuId:(()=>{throw new Error(`No parent information for ${t}`)})(),Fp=t=>r=>()=>r.units[t]&&r.units[t].scope?r.units[t].scope:(()=>{throw new Error(`No scope information for ${t}`)})(),ab=t=>r=>e=>n=>()=>{var u,f=e.id;if(n.scopes[e.scope]||(n.scopes[e.scope]=[]),n.scopes[e.scope].push(f),!t(e.parent)(()=>()=>n.hydrating&&r&&(u=document.documentElement.querySelector(`[data-deku-ssr="${f}"]`))?(n.units[f]={listeners:{},pos:e.pos,parent:e.parent,scope:e.scope,dynFamily:e.dynFamily,main:u},u.$dekuId=f,!0):!1)()){let _=l$.has(e.tag)?document.createElementNS("http://www.w3.org/2000/svg",e.tag):document.createElement(e.tag);n.units[f]={listeners:{},parent:e.parent,pos:e.pos,scope:e.scope,dynFamily:e.dynFamily,main:_},_.$dekuId=f}},ib=t=>r=>e=>n=>u=>()=>{var f=n.id,p;if(u.scopes[n.scope]||(u.scopes[n.scope]=[]),u.scopes[n.scope].push(f),!t(n.parent)(l=>()=>{if(u.hydrating&&r&&(p=document.documentElement.querySelector(`[data-deku-ssr="${l}"]`))){for(var d=0;d<p.childNodes.length;d++){let T=f.split("@-@");if(p.childNodes[d].nodeType===8&&p.childNodes[d].nodeValue===T[0]){var L=d===0||p.childNodes[d-1].nodeType!==3;L&&d!==0?p.insertBefore(document.createTextNode(""),p.childNodes[d]):L?p.prepend(document.createTextNode("")):d=d-1;break}}let P=p.childNodes[d];return u.units[f]={main:P,pos:n.pos,parent:n.parent,scope:n.scope},P.$dekuId=f,!0}return!1})()){let l=document.createTextNode("");u.units[f]={main:l,parent:n.parent,scope:n.scope,pos:n.pos,dynFamily:n.dynFamily},l.$dekuId=f}};function Tp(){return{units:{},scopes:{},allBeacons:{}}}var ob=t=>r=>e=>()=>{if(e.units[r.id]){var n=r.id,u=r.value;e.hydrating&&t&&!e.units[n]&&(dom=document.documentElement.querySelector(`[data-deku-ssr="${n}"]`))&&(e.units[n]={listeners:{},parent:r.parent,scope:r.scope,main:dom},e.scopes[r.scope]||(e.scopes[r.scope]=[]),e.scopes[r.scope].push(n)),e.units[n].main.tagName==="INPUT"&&r.key==="value"||e.units[n].main.tagName==="TEXTAREA"&&r.key==="value"?e.units[n].main.value=u:e.units[n].main.tagName==="INPUT"&&r.key==="checked"?e.units[n].main.checked=u==="true":r.key==="disabled"?e.units[n].main.disabled=u==="true":e.units[n].main.setAttribute(r.key,u)}},fb=t=>r=>e=>()=>{if(e.units[r.id]){var n=r.id,u=r.value;if(e.hydrating&&t&&!e.units[n]&&(dom=document.documentElement.querySelector(`[data-deku-ssr="${n}"]`))&&(e.units[n]={listeners:{},parent:r.parent,scope:r.scope,main:dom},e.scopes[r.scope]||(e.scopes[r.scope]=[]),e.scopes[r.scope].push(n)),r.key==="@self@")u(e.units[n].main)();else{e.units[n].listeners[r.key]&&e.units[n].main.removeEventListener(r.key,e.units[n].listeners[r.key]);var f=p=>u(p)();e.units[n].main.addEventListener(r.key,f),e.units[n].listeners[r.key]=f}}},cb=t=>r=>e=>()=>{if(e.units[r.id]){var n=r.id;e.hydrating&&t&&!e.units[n]&&(dom=document.documentElement.querySelector(`[data-deku-ssr="${n}"]`))&&(e.units[n]={listeners:{},parent:r.parent,scope:r.scope,main:dom},e.scopes[r.scope]||(e.scopes[r.scope]=[]),e.scopes[r.scope].push(n)),e.units[n].main.removeAttribute(r.key)}},pb=t=>r=>()=>{if(r.units[t.id]){var e=t.id;r.units[e].main.nodeValue=t.text}},lb=t=>r=>e=>n=>u=>()=>{var f,p,_=n.id,l=n.html,d=n.verb,L=n.cache,P=n.parent,T=n.scope,w=n.pxScope;let nt=t(n.parent)(()=>()=>u.hydrating&&r&&(f=document.documentElement.querySelector(`[data-deku-ssr="${_}"]`))?(u.units[_]={listeners:{},pos:n.pos,scope:T,parent:P,main:f},f.$dekuId=_,!0):!1)();if(!nt){let ct=Object.entries(L);for(var J=0;J<ct.length;J++){let _t=ct[J][0];ct[J][1]===!0?l=l.replace(d+_t+d,'data-deku-attr-internal="'+_t+'"'):l=l.replace(d+_t+d,'<span style="display:contents;" data-deku-elt-internal="'+_t+'"></span>')}p=document.createElement("div"),p.innerHTML=l.trim(),u.units[_]={listeners:{},pos:n.pos,scope:T,parent:P,main:p.firstChild},p.firstChild.$dekuId=_}u.scopes[T]||(u.scopes[T]=[]),u.scopes[T].push(_),p||(p=f),p.querySelectorAll("[data-deku-attr-internal]").forEach(function(ct){var _t=ct.getAttribute("data-deku-attr-internal");let Pt=_t+"@!%"+w;u.units[Pt]={listeners:{},main:ct,scope:T},u.scopes[T].push(Pt)}),p.querySelectorAll("[data-deku-elt-internal]").forEach(function(ct){var _t=ct.getAttribute("data-deku-elt-internal");let Pt=_t+"@!%"+w;u.units[_t+"@!%"+w]={listeners:{},main:ct,scope:T},u.scopes[T].push(Pt)}),nt||u.units[_].main.remove()},_b=t=>r=>()=>{var e=t.id;r.units[e]={main:t.root},t.root.$dekuId=e},xp=t=>r=>e=>n=>()=>{let u=(nt,J,ct)=>{if(n.units[nt].startBeacon){var _t=n.units[nt].startBeacon,Pt=_t.nextSibling;for(n.units[J].main.insertBefore(_t,ct),_t=Pt;_t&&_t!==n.units[nt].endBeacon;)Pt=_t.nextSibling,n.units[J].main.insertBefore(_t,ct),_t=Pt}else n.units[J].main.insertBefore(n.units[nt].main,ct)},f=[];f.push(e);for(var p=0;p<f.length;p++){let nt=f[p],J=nt.id,ct=nt.parent;n.units[J].containingScope=nt.scope;var _=void 0;r(nt.pos)(Pt=>()=>(_=Pt,!0))(),_===void 0&&(_=Number.MAX_VALUE);let _t=n.units[ct].main.childNodes;for(var l=0,d=!1,L=0;l<_t.length;){var P;if(P=_t[l].$dekuId){if(r(nt.dynFamily)(zr=>()=>d?!1:n.units[P].endBeacon===_t[l]&&zr===P?(n.units[J].pos=t(L),u(J,ct,_t[l]),!0):!1)()){d=!0;break}if(n.units[P].dynFamily!==n.units[J].dynFamily){l++;continue}if(d){l++;continue}L===_?(u(J,ct,_t[l]),L++,d=!0):n.units[P].endBeacon!==_t[l]&&(n.units[P].pos=t(L),L++)}l++}if(d)return;if(n.units[J].main)n.units[ct].main.appendChild(n.units[J].main);else{var T=n.units[J].startBeacon,w=T.nextSibling;for(n.units[ct].main.appendChild(T),T=w;T&&T!==n.units[J].endBeacon;)w=T.nextSibling,n.units[ct].main.appendChild(T),T=w}}},vb=t=>r=>()=>{if(r.units[t.id]){var e=t.id;if(r.units[e].containingScope&&!t.scopeEq(r.units[e].containingScope)(t.scope))return;if(r.units[e].main)r.units[e].main.remove();else{let f=document.createElement("div");var n=r.units[e].startBeacon,u=n.nextSibling;for(f.appendChild(n),n=u;n&&n!==r.units[e].endBeacon;)u=n.nextSibling,f.appendChild(n),n=u;n===r.units[e].endBeacon&&f.appendChild(n)}}},sb=t=>r=>()=>r.units[t]!==void 0,Mp=t=>r=>()=>{r.units[t.id]&&delete r.units[t.id]},bb=Mp;function mb(t,r){return r.includes(t)}var QR=typeof Array.from=="function",YR=typeof Symbol<"u"&&Symbol!=null&&typeof Symbol.iterator<"u"&&typeof String.prototype[Symbol.iterator]=="function",ZR=typeof String.prototype.fromCodePoint=="function",tO=typeof String.prototype.codePointAt=="function";var dn=function(t){var r=I(t.Applicative0()),e=v(t.Plus1());return function(n){if(n)return r(void 0);if(!n)return e;throw new Error("Failed pattern match at Control.Alternative (line 48, column 1 - line 48, column 54): "+[n.constructor.name])}};var m$=fe(uu),A$=se(uu),k$=ut(Er),D$=E(nr),d$=dn(Pn);var y$=function(t){return t.succ};var g$=function(t){return t.pred};var kb={succ:function(t){var r=t<m$;return r?new y(t+1|0):S.value},pred:function(t){var r=t>A$;return r?new y(t-1|0):S.value},Ord0:function(){return Gt}},Ep=function(t){var r=t.Ord0(),e=j(r.Eq0()),n=Qf(r),u=y$(t),f=Yf(r),p=g$(t),_=i_(r);return function(l){var d=Rc(l),L=si(l),P=function(T){return function(w){return function(nt){return function(J){return new x(J,k$(T(J))(function(ct){return D$(d$(w(ct)(nt)))(ct)}))}}}};return function(T){return function(w){if(e(T)(w))return d(T);if(n(T)(w))return L(P(u)(f)(w))(T);if(vr)return L(P(p)(_)(w))(T);throw new Error("Failed pattern match at Data.Enum (line 186, column 14 - line 190, column 51): "+[T.constructor.name,w.constructor.name])}}}};var Db=function(t){return function(r){return function(e){return(e|0)===e?t(e):r}}},ar=function(t){return t};var of=isFinite;var wp=function(t){return function(r){return Math.atan2(t,r)}};var Ip=Math.cos;var Pp=Math.floor;var Ei=function(t){return function(r){return t%r}};var Lp=Math.sin;var wi=3.141592653589793;var db=fe(uu),yb=se(uu);var Rp=function(){return Db(y.create)(S.value)}(),M$=function(t){if(!of(t))return 0;if(t>=ar(db))return db;if(t<=ar(yb))return yb;if(vr)return Dr(0)(Rp(t));throw new Error("Failed pattern match at Data.Int (line 72, column 1 - line 72, column 29): "+[t.constructor.name])};var $a=function(t){return M$(Pp(t))};var ha=function(t){return t.toLowerCase()};var Pb=function(t){return t()};var Lb=function(t){throw new Error(t)};var Rb=function(){return Lb};var J$=Rb(),K$=Pb,Tu=function(t){return K$(function(){return J$(t)})};var Ob=function(t){return function(r){return mb(t,r)}};var Bp=Math.random;var Hp=function(t){return function(r){return function(){var n=Bp(),u=(ar(r)-ar(t)+1)*n+ar(t);return $a(u)}}};var tC=ce(Yr),rC=dr();var Ub=function(t){return t};var eC=1,qp=2147483647,nC=function(){return qp-1|0}(),Wb=function(t){var r=function(e){return function(n){return function(u){var f=n-e|0,p=tC(u)(f),_=p<e;return _?p+n|0:p}}};return r(eC)(nC)(t)};var uC=0,aC=48271,Bb=function(t){return function(r){return rC(Rp(Ei(ar(aC)*ar(r)+ar(t))(ar(qp))))}},Hb=Bb(uC);var yn=function(t){return t.state};var Af=function(t){var r=g(t);return{map:function(e){return function(n){return function(u){return r(function(f){return new x(e(f.value0),f.value1)})(n(u))}}}}};var Xp=function(t){return{Applicative0:function(){return Jp(t)},Bind1:function(){return jp(t)}}},jp=function(t){var r=ut(t.Bind1());return{bind:function(e){return function(n){return function(u){return r(e(u))(function(f){var p=n(f.value0);return p(f.value1)})}}},Apply0:function(){return kf(t)}}},kf=function(t){var r=Af(t.Bind1().Apply0().Functor0());return{apply:oe(Xp(t)),Functor0:function(){return r}}},Jp=function(t){var r=I(t.Applicative0());return{pure:function(e){return function(n){return r(new x(e,n))}},Apply0:function(){return kf(t)}}};var Kp=function(t){var r=I(t.Applicative0()),e=Xp(t);return{state:function(n){return function(u){return r(n(u))}},Monad0:function(){return e}}};var Zb=function(t){return function(r){var e=t(r);return e.value0}};var FC=Kp(ri),TC=yn(FC);var xC=Af(ou);var MC=ae(Ja);var EC=Nr(Ja);var wC=function(t){return t};var IC=function(){var t=function(r){return new x(Ub(r.newSeed),function(){var e={};for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e.newSeed=Hb(r.newSeed),e}())};return TC(t)}();var em=xC,Df=g(em);var nm=function(t){return Zb(wC(t))};var um=kf(ri),PC=Mt(um),rm=function(t){return function(r){var e=ar(r),n=ar(t),u=function(_){return n+Ei(_)(e-n+1)},f=Df(ar)(IC),p=PC(Df(EC)(f))(Df(MC(2))(f));return Df(function(_){return $a(u(_))})(p)}},am=function(t){return function(r){var e=t<=r;return e?rm(t)(r):rm(r)(t)}};var fm=function(t){return t.arbitrary};var cm=function(){return{arbitrary:am(-1e6)(1e6)}}();var pm=g(Ht),UC=g(Qr),WC=g($),BC=jt(pe);var HC=ft(In),qC=fm(cm),GC=Nr(tu);var df=I(Zr),zC=V(Ln(O_(_n))),VC=v(Ve),lm=Ar(),XC=qr(),jC=j(Hn),JC=Ju(rf),Gr=I(or);var ne=function(t){return t},_m={map:function(t){return function(r){return pm(UC(WC(t)))(r)}}};var wu=function(t){return function(r){return t instanceof y?r(t.value0):df(!1)}},KC=function(t){return function(r){return function(){var n=Fp(t.id)(r)(),u=ub(t.id)(r)(),f=nb(t.id)(r)(),p={scope:n,parent:u,dynFamily:f,id:t.id,pos:new y(t.pos),ez:!1,raiseId:zC,ctor:ba(VC)};return lm(xp(y.create)(wu)(p))(r)()}}},QC=function(t){return function(r){return function(e){return Me({doLogic:function(n){return function(u){return function(f){return u.sendToPos({id:f,pos:n})}}},ids:function(n){return function(u){return u.ids}(XC(n))},disconnectElement:function(n){return function(u){return n.disconnectElement({id:u.id,scope:u.scope,parent:u.parent,scopeEq:jC})}},toElt:function(n){return n}})(t)(r)(lm(e))}}},YC=function(t){return function(r){return function(e){return function(n){return JC(Pr(Gr(function(u){var f=function(){var _=pm(function(l){return function(d){return df(l)}})(QC({dynFamily:n.dynFamily,ez:n.ez,parent:new y(n.parent),pos:n.pos,raiseId:n.raiseId,scope:n.scope})(t)(n.ctor));return df(Ns(_))}(),p=df(Pr(Gr(xp(r)(e)(n))));return function(){var l=sb(n.id)(u)();if(l){var d=Fp(n.id)(u)();if(d instanceof sa)return p();if(d instanceof xe&&n.scope instanceof xe){var L=Ob(d.value0)(n.scope.value0);return L?p():f()}return f()}return f()}})))}}}},vm=function(t){var r={ids:function(){var n=kr(t)(),u=HC(nm(qC)({newSeed:Wb(n),size:5}));return BC(He(GC(1))(t))(),u},makeElement:function(){var e=ab(wu)(!1);return function(n){return Pr(ne(Gr(e(n))))}}(),makeDynBeacon:function(){var e=eb(wu)(!1);return function(n){return Pr(ne(Gr(e(n))))}}(),attributeParent:function(){var e=rb(wu);return function(n){return Pr(ne(Gr(e(n))))}}(),makeRoot:function(e){return Pr(ne(Gr(_b(e))))},makeText:function(){var e=ib(wu)(!1)(rr(void 0));return function(n){return Pr(ne(Gr(e(n))))}}(),makePursx:function(){var e=lb(wu)(!1)(rr(void 0));return function(n){return Pr(ne(Gr(e(n))))}}(),setProp:function(){var e=ob(!1);return function(n){return Pr(ne(Gr(e(n))))}}(),setCb:function(){var e=fb(!1);return function(n){return Pr(ne(Gr(e(n))))}}(),unsetAttribute:function(){var e=cb(!1);return function(n){return Pr(ne(Gr(e(n))))}}(),setText:function(e){return Pr(ne(Gr(pb(e))))},sendToPos:function(e){return Pr(ne(Gr(KC(e))))},removeDynBeacon:function(e){return Pr(ne(Gr(bb(e))))},deleteFromCache:function(e){return Pr(ne(Gr(Mp(e))))},giveNewParent:function(e){return YC(r)(y.create)(wu)(e)},disconnectElement:function(e){return Pr(ne(Gr(vb(e))))}};return r};var Yp=function(){return window};function bm(t,r,e){return t==null?r:e(t)}var Fr=function(t){return bm(t,S.value,y.create)};function mm(t){return t.body}var vh=g($);var Am=function(t){return vh(Fr)(function(){return mm(t)})};var km=N;function Zp(t){return function(){return t.document}}var dm=Su(va),ym=g(Ht),Vh=Os(_m),gm=vn(_n),Xh=V(zo(Ln(gm))),jh=I(Zr),tl=ut(ta),Jh=Yt($),Kh=cu(fu),Qh=V(vn(gm)),Yh=g(nr),Zh=jt($);var tF=function(t){var r=function(u){var f=ym(e(u));return function(p){return dm(f(p))}},e=function(u){return function(f){return function(p){if(p instanceof Jt)return dm(ym(n(u))(p.value0));if(p instanceof Kt)return Xh;throw new Error("Failed pattern match at Deku.Toplevel (line 47, column 21 - line 49, column 22): "+[p.constructor.name])}(Vh(f))}},n=function(u){return function(f){return r(u+1|0)(_a(function(p){return function(){return void 0,tl(f(t))(p)(),jh(void 0)}}))}};return r(0)},rF=function(t){return function(r){return function(){var n=Tp(),u=Jh(Kh(Ur(0)))(function(){var f=tb(t)(r);return function(p){return f(vm(p))}}())();return Si(tF(n)(u))(function(f){return f(n)})()}}},Sm=function(t){return function(){var e=tl(tl(Yp)(Zp))(Am)();return rr(Qh)(function(n){return rF(n)(t)})(Yh(km)(e))()}},$m=function(t){return Zh(Sm(t))};var rl=function(){function t(){}return t.value=new t,t}();var Cm={attr:function(t){return function(r){return a({key:"class",value:c(r)})}}};var hm={attr:function(t){return function(r){return a({key:"class",value:c(r)})}}};var Vn={attr:function(t){return function(r){return a({key:"class",value:c(r)})}}};var Fm={attr:function(t){return function(r){return a({key:"class",value:c(r)})}}};var gf=function(){function t(){}return t.value=new t,t}();var Tm={attr:function(t){return function(r){return a({key:"href",value:c(r)})}}};var el=function(){function t(){}return t.value=new t,t}();var Ma={attr:function(t){return function(r){return a({key:"style",value:c(r)})}}};var Mm=Yt(Ht),Em=I(or),Wi=function(t){var r=xi(t);return function(e){return Mm(e)(function(n){return r(el.value)(n)})}},Sf=function(t){var r=Wi(t);return function(e){return r(Em(e))}},ul=function(t){var r=xi(t);return function(e){return Mm(e)(function(n){return r(rl.value)(n)})}},Xn=function(t){var r=ul(t);return function(e){return r(Em(e))}};var aF=Yt(Ht),wm=Ar();var iF={append:function(t){return function(r){if(t==="")return r;if(r==="")return t;if(vr)return t+(" "+r);throw new Error("Failed pattern match at ClassName (line 36, column 1 - line 44, column 13): "+[t.constructor.name,r.constructor.name])}}},oF={mempty:"",Semigroup0:function(){return iF}},fF=br(ht)(zo(oF)),gn=function(t){return function(r){return aF(t)(function(e){return e?r:""})}},Ea=function(t){var r=ul(t),e=fF(wm);return function(n){return r(wm(e(n)))}};var Cf=void 0;var Pm=function(t){return t.toInt},il=function(t){var r=Pm(t);return function(e){return r(Cf)}};var cF={toInt:function(t){return 5}},hf={Nat0:function(){return cF}};var pF={toInt:function(t){return 1}},je={Nat0:function(){return pF}};var lF=function(t){return function(r){return Cf}},Lm=function(t){var r=lF(t);return function(e){var n=Pm(e);return function(u){return function(f){return 10*f|0}(n(r(u)))}}};var Bi=function(t){var r=t.Nat0();return{toInt:function(e){return Lm(Bi(t))(r)(e)+4|0}}};var Rm=function(t){var r=t.Nat0();return{toInt:function(e){return Lm(Rm(t))(r)(e)+8|0}}},Je=function(t){var r=Rm(t);return{Nat0:function(){return r}}};var _F=Ep(kb)(fa),Sn=function(){return vt.value}(),$n=function(t){return il(t)},wa=function(t){var r=$n(t);return function(e){var n=r(e);return _F(0)(n-1|0)}};var vF=Ar();var sF=ce(Yr);var Ia=function(t){return{inhabitants:vF(wa(t.Nat0())(Sn))}};var Om={eq:function(t){return function(r){return t===r}}},Pu=function(t){return t};var Pa=function(t){var r=$n(t.Nat0());return function(e){return sF(e)(r(Sn))}};var jn=function(t){return t.inhabitants};var Nm=ce(Yr),Ff=pn(Yr),bF=ot(Gt),Ke=function(t){return t.invert},Um=function(t){var r=t.Monoid0(),e=U(r.Semigroup0()),n=Ke(t),u=V(r);return function(f){return function(p){var _=function(L){return function(P){return function(T){var w=L,nt=P,J=!1,ct;function _t(Pt,zr,jr){if(Nm(zr)(2)===0){w=e(Pt)(Pt),nt=Ff(zr)(2),T=jr;return}if(zr===1)return J=!0,e(Pt)(jr);if(vr){w=e(Pt)(Pt),nt=Ff(zr)(2),T=e(Pt)(jr);return}throw new Error("Failed pattern match at Data.Group (line 24, column 3 - line 27, column 50): "+[Pt.constructor.name,zr.constructor.name,jr.constructor.name])}for(;!J;)ct=_t(w,nt,T);return ct}}},l=function(L){return function(P){var T=L,w=!1,nt;function J(ct,_t){if(Nm(_t)(2)===0){T=e(ct)(ct),P=Ff(_t)(2);return}if(_t===1)return w=!0,ct;if(vr)return w=!0,_(e(ct)(ct))(Ff(_t)(2))(ct);throw new Error("Failed pattern match at Data.Group (line 19, column 3 - line 22, column 43): "+[ct.constructor.name,_t.constructor.name])}for(;!w;)nt=J(T,P);return nt}},d=bF(p)(0);if(d instanceof bt)return n(l(f)(-p|0));if(d instanceof wt)return u;if(d instanceof kt)return l(f)(p);throw new Error("Failed pattern match at Data.Group (line 14, column 11 - line 17, column 14): "+[d.constructor.name])}}};var Wm=function(t){return{head:t.value0,tail:t.value1}};var mF=function(t){if(t instanceof St)return S.value;if(t instanceof lt)return new y(new Au(t.value0,t.value1));throw new Error("Failed pattern match at Data.List.NonEmpty (line 121, column 1 - line 121, column 57): "+[t.constructor.name])},Bm=function(t){var r=Io(t);return function(e){return mF(r(e))}};var Hm=g(Vt),kF=er(ht),DF=ir(ht),dF=br(ht),yF=du(Gt),qm=Oo(Gt),Gm=qm(ht),gF=qm(le),SF=Io(ht);var $F=function(t){return t},CF=function(t){return t};var hF={foldl:function(t){return function(r){return function(e){return kF(t)(r)(e)}}},foldr:function(t){return function(r){return function(e){return DF(t)(r)(e)}}},foldMap:function(t){var r=dF(t);return function(e){return function(n){return r(e)(n)}}}},Gi=function(t){return function(r){return Dr(r)(yF(r)(t))}};var FF=function(t){var r=wa(t);return{append:function(e){return function(n){var u=function(){var f=Gi(n),p=Gi(e);return function(_){return f(p(_))}}();return Gm(Hm(function(f){return new x(f,u(f))})(r(vt.value)))}}}},TF=function(t){var r=Bm(t);return function(e){var n=r(e);if(n instanceof S)return St.value;if(n instanceof y){var u=Wm(n.value0),f=function(p){return p instanceof lt&&p.value1 instanceof lt?new lt(new x(p.value0,p.value1.value0),f(new lt(p.value1.value0,p.value1.value1))):p instanceof lt&&p.value1 instanceof St?new lt(new x(p.value0,u.head),St.value):St.value};return f(new lt(u.head,u.tail))}throw new Error("Failed pattern match at Data.Permutation (line 90, column 3 - line 99, column 20): "+[n.constructor.name])}},xF=TF(hF),MF=Ge,fl=function(t){var r=FF(t);return{mempty:MF,Semigroup0:function(){return r}}},zm=function(t){var r=wa(t),e=fl(t);return{invert:function(n){return Gm(Hm(function(u){return new x(Gi(n)(u),u)})(r(vt.value)))},Monoid0:function(){return e}}},Vm=function(t){return gF(Lv(xF)(SF(t)))},Xm=function(t){var r=wa(t);return function(e){return r(vt.value)}},jm=function(t){var r=bi(t);return function(e){return CF(r(e))}},Jm=function(t){var r=bi(t);return function(e){return $F(r(e))}};var Qm=function(t){return function(r){return r.join(t)}};var wF=U(Sr),Ym={genericShowArgs:function(t){return[]}};var IF=function(t){return t.genericShowArgs};var Zm=function(t){var r=IF(t);return function(e){var n=Or(e);return{"genericShow'":function(u){var f=n(vt.value),p=r(u);return p.length===0?f:"("+(Qm(" ")(wF([f])(p))+")")}}}},cl=function(t){return t["genericShow'"]};var La=function(t){var r=cl(t);return function(e){var n=cl(e);return{"genericShow'":function(u){if(u instanceof Wr)return r(u.value0);if(u instanceof Rt)return n(u.value0);throw new Error("Failed pattern match at Data.Show.Generic (line 26, column 1 - line 28, column 40): "+[u.constructor.name])}}}},tA=function(t){var r=oc(t);return function(e){var n=cl(e);return function(u){return n(r(u))}}};var Ra=Zm(Ym),LF=j(Om),RF=dr(),OF=g(Vt),iA=Je(je),oA=Pa(iA),NF=pn(Yr),UF=ce(Yr),WF=Yt(nr),fA=du(Gt),cA=Oo(Gt),rA=jn(Ia(iA)),BF=jm(ht),HF=Jm(ht),pA=Bi(hf),qF=Um(zm(pA)),lA=zt(fc),eA=on(au),nA=dn(Pn),uA=I(Ce),GF=Yt(Vt),zF=Xm(pA),VF=ut(Er),XF=cA(ht),Lu=function(){function t(){}return t.value=new t,t}(),zi=function(){function t(){}return t.value=new t,t}(),Ft=function(){function t(){}return t.value=new t,t}(),st=function(){function t(){}return t.value=new t,t}(),Tt=function(){function t(){}return t.value=new t,t}();var jF=function(t){return t},we=function(){function t(){}return t.value=new t,t}(),Ie=function(){function t(){}return t.value=new t,t}(),Qe=function(){function t(){}return t.value=new t,t}(),Ye=function(){function t(){}return t.value=new t,t}(),Ze=function(){function t(){}return t.value=new t,t}(),tn=function(){function t(){}return t.value=new t,t}();var _A=function(){function t(){}return t.value=new t,t}(),vA=function(){function t(){}return t.value=new t,t}(),pl=function(){function t(r){this.value0=r}return t.create=function(r){return new t(r)},t}(),ll=function(){function t(r,e){this.value0=r,this.value1=e}return t.create=function(r){return function(e){return new t(r,e)}},t}(),sA={toPerm:dt(yt)};var JF={to:function(t){if(t instanceof Wr)return we.value;if(t instanceof Rt&&t.value0 instanceof Wr)return Ie.value;if(t instanceof Rt&&t.value0 instanceof Rt&&t.value0.value0 instanceof Wr)return Qe.value;if(t instanceof Rt&&t.value0 instanceof Rt&&t.value0.value0 instanceof Rt&&t.value0.value0.value0 instanceof Wr)return Ye.value;if(t instanceof Rt&&t.value0 instanceof Rt&&t.value0.value0 instanceof Rt&&t.value0.value0.value0 instanceof Rt&&t.value0.value0.value0.value0 instanceof Wr)return Ze.value;if(t instanceof Rt&&t.value0 instanceof Rt&&t.value0.value0 instanceof Rt&&t.value0.value0.value0 instanceof Rt&&t.value0.value0.value0.value0 instanceof Rt)return tn.value;throw new Error("Failed pattern match at Data.Gemini (line 133, column 1 - line 133, column 32): "+[t.constructor.name])},from:function(t){if(t instanceof we)return new Wr(fn.value);if(t instanceof Ie)return new Rt(new Wr(fn.value));if(t instanceof Qe)return new Rt(new Rt(new Wr(fn.value)));if(t instanceof Ye)return new Rt(new Rt(new Rt(new Wr(fn.value))));if(t instanceof Ze)return new Rt(new Rt(new Rt(new Rt(new Wr(fn.value)))));if(t instanceof tn)return new Rt(new Rt(new Rt(new Rt(new Rt(fn.value)))));throw new Error("Failed pattern match at Data.Gemini (line 133, column 1 - line 133, column 32): "+[t.constructor.name])}},xf={show:tA(JF)(La(Ra({reflectSymbol:function(){return"White"}}))(La(Ra({reflectSymbol:function(){return"Yellow"}}))(La(Ra({reflectSymbol:function(){return"Black"}}))(La(Ra({reflectSymbol:function(){return"Red"}}))(La(Ra({reflectSymbol:function(){return"Green"}}))(Ra({reflectSymbol:function(){return"Blue"}})))))))};var Mf=function(){return{inhabitants:[Ft.value,st.value,Tt.value]}}(),Vi={eq:function(t){return function(r){return t instanceof Ft&&r instanceof Ft||t instanceof st&&r instanceof st||t instanceof Tt&&r instanceof Tt}}},KF=j(Vi),bA={eq:function(t){return function(r){return LF(t.position)(r.position)&&KF(t.ring)(r.ring)}}},QF=j(bA),aA=ja(bA),YF=function(t){return RF(t)},Ef=function(t){return t.toPerm},Ru=function(t){return function(r){return{ring:t,direction:r}}};var Pe=function(t){var r=function(e){if(e instanceof Ft)return 0;if(e instanceof st)return 1;if(e instanceof Tt)return 2;throw new Error("Failed pattern match at Data.Gemini (line 257, column 15 - line 260, column 19): "+[e.constructor.name])};return(r(t.ring)*18|0)+Pu(t.position)|0},W=function(t){return function(r){return{ring:t,position:oA(r)}}},ZF=function(t){return function(r){return new x(NF(t)(r),UF(t)(r))}},tT=function(t){var r=ZF(t)(18),e=function(){return r.value0===0?Ft.value:r.value0===1?st.value:r.value0===2?Tt.value:Tu("indexToLocation")}();return{ring:e,position:oA(r.value1)}},pt=function(t){return function(r){return{color:t,label:r}}},rT=function(){return[{canonical:W(Ft.value)(2),alternate:W(st.value)(16)},{canonical:W(Ft.value)(7),alternate:W(st.value)(11)},{canonical:W(st.value)(2),alternate:W(Tt.value)(16)},{canonical:W(st.value)(7),alternate:W(Tt.value)(11)}]}(),mA=function(t){return Dr(t)(WF(Mo(function(r){return QF(r.alternate)(t)})(rT))(function(r){return r.canonical}))},wf=function(t){return Pe(mA(t))},If=function(t){return function(r){return YF(fA(wf(t))(r))}},eT=function(t){var r=g(t);return function(e){var n=cA(e);return function(u){return n(r(function(f){return new x(wf(f.value0),f.value1)})(u))}}},AA=function(){return eT(Vt)(ht)([new x(W(Ft.value)(12),pt(Ye.value)(1)),new x(W(Ft.value)(13),pt(Ye.value)(2)),new x(W(Ft.value)(14),pt(Ye.value)(3)),new x(W(Ft.value)(15),pt(Ye.value)(4)),new x(W(Ft.value)(16),pt(Ye.value)(5)),new x(W(Ft.value)(17),pt(Ye.value)(6)),new x(W(Ft.value)(0),pt(Ye.value)(7)),new x(W(Ft.value)(1),pt(Ye.value)(8)),new x(W(Ft.value)(3),pt(Ie.value)(1)),new x(W(Ft.value)(4),pt(Ie.value)(2)),new x(W(Ft.value)(5),pt(Ie.value)(3)),new x(W(Ft.value)(6),pt(Ie.value)(4)),new x(W(Ft.value)(7),pt(Ie.value)(5)),new x(W(Ft.value)(8),pt(Ie.value)(6)),new x(W(Ft.value)(9),pt(Ie.value)(7)),new x(W(Ft.value)(10),pt(Ie.value)(8)),new x(W(Ft.value)(11),pt(Ie.value)(9)),new x(W(st.value)(12),pt(Qe.value)(1)),new x(W(st.value)(13),pt(Qe.value)(2)),new x(W(st.value)(14),pt(Qe.value)(3)),new x(W(st.value)(15),pt(Qe.value)(4)),new x(W(st.value)(16),pt(Qe.value)(5)),new x(W(st.value)(17),pt(Qe.value)(6)),new x(W(st.value)(0),pt(Qe.value)(7)),new x(W(st.value)(1),pt(Qe.value)(8)),new x(W(st.value)(3),pt(tn.value)(1)),new x(W(st.value)(4),pt(tn.value)(2)),new x(W(st.value)(5),pt(tn.value)(3)),new x(W(st.value)(6),pt(tn.value)(4)),new x(W(st.value)(7),pt(tn.value)(5)),new x(W(st.value)(8),pt(tn.value)(6)),new x(W(st.value)(9),pt(tn.value)(7)),new x(W(st.value)(10),pt(tn.value)(8)),new x(W(Tt.value)(3),pt(Ze.value)(1)),new x(W(Tt.value)(4),pt(Ze.value)(2)),new x(W(Tt.value)(5),pt(Ze.value)(3)),new x(W(Tt.value)(6),pt(Ze.value)(4)),new x(W(Tt.value)(7),pt(Ze.value)(5)),new x(W(Tt.value)(8),pt(Ze.value)(6)),new x(W(Tt.value)(9),pt(Ze.value)(7)),new x(W(Tt.value)(10),pt(Ze.value)(8)),new x(W(Tt.value)(12),pt(we.value)(1)),new x(W(Tt.value)(13),pt(we.value)(2)),new x(W(Tt.value)(14),pt(we.value)(3)),new x(W(Tt.value)(15),pt(we.value)(4)),new x(W(Tt.value)(16),pt(we.value)(5)),new x(W(Tt.value)(17),pt(we.value)(6)),new x(W(Tt.value)(0),pt(we.value)(7)),new x(W(Tt.value)(1),pt(we.value)(8)),new x(W(Tt.value)(2),pt(we.value)(9))])}(),nT={toPerm:function(t){var r=function(){if(t.direction instanceof Lu)return rA;if(t.direction instanceof zi)return bo(rA);throw new Error("Failed pattern match at Data.Gemini (line 157, column 17 - line 159, column 49): "+[t.direction.constructor.name])}();return Vm(BF(Oc(HF(Wt(OF)(r)(function(e){return wf(jF(function(n){return{ring:t.ring,position:n}}(e)))})))))}},uT=Ef(nT),Xi={toPerm:function(t){return qF(uT(t.rotation))(Pu(t.amount))}},aT=function(t){return t},kA=function(t){var r=mA(t),e=aT(t);return lA(eA(nA(aA(e)(t)))(uA(e)))(eA(nA(aA(r)(t)))(uA(r)))},DA=function(t){var r=kA(t);if(r instanceof S)return new pl(t);if(r instanceof y)return new ll(t,r.value0);throw new Error("Failed pattern match at Data.Gemini (line 234, column 3 - line 236, column 37): "+[r.constructor.name])},iT=function(){var t=g(nr)(wf);return function(r){return t(kA(tT(r)))}}(),oT=function(t){return function(r){var e=Wt(fA)(r),n=GF(zF(t))(function(u){var f=lA(e(u))(VF(iT(u))(e));if(f instanceof S)return Tu("wat");if(f instanceof y)return new x(Gi(t)(u),f.value0);throw new Error("Failed pattern match at Data.Gemini (line 358, column 11 - line 360, column 45): "+[f.constructor.name])});return XF(n)}},ji=function(t){var r=Ef(t);return function(e){return oT(r(e))}};var fT=E($),_l=function(){function t(){}return t.value=new t,t}();var dA={attr:function(t){return function(r){return a({key:"click",value:M(h(fT(r)(!0)))})}}};var vl=function(){function t(){}return t.value=new t,t}();var yA={attr:function(t){return function(r){return a({key:"keydown",value:M(r)})}}};var sl=function(){function t(){}return t.value=new t,t}();var gA={attr:function(t){return function(r){return a({key:"pointercancel",value:M(r)})}}};var Ji=function(){function t(){}return t.value=new t,t}();var Pf={attr:function(t){return function(r){return a({key:"pointerdown",value:M(r)})}}};var bl=function(){function t(){}return t.value=new t,t}();var $A={attr:function(t){return function(r){return a({key:"pointerleave",value:M(r)})}}};var ml=function(){function t(){}return t.value=new t,t}();var CA={attr:function(t){return function(r){return a({key:"pointermove",value:M(r)})}}};var Al=function(){function t(){}return t.value=new t,t}();var hA={attr:function(t){return function(r){return a({key:"pointerup",value:M(r)})}}};var kl=function(){function t(){}return t.value=new t,t}();var FA={attr:function(t){return function(r){return a({key:"src",value:c(r)})}}};var Nu=k("div");var xA=function(){function t(){}return t.value=new t,t}();var MA={attr:function(t){return function(r){return a({key:"@self@",value:M(r)})}}};var rn=function(t){return function(r){return t(r)}};function dl(t){return t.key}var dT=ft(In),EA=g(Ht)(function(t){return a({key:"tabIndex",value:new Dn(dT(t))})}),Uu=function(t){return Cp(function(r){return t(r)})},wA=function(t){return Cp(function(r){return t(r)})},IA=function(){return I(or)(a({key:"autofocus",value:new Dn("")}))}();var Wu=function(){var t={},r="Pure",e="Throw",n="Catch",u="Sync",f="Async",p="Bind",_="Bracket",l="Fork",d="Sequential",L="Map",P="Apply",T="Alt",w="Cons",nt="Resume",J="Release",ct="Finalizer",_t="Finalized",Pt="Forked",zr="Fiber",jr="Thunk";function K(z,Ut,pr,qt){this.tag=z,this._1=Ut,this._2=pr,this._3=qt}function Jr(z){var Ut=function(pr,qt,Q){return new K(z,pr,qt,Q)};return Ut.tag=z,Ut}function Vu(z){return new K(r,void 0)}function eo(z){try{z()}catch(Ut){setTimeout(function(){throw Ut},0)}}function un(z,Ut,pr){try{return Ut(pr())}catch(qt){return z(qt)}}function Qn(z,Ut,pr){try{return Ut(pr)()}catch(qt){return pr(z(qt))(),Vu}}var Fn=function(){var z=1024,Ut=0,pr=0,qt=new Array(z),Q=!1;function H(){var Bt;for(Q=!0;Ut!==0;)Ut--,Bt=qt[pr],qt[pr]=void 0,pr=(pr+1)%z,Bt();Q=!1}return{isDraining:function(){return Q},enqueue:function(Bt){var $t,fr;Ut===z&&(fr=Q,H(),Q=fr),qt[(pr+Ut)%z]=Bt,Ut++,Q||H()}}}();function Xf(z){var Ut={},pr=0,qt=0;return{register:function(Q){var H=pr++;Q.onComplete({rethrow:!0,handler:function(Bt){return function(){qt--,delete Ut[H]}}})(),Ut[H]=Q,qt++},isEmpty:function(){return qt===0},killAll:function(Q,H){return function(){if(qt===0)return H();var Bt=0,$t={};function fr(Xt){$t[Xt]=Ut[Xt].kill(Q,function(sr){return function(){delete $t[Xt],Bt--,z.isLeft(sr)&&z.fromLeft(sr)&&setTimeout(function(){throw z.fromLeft(sr)},0),Bt===0&&H()}})()}for(var gr in Ut)Ut.hasOwnProperty(gr)&&(Bt++,fr(gr));return Ut={},pr=0,qt=0,function(Xt){return new K(u,function(){for(var sr in $t)$t.hasOwnProperty(sr)&&$t[sr]()})}}}}}var Tn=0,Rr=1,no=2,uo=3,ao=4,ue=5,Va=6;function jf(z,Ut,pr){var qt=0,Q=Tn,H=pr,Bt=null,$t=null,fr=null,gr=null,Xt=null,sr=0,Yn=0,_e=null,xn=!0;function Mn(Y){for(var rt,Et,Nt;;)switch(rt=null,Et=null,Nt=null,Q){case no:Q=Rr;try{H=fr(H),gr===null?fr=null:(fr=gr._1,gr=gr._2)}catch(Tr){Q=ue,Bt=z.left(Tr),H=null}break;case uo:z.isLeft(H)?(Q=ue,Bt=H,H=null):fr===null?Q=ue:(Q=no,H=z.fromRight(H));break;case Rr:switch(H.tag){case p:fr&&(gr=new K(w,fr,gr)),fr=H._2,Q=Rr,H=H._1;break;case r:fr===null?(Q=ue,H=z.right(H._1)):(Q=no,H=H._1);break;case u:Q=uo,H=un(z.left,z.right,H._1);break;case f:Q=ao,H=Qn(z.left,H._1,function(Tr){return function(){qt===Y&&(qt++,Fn.enqueue(function(){qt===Y+1&&(Q=uo,H=Tr,Mn(qt))}))}});return;case e:Q=ue,Bt=z.left(H._1),H=null;break;case n:fr===null?Xt=new K(w,H,Xt,$t):Xt=new K(w,H,new K(w,new K(nt,fr,gr),Xt,$t),$t),fr=null,gr=null,Q=Rr,H=H._1;break;case _:sr++,fr===null?Xt=new K(w,H,Xt,$t):Xt=new K(w,H,new K(w,new K(nt,fr,gr),Xt,$t),$t),fr=null,gr=null,Q=Rr,H=H._1;break;case l:Q=uo,rt=jf(z,Ut,H._2),Ut&&Ut.register(rt),H._1&&rt.run(),H=z.right(rt);break;case d:Q=Rr,H=Dk(z,Ut,H._1);break}break;case ue:if(fr=null,gr=null,Xt===null)Q=Va,H=$t||Bt||H;else switch(rt=Xt._3,Nt=Xt._1,Xt=Xt._2,Nt.tag){case n:$t&&$t!==rt&&sr===0?Q=ue:Bt&&(Q=Rr,H=Nt._2(z.fromLeft(Bt)),Bt=null);break;case nt:$t&&$t!==rt&&sr===0||Bt?Q=ue:(fr=Nt._1,gr=Nt._2,Q=no,H=z.fromRight(H));break;case _:sr--,Bt===null&&(Et=z.fromRight(H),Xt=new K(w,new K(J,Nt._2,Et),Xt,rt),($t===rt||sr>0)&&(Q=Rr,H=Nt._3(Et)));break;case J:Xt=new K(w,new K(_t,H,Bt),Xt,$t),Q=Rr,$t&&$t!==rt&&sr===0?H=Nt._1.killed(z.fromLeft($t))(Nt._2):Bt?H=Nt._1.failed(z.fromLeft(Bt))(Nt._2):H=Nt._1.completed(z.fromRight(H))(Nt._2),Bt=null,sr++;break;case ct:sr++,Xt=new K(w,new K(_t,H,Bt),Xt,$t),Q=Rr,H=Nt._1;break;case _t:sr--,Q=ue,H=Nt._1,Bt=Nt._2;break}break;case Va:for(var _r in _e)_e.hasOwnProperty(_r)&&(xn=xn&&_e[_r].rethrow,eo(_e[_r].handler(H)));_e=null,$t&&Bt?setTimeout(function(){throw z.fromLeft(Bt)},0):z.isLeft(H)&&xn&&setTimeout(function(){if(xn)throw z.fromLeft(H)},0);return;case Tn:Q=Rr;break;case ao:return}}function lr(Y){return function(){if(Q===Va)return xn=xn&&Y.rethrow,Y.handler(H)(),function(){};var rt=Yn++;return _e=_e||{},_e[rt]=Y,function(){_e!==null&&delete _e[rt]}}}function at(Y,rt){return function(){if(Q===Va)return rt(z.right(void 0))(),function(){};var Et=lr({rethrow:!1,handler:function(){return rt(z.right(void 0))}})();switch(Q){case Tn:$t=z.left(Y),Q=Va,H=$t,Mn(qt);break;case ao:$t===null&&($t=z.left(Y)),sr===0&&(Q===ao&&(Xt=new K(w,new K(ct,H(Y)),Xt,$t)),Q=ue,H=null,Bt=null,Mn(++qt));break;default:$t===null&&($t=z.left(Y)),sr===0&&(Q=ue,H=null,Bt=null)}return Et}}function xt(Y){return function(){var rt=lr({rethrow:!1,handler:Y})();return Q===Tn&&Mn(qt),rt}}return{kill:at,join:xt,onComplete:lr,isSuspended:function(){return Q===Tn},run:function(){Q===Tn&&(Fn.isDraining()?Mn(qt):Fn.enqueue(function(){Mn(qt)}))}}}function kk(z,Ut,pr,qt){var Q=0,H={},Bt=0,$t={},fr=new Error("[ParAff] Early exit"),gr=null,Xt=t;function sr(lr,at,xt){var Y=at,rt=null,Et=null,Nt=0,_r={},Tr,Xa;t:for(;;)switch(Tr=null,Y.tag){case Pt:if(Y._3===t&&(Tr=H[Y._1],_r[Nt++]=Tr.kill(lr,function(dk){return function(){Nt--,Nt===0&&xt(dk)()}})),rt===null)break t;Y=rt._2,Et===null?rt=null:(rt=Et._1,Et=Et._2);break;case L:Y=Y._2;break;case P:case T:rt&&(Et=new K(w,rt,Et)),rt=Y,Y=Y._1;break}if(Nt===0)xt(z.right(void 0))();else for(Xa=0,Tr=Nt;Xa<Tr;Xa++)_r[Xa]=_r[Xa]();return _r}function Yn(lr,at,xt){var Y,rt,Et,Nt,_r,Tr;for(z.isLeft(lr)?(Y=lr,rt=null):(rt=lr,Y=null);;){if(Et=null,Nt=null,_r=null,Tr=null,gr!==null)return;if(at===null){qt(Y||rt)();return}if(at._3!==t)return;switch(at.tag){case L:Y===null?(at._3=z.right(at._1(z.fromRight(rt))),rt=at._3):at._3=Y;break;case P:if(Et=at._1._3,Nt=at._2._3,Y){if(at._3=Y,_r=!0,Tr=Bt++,$t[Tr]=sr(fr,Y===Et?at._2:at._1,function(){return function(){delete $t[Tr],_r?_r=!1:xt===null?Yn(Y,null,null):Yn(Y,xt._1,xt._2)}}),_r){_r=!1;return}}else{if(Et===t||Nt===t)return;rt=z.right(z.fromRight(Et)(z.fromRight(Nt))),at._3=rt}break;case T:if(Et=at._1._3,Nt=at._2._3,Et===t&&z.isLeft(Nt)||Nt===t&&z.isLeft(Et))return;if(Et!==t&&z.isLeft(Et)&&Nt!==t&&z.isLeft(Nt))Y=rt===Et?Nt:Et,rt=null,at._3=Y;else if(at._3=rt,_r=!0,Tr=Bt++,$t[Tr]=sr(fr,rt===Et?at._2:at._1,function(){return function(){delete $t[Tr],_r?_r=!1:xt===null?Yn(rt,null,null):Yn(rt,xt._1,xt._2)}}),_r){_r=!1;return}break}xt===null?at=null:(at=xt._1,xt=xt._2)}}function _e(lr){return function(at){return function(){delete H[lr._1],lr._3=at,Yn(at,lr._2._1,lr._2._2)}}}function xn(){var lr=Rr,at=pr,xt=null,Y=null,rt,Et;t:for(;;)switch(rt=null,Et=null,lr){case Rr:switch(at.tag){case L:xt&&(Y=new K(w,xt,Y)),xt=new K(L,at._1,t,t),at=at._2;break;case P:xt&&(Y=new K(w,xt,Y)),xt=new K(P,t,at._2,t),at=at._1;break;case T:xt&&(Y=new K(w,xt,Y)),xt=new K(T,t,at._2,t),at=at._1;break;default:Et=Q++,lr=ue,rt=at,at=new K(Pt,Et,new K(w,xt,Y),t),rt=jf(z,Ut,rt),rt.onComplete({rethrow:!1,handler:_e(at)})(),H[Et]=rt,Ut&&Ut.register(rt)}break;case ue:if(xt===null)break t;xt._1===t?(xt._1=at,lr=Rr,at=xt._2,xt._2=t):(xt._2=at,at=xt,Y===null?xt=null:(xt=Y._1,Y=Y._2))}for(Xt=at,Et=0;Et<Q;Et++)H[Et].run()}function Mn(lr,at){gr=z.left(lr);var xt;for(var Y in $t)if($t.hasOwnProperty(Y)){xt=$t[Y];for(Y in xt)xt.hasOwnProperty(Y)&&xt[Y]()}$t=null;var rt=sr(lr,Xt,at);return function(Et){return new K(f,function(Nt){return function(){for(var _r in rt)rt.hasOwnProperty(_r)&&rt[_r]();return Vu}})}}return xn(),function(lr){return new K(f,function(at){return function(){return Mn(lr,at)}})}}function Dk(z,Ut,pr){return new K(f,function(qt){return function(){return kk(z,Ut,pr,qt)}})}return K.EMPTY=t,K.Pure=Jr(r),K.Throw=Jr(e),K.Catch=Jr(n),K.Sync=Jr(u),K.Async=Jr(f),K.Bind=Jr(p),K.Bracket=Jr(_),K.Fork=Jr(l),K.Seq=Jr(d),K.ParMap=Jr(L),K.ParApply=Jr(P),K.ParAlt=Jr(T),K.Fiber=jf,K.Supervisor=Xf,K.Scheduler=Fn,K.nonCanceler=Vu,K}(),yT=Wu.Pure,gT=Wu.Throw;var ST=Wu.Sync;var PA=Wu.Async;var $T=function(){function t(e,n){return e===0&&typeof setImmediate<"u"?setImmediate(n):setTimeout(n,e)}function r(e,n){return e===0&&typeof clearImmediate<"u"?clearImmediate(n):clearTimeout(n)}return function(e,n){return Wu.Async(function(u){return function(){var f=t(n,u(e()));return function(){return Wu.Sync(function(){return e(r(n,f))})}}})}}(),CT=Wu.Seq;var Lf=function(t){return t()};var BT=cu(fu),HT=jt(pe),Rf=g(Ht),qT=zt(te),GT=I(or);var zT=Vs,Of=function(t){return function(r){return function(e){var n=up(function(p){return function(_){return function(){var d=Ur(t)();return _(e(BT(kr(d))))(),p(r)(function(L){return HT(ie(L)(d))})()}}}),u=Rf(function(p){return p})(n),f=ba(Rf(function(p){return p})(u));return f}}};var VT=function(t){return function(r){var e=Go(t)(r),n=Rf(function(f){return f})(e),u=ba(Rf(function(f){return f})(n));return u}},NA=function(t){return function(r){return rn(zT)(function(e){return rn(VT(qT(e.value1)(GT(t))))(function(n){return r(new x(e.value0,n))})})}};var Sl=v(Ve),XT=Cu(ht),WA=I(or),jT=I($r),JT={reflectType:function(){return"~"}},BA=zt(te),KT=g(Ht),QT=ga(ya),YT=qr(),ZT=j(Hn),tx=Ar();var Bu={pursxToElement:function(t){return function(r){return function(e){return{cache:Aa,element:new re(function(n){return function(u){return Sl}})}}}}},$l=function(t){return t.pursxToElement},Cn=function(){return vt.value}(),Cl=function(t){var r=function(e){return e instanceof re?e.value0:function(n){return function(u){return Sl}}};return r(t)},rx=function(t){var r=ma(t);return function(e){var n=ma(e);return function(){return function(){return function(u){var f=$l(u);return function(p){return function(_){return function(l){var d=function(P){return function(T){return ze(function(w,nt){var J=T.ids(),ct=T.ids();P.raiseId(J)();var _t=f(ct)(vt.value)(l),Pt=Cl(_t.element),zr=w(XT([WA(T.makePursx({id:J,parent:P.parent,cache:_t.cache,dynFamily:P.dynFamily,pos:P.pos,pxScope:ct,scope:P.scope,html:r(_),verb:n(p)})),Pt(P)(T),rr(Sl)(function(jr){return WA(T.attributeParent({id:J,parent:jr,pos:P.pos,dynFamily:P.dynFamily,ez:!1}))})(P.parent)]),nt);return function(){return nt(T.deleteFromCache({id:J})),zr()}})}},L=new re(d);return L}}}}}}}},hn=function(t){var r=rx(t)(JT)()();return function(){return function(){return function(e){return r(e)(vt.value)}}}};var Oa=function(){return function(t){var r=$l(t);return function(e){var n=ma(e);return function(u){var f=ip(u)();return{pursxToElement:function(p){return function(_){return function(l){var d=r(p)(vt.value)(l);return{cache:ka(n(vt.value))(!0)(d.cache),element:new re(function(L){return function(P){return BA(KT(QT(uf)(function(T){if(T.value instanceof Dn)return P.setProp({id:n(vt.value)+("@!%"+p),key:T.key,value:T.value.value0});if(T.value instanceof Ti)return P.setCb({id:n(vt.value)+("@!%"+p),key:T.key,value:T.value.value0});if(T.value instanceof nf)return P.unsetAttribute({id:n(vt.value)+("@!%"+p),key:T.key});throw new Error("Failed pattern match at Deku.Pursx (line 2487, column 52 - line 2504, column 38): "+[T.value.constructor.name])}))(f(vt.value)(l)))(function(){var T=Cl(d.element);return T}()(L)(P))}})}}}}}}}}};var ex=function(t){return function(r){return function(e){return Me({doLogic:function(n){return function(u){return function(f){return u.sendToPos({id:f,pos:n})}}},ids:function(n){return function(u){return u.ids}(YT(n))},disconnectElement:function(n){return function(u){return n.disconnectElement({id:u.id,scope:u.scope,parent:u.parent,scopeEq:ZT})}},toElt:function(n){return n}})(t)(r)(tx(e))}}},HA=function(){return function(t){var r=$l(t);return function(e){var n=ma(e);return function(u){var f=ip(u)();return{pursxToElement:function(p){return function(_){return function(l){var d=r(p)(vt.value)(l);return{cache:ka(n(vt.value))(!1)(d.cache),element:new re(function(L){return function(P){return BA(ex({parent:new y(n(vt.value)+("@!%"+p)),scope:L.scope,raiseId:function(T){return jT(void 0)},pos:L.pos,ez:!1,dynFamily:S.value})(P)(function(T){return T}(f(vt.value)(l))))(function(){var T=Cl(d.element);return T}()(L)(P))}})}}}}}}}}};var Na=Pa(Je(je)),Fl=function(t){return{amount:Na(t),rotation:Ru(Tt.value)(zi.value)}},Tl=function(t){return{amount:Na(t),rotation:Ru(Tt.value)(Lu.value)}},xl=function(t){return{amount:Na(t),rotation:Ru(Ft.value)(zi.value)}},Ml=function(t){return{amount:Na(t),rotation:Ru(Ft.value)(Lu.value)}},El=function(t){return{amount:Na(t),rotation:Ru(st.value)(zi.value)}},wl=function(t){return{amount:Na(t),rotation:Ru(st.value)(Lu.value)}};var Nf=function(t){return function(){console.log(t)}};var Il=function(t){return function(r){return rn(NA(t))(function(e){return rn(Of(t)(e.value1))(function(n){return r({event:e.value1,ref:n,pusher:e.value0})})})}},en=function(t){return t.event},Uf=function(t){return function(r){return t.pusher(r)}},Wf=function(t){return t.ref},Ki=function(t){return function(r){return function(){var n=t.ref();return t.pusher(r(n))()}}};var px=dr(),lx=$v(Zr)(su)(_u),_x=br(ht)(fl(Bi(hf))),vx=Ef(Xi),sx=ji(sA),bx=ji(Xi),mx=function(t){return px(t)},Ax=function(t){var r=bu(t);return function(e){return mx(r(e))}},qA=function(t){var r=[Ml(1),xl(1),wl(1),El(1),Tl(1),Fl(1)];return function(){var n=lx(1e3)(Hp(0)(5))(),u=_x(function(f){return vx(Ax(r)(f))})(n);return Ki(t)(sx(u))()}},GA=function(t){var r=function(){var e=Ki(t);return function(n){return e(bx(n))}}();return function(e){return function(n){return n==="q"?r(xl(1)):n==="w"?r(Ml(1)):n==="t"?r(El(1)):n==="y"?r(wl(1)):n==="o"?r(Fl(1)):n==="p"?r(Tl(1)):Nf(n)}(dl(e))}};var Ua=function(){function t(){}return t.value=new t,t}(),zA=function(){function t(){}return t.value=new t,t}(),Jn=function(){function t(){}return t.value=new t,t}();var Hu={append:function(t){return function(r){return t+r}}},qu={mempty:0,Semigroup0:function(){return Hu}},Wa={invert:function(t){return-t},Monoid0:function(){return qu}},Dx=function(t){return t*2*wi},Bf=function(t){return Lp(t)},dx=function(t){return t/(2*wi)},yx=function(t){return t*180/wi},gx=function(t){return t*wi/180},Hf=function(t){return Ip(t)},Ba=function(t){return function(r){if(r instanceof zA)return t;if(r instanceof Ua)return gx(t);if(r instanceof Jn)return Dx(t);throw new Error("Failed pattern match at Data.Angle (line 23, column 3 - line 26, column 38): "+[r.constructor.name])}},VA=function(t){return function(r){if(r instanceof zA)return t;if(r instanceof Ua)return yx(t);if(r instanceof Jn)return dx(t);throw new Error("Failed pattern match at Data.Angle (line 30, column 3 - line 33, column 36): "+[r.constructor.name])}},XA=function(t){return function(r){return wp(t)(r)}};var Gu={append:function(t){return function(r){return{x:t.x+r.x,y:t.y+r.y}}}},Pl={mempty:{x:0,y:0},Semigroup0:function(){return Gu}},Ha={invert:function(t){return{x:-t.x,y:-t.y}},Monoid0:function(){return Pl}};var qa=function(t){return XA(t.y)(t.x)};var Sx=Yt($),$x=U(Gu),Cx=Ke(Ha),hx=V(qu),Fx=U(Hu),Tx=Ke(Wa),xx=ji(Xi),Mx=function(t){return function(r){return Sx(t)(function(e){return e.ringCenter(r)})}},jA=function(t){return{x:t.clientX,y:t.clientY}},Ll=function(t){return function(r){var e=jA(r);return function(){var u=Wf(t.drag)();if(u instanceof S)return void 0;if(u instanceof y)return Uf(t.drag)(new y({currentPoint:e,chosen:u.value0.chosen,initialPoint:u.value0.initialPoint,location:u.value0.location}))();throw new Error("Failed pattern match at Gemini.Component.Puzzle.Actions (line 52, column 3 - line 60, column 14): "+[u.constructor.name])}}},zf=function(t){return function(r){var e=jA(r);return Uf(t.drag)(new y({location:DA(t.location),chosen:S.value,initialPoint:e,currentPoint:e}))}},Kn=function(t){if(t.location instanceof pl)return t.location.value0;if(t.location instanceof ll){if(t.chosen instanceof y&&t.chosen.value0 instanceof _A)return t.location.value0;if(t.chosen instanceof y&&t.chosen.value0 instanceof vA)return t.location.value1;if(t.chosen instanceof S)return t.location.value0;throw new Error("Failed pattern match at Gemini.Component.Puzzle.Actions (line 129, column 7 - line 133, column 24): "+[t.chosen.constructor.name])}throw new Error("Failed pattern match at Gemini.Component.Puzzle.Actions (line 126, column 3 - line 133, column 24): "+[t.location.constructor.name])},Ex=function(t){var r=function(e){return function(n){return function(){var f=Mx(t.domInfo)(e)(),p=$x(n)(Cx(f));return qa(p)}}};return function(){var n=Wf(t.drag)();if(n instanceof S)return hx;if(n instanceof y){var u=Kn(n.value0),f=r(u.ring)(n.value0.initialPoint)(),p=r(u.ring)(n.value0.currentPoint)();return Fx(p)(Tx(f))}throw new Error("Failed pattern match at Gemini.Component.Puzzle.Actions (line 106, column 3 - line 112, column 43): "+[n.constructor.name])}},wx=function(t){var r=$n(t.Nat0()),e=Pa(t);return function(n){var u=VA(n)(Jn.value),f=ar(r(Sn));return e($a(f*u+.5))}},Ix=wx(Je(je)),JA=function(t){return function(r){return function(){Ll(t)(r)();var n=Wf(t.drag)();if(n instanceof S)return void 0;if(n instanceof y){var u=Ex(t)(),f=Kn(n.value0),p=Ix(u),_={amount:p,rotation:{ring:f.ring,direction:Lu.value}};return Uf(t.drag)(S.value)(),Ki(t.gemini)(xx(_))()}throw new Error("Failed pattern match at Gemini.Component.Puzzle.Actions (line 77, column 3 - line 85, column 56): "+[n.constructor.name])}}};var zu=window.matchMedia("(pointer: coarse), (hover: none)").matches;var Rx=d_(ta);var Ga=function(t){return function(r){return _a(function(e){return function(){var u=Si(t)(Rx(r)(e))();return u}})}};var Bl=Uo(ht)(Gt),Yi=g(Vt),Ox=Yt($),Nx=V(qu),Ux=ut(Er),Wx=Ne(Ue)(Er),Bx=dn(Pn),Hx=j(Vi),qx=Ke(Ha),Gx=U(Gu),zx=I(Ce),Hl=U(Hu),Vx=Ke(Wa),KA=ft(Za),Xx=No(Gt),ZA=Je(je),QA=Yt(Ht),jx=ft(xf),Jx=hn({reflectType:function(){return"<div ~diskAttrs~ />"}})()()(Oa()(Bu)({reflectType:function(){return"diskAttrs"}})({reflectSymbol:function(){return"diskAttrs"}})),Nl=zt(te),Kx=Ea(Vn),Wl=I(or),Ul=g(Ht),Qx=Wi(Ma),Yx=ee(Pf),Zx=jn(Ia(ZA)),YA=Xn(Vn),tM=Sf(Ma),rM=jn(Mf),eM=function(t){if(t instanceof Ft)return"left: 14.9%";if(t instanceof Tt)return"right: 14.9%";if(t instanceof st)return"";throw new Error("Failed pattern match at Gemini.Component.Puzzle (line 111, column 3 - line 114, column 21): "+[t.constructor.name])},nM=function(){return Bl(Yi(Pe)([W(st.value)(2),W(st.value)(7)]))}(),uM=function(){return Bl(Yi(Pe)([W(st.value)(16),W(st.value)(11)]))}(),aM=function(t){return Ga(en(t.drag))(function(r){return Ox(t.domInfo)(function(e){return{drag:r,domInfo:e}})})},iM=function(t){return function(r){return Dr(Nx)(Ux(r.drag)(function(e){var n=Kn(e);return Wx(Bx(Hx(t)(n.ring)))(function(){var u=qx(r.domInfo.ringCenter(n.ring)),f=function(){var p=Gx(u);return function(_){return qa(p(_))}}();return zx(Hl(f(e.currentPoint))(Vx(f(e.initialPoint))))})}))}},oM=function(t){var r=43*(1+Hf(t)),e=43*(1+Bf(t));return"left: "+(KA(r)+("%; top: "+(KA(e)+"%")))},fM=function(){return Bl(Yi(Pe)([W(Ft.value)(2),W(Ft.value)(7),W(Tt.value)(16),W(Tt.value)(11)]))}(),cM=function(t){var r=Kn(t);if(r.ring instanceof Ft)return uM;if(r.ring instanceof st)return fM;if(r.ring instanceof Tt)return nM;throw new Error("Failed pattern match at Gemini.Component.Puzzle (line 118, column 3 - line 121, column 32): "+[r.ring.constructor.name])},pM=function(t){return function(r){if(r instanceof S)return!1;if(r instanceof y)return Xx(Pe(t))(cM(r.value0));throw new Error("Failed pattern match at Gemini.Component.Puzzle (line 90, column 1 - line 90, column 44): "+[t.constructor.name,r.constructor.name])}},lM=function(t){var r=$n(t.Nat0());return function(e){var n=Ba(ar(Pu(e))/ar(r(Sn)))(Jn.value);return Hl(n)(Ba(-90)(Ua.value))}},_M=lM(ZA),vM=function(t){return function(r){var e=_M(t.position),n=aM(r),u=QA(n)(iM(t.ring)),f=QA(en(r.gemini))(function(){var p=If(t);return function(_){return ha(jx(function(l){return l.color}(p(_))))}}());return Jx(Cn)({diskAttrs:Nl(Kx([Wl("disk"),f,gn(Ul(pM(t))(en(r.drag)))("hidden")]))(Nl(Qx(Ul(oM)(Nl(Wl(e))(Ul(Hl(e))(u)))))(Yx(Ji.value)(Uu(zf({drag:r.drag,location:t})))))})}},tk=function(t){var r=function(n){return Wt(Yi)(Zx)(function(u){var f={ring:n,position:u};return vM(f)(t)})},e=function(n){return Nu([YA("w-full relative"),tM(eM(n)),Wl(af("ring")(function(){if(n instanceof Ft)return"left";if(n instanceof st)return"center";if(n instanceof Tt)return"right";throw new Error("Failed pattern match at Gemini.Component.Puzzle (line 54, column 13 - line 57, column 35): "+[n.constructor.name])}()))])(r(n))};return Nu([YA("gemini")])(Yi(e)(rM))};var zl=Uo(ht)(Gt),to=g(Vt),bM=Yt($),mM=V(qu),AM=ut(Er),kM=Ne(Ue)(Er),DM=dn(Pn),dM=j(Vi),yM=Ke(Ha),gM=U(Gu),SM=I(Ce),Vl=U(Hu),$M=Ke(Wa),rk=ft(Za),CM=No(Gt),nk=Je(je),ek=Yt(Ht),hM=ft(xf),FM=hn({reflectType:function(){return"<div ~diskAttrs~ />"}})()()(Oa()(Bu)({reflectType:function(){return"diskAttrs"}})({reflectSymbol:function(){return"diskAttrs"}})),ql=zt(te),uk=Ea(Vn),Zi=I(or),Gl=g(Ht),TM=Wi(Ma),xM=ee(Pf),MM=jn(Ia(nk)),EM=Xn(Vn),wM=Sf(Ma),IM=jn(Mf),PM=function(t){if(t instanceof Ft)return"top: 14.9%";if(t instanceof Tt)return"bottom: 14.9%";if(t instanceof st)return"";throw new Error("Failed pattern match at Gemini.Component.Puzzle.Mobile (line 110, column 3 - line 113, column 21): "+[t.constructor.name])},LM=function(){return zl(to(Pe)([W(st.value)(2),W(st.value)(7)]))}(),RM=function(){return zl(to(Pe)([W(st.value)(16),W(st.value)(11)]))}(),OM=function(t){return Ga(en(t.drag))(function(r){return bM(t.domInfo)(function(e){return{drag:r,domInfo:e}})})},NM=function(t){return function(r){return Dr(mM)(AM(r.drag)(function(e){var n=Kn(e);return kM(DM(dM(t)(n.ring)))(function(){var u=yM(r.domInfo.ringCenter(n.ring)),f=function(){var p=gM(u);return function(_){return qa(p(_))}}();return SM(Vl(f(e.currentPoint))($M(f(e.initialPoint))))})}))}},UM=function(t){var r=43*(1+Hf(t)),e=43*(1+Bf(t));return"left: "+(rk(r)+("%; top: "+(rk(e)+"%")))},WM=function(){return zl(to(Pe)([W(Ft.value)(2),W(Ft.value)(7),W(Tt.value)(16),W(Tt.value)(11)]))}(),BM=function(t){var r=Kn(t);if(r.ring instanceof Ft)return RM;if(r.ring instanceof st)return WM;if(r.ring instanceof Tt)return LM;throw new Error("Failed pattern match at Gemini.Component.Puzzle.Mobile (line 117, column 3 - line 120, column 32): "+[r.ring.constructor.name])},HM=function(t){return function(r){if(r instanceof S)return!1;if(r instanceof y)return CM(Pe(t))(BM(r.value0));throw new Error("Failed pattern match at Gemini.Component.Puzzle.Mobile (line 89, column 1 - line 89, column 44): "+[t.constructor.name,r.constructor.name])}},qM=function(t){var r=$n(t.Nat0());return function(e){var n=Ba(ar(Pu(e))/ar(r(Sn)))(Jn.value);return Vl(n)(Ba(-90)(Ua.value))}},GM=qM(nk),zM=function(t){return function(r){var e=GM(t.position),n=OM(r),u=ek(n)(NM(t.ring)),f=ek(en(r.gemini))(function(){var p=If(t);return function(_){return ha(hM(function(l){return l.color}(p(_))))}}());return FM(Cn)({diskAttrs:ql(uk([Zi("disk"),f,gn(Gl(HM(t))(en(r.drag)))("hidden")]))(ql(TM(Gl(UM)(ql(Zi(e))(Gl(Vl(e))(u)))))(xM(Ji.value)(Uu(zf({drag:r.drag,location:t})))))})}},ak=function(t){var r=function(n){return Wt(to)(MM)(function(u){var f={ring:n,position:u};return zM(f)(t)})},e=function(n){return Nu([EM("h-full w-full relative"),wM(PM(n)),Zi(af("ring")(function(){if(n instanceof Ft)return"left";if(n instanceof st)return"center";if(n instanceof Tt)return"right";throw new Error("Failed pattern match at Gemini.Component.Puzzle.Mobile (line 53, column 13 - line 56, column 35): "+[n.constructor.name])}()))])(r(n))};return Nu([uk([Zi("gemini"),gn(Zi(zu))("mobile")])])(to(e)(IM))};var ok=()=>({ringRadius:XM(),leftRingCenter:Xl('[data-ring="left"]'),centerRingCenter:Xl('[data-ring="center"]'),rightRingCenter:Xl('[data-ring="right"]')});function Xl(t){let r=document.querySelector(t);console.log(r);let e=r.getBoundingClientRect(),n=e.width,u=e.left,f=e.top,p=n/2;return{x:u+p,y:f+p}}function ik(t){return document.querySelector(t).getBoundingClientRect().width}function XM(){let t=ik("[data-ring]"),r=ik(".disk");return(t-r)/2}var fk=Yt($)(ok)(function(t){return{ringRadius:t.ringRadius,ringCenter:function(r){if(r instanceof Ft)return t.leftRingCenter;if(r instanceof st)return t.centerRingCenter;if(r instanceof Tt)return t.rightRingCenter;throw new Error("Failed pattern match at Gemini.DomInfo (line 32, column 15 - line 35, column 45): "+[r.constructor.name])}}}),ck={ringRadius:0,ringCenter:V(Ln(Pl))};var pk=t=>new ResizeObserver(r=>t(r)()),lk=t=>r=>()=>r.observe(t),jl=t=>()=>t.disconnect();var Jl=function(){var t=function(){var r=Lf(nu(Ur(V(Ln(vn(_n)))))),e=pk(function(n){if(n.length===1)return function(){var f=nu(kr(r))();return f(n[0].target)()};throw new Error("Failed pattern match at Resize (line 52, column 15 - line 54, column 30): "+[n.constructor.name])});return{ref:r,ob:e}}();return{event:_a(function(r){return function(){return nu(ie(r)(t.ref))(),jl(t.ob)}}),listen:function(r){return function(){jl(t.ob)();var n=nu(kr(t.ref))();return n(r)(),lk(r)(t.ob)()}}}}();var za=Oa(),Vf=HA(),_k=za(Bu),YM=hn({reflectType:function(){return`
    <a target="_blank" rel="noopener noreferrer" ~linkAttrs~>
        <img ~imgAttrs~ />
        <span ~labelAttrs~>~label~</span>
    </a>
  `}})()()(za(Vf(za(_k({reflectType:function(){return"linkAttrs"}})({reflectSymbol:function(){return"linkAttrs"}}))({reflectType:function(){return"labelAttrs"}})({reflectSymbol:function(){return"labelAttrs"}}))({reflectType:function(){return"label"}})({reflectSymbol:function(){return"label"}}))({reflectType:function(){return"imgAttrs"}})({reflectSymbol:function(){return"imgAttrs"}})),nn=zt(te),ZM=Xn(Fm),tE=ee(Tm),rE=Xn(hm),eE=ee(FA),nE=Xn(Cm),uE=hn({reflectType:function(){return`
    <div ~headerAttrs~>
      <button class="action-button" ~buttonAttrs~>
        Scramble
      </button>
    </div>
  `}})()()(za(_k({reflectType:function(){return"headerAttrs"}})({reflectSymbol:function(){return"headerAttrs"}}))({reflectType:function(){return"buttonAttrs"}})({reflectSymbol:function(){return"buttonAttrs"}})),Kl=Ea(Vn),ro=I(or),aE=ee(dA),vk=Vf(Bu),sk={reflectType:function(){return"footer"}},bk={reflectSymbol:function(){return"footer"}},iE=hn({reflectType:function(){return`
      <div ~attrs~>
        <div class="flex flex-col gap-12 items-center">
          ~header~
          ~puzzle~
          ~footer~
        </div>
      </div>
    `}})()()(za(Vf(Vf(vk({reflectType:function(){return"puzzle"}})({reflectSymbol:function(){return"puzzle"}}))({reflectType:function(){return"header"}})({reflectSymbol:function(){return"header"}}))(sk)(bk))({reflectType:function(){return"attrs"}})({reflectSymbol:function(){return"attrs"}})),oE=Yt(Ht),fE=ee(MA),cE=ee(yA),pE=ee(CA),lE=ee(hA),_E=ee($A),vE=ee(gA),sE=function(t){return function(r){return function(e){return YM(Cn)({linkAttrs:nn(ZM("flex items-center p-2 underline decoration-sky-500/30"))(tE(gf.value)(r)),imgAttrs:nn(rE("h-[20px] m-2"))(eE(kl.value)(t)),labelAttrs:nE("decoration-sky-500/30"),label:A(e)})}}},bE=function(t){return uE(Cn)({headerAttrs:Kl([ro("flex justify-center"),gn(ro(zu))("hidden")]),buttonAttrs:aE(_l.value)(qA(t))})},mE=hn({reflectType:function(){return`
      <div ~footer~>
        <div class="text-2xl">
          <div>Q: Rotate left disk counter clockwise</div>
          <div>W: Rotate left disk clockwise</div>
          <div>T: Rotate center disk counter clockwise</div>
          <div>Y: Rotate center disk clockwise</div>
          <div>O: Rotate right disk counter clockwise</div>
          <div>P: Rotate right disk clockwise</div>
        </div>
        <div class="fixed bottom-0 left-0">
          ~viewSource~
        </div>
      </div>
    `}})()()(za(vk({reflectType:function(){return"viewSource"}})({reflectSymbol:function(){return"viewSource"}}))(sk)(bk))(Cn)({footer:Kl([gn(ro(zu))("hidden")]),viewSource:sE("./github.png")("https://github.com/CharlesTaylor7/gemini")("View Source")}),mk=rn(Il(AA))(function(t){return rn(Il(S.value))(function(r){var e=Ga(Jl.event)(h(fk));return rn(Of(ck)(e))(function(n){var u={gemini:t,drag:r,domInfo:n};return zu?ak(u):iE(Cn)(function(){var f=Uu(JA(u));return{header:bE(t),attrs:nn(Kl([ro("mt-12 w-full h-full flex justify-center fixed"),gn(oE(en(r))(ti))("cursor-grabbing")]))(nn(fE(xA.value)(function(p){return Jl.listen(p)}))(nn(IA)(nn(EA(ro(0)))(nn(cE(vl.value)(wA(GA(t))))(nn(pE(ml.value)(Uu(Ll(u))))(nn(lE(Al.value)(f))(nn(_E(bl.value)(f))(vE(sl.value)(f))))))))),puzzle:tk(u),footer:mE}}())})})});var Ak=$m(mk);Ak();})();
//# sourceMappingURL=index.js.map
